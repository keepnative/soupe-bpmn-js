/*! @keepnative/soupe-bpmn-js - bpmn-viewer v3.0.0 | (c) 2014, 2015 camunda Services GmbH | bpmn.io/license */
!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.SoupeBpmnJS=f()}}(function(){var define;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){"use strict";function SoupeBpmnViewer(options){Viewer.call(this,options)}var inherits=_dereq_(82),Viewer=_dereq_(5);inherits(SoupeBpmnViewer,Viewer),module.exports=SoupeBpmnViewer;var customTranslate={translate:["value",_dereq_(2)]};SoupeBpmnViewer.prototype._customizedModules=[customTranslate]},{2:2,5:5,82:82}],2:[function(_dereq_,module,exports){"use strict";var translations=_dereq_(3);module.exports=function(template,replacements){return replacements=replacements||{},template=translations[template]||template,template.replace(/{([^}]+)}/g,function(_,key){return replacements[key]||"{"+key+"}"})}},{3:3}],3:[function(_dereq_,module,exports){"use strict";module.exports={"Append {type}":"追加{type}","Add Lane above":"在上方添加泳道","Divide into two Lanes":"拆分为2条泳道","Divide into three Lanes":"拆分为3条泳道","Add Lane below":"在下方添加泳道","Append compensation activity":"追加补偿活动","Change type":"更改类型","Connect using Association":"建立关联","Connect using Sequence/MessageFlow or Association":"建立关联","Connect using DataInputAssociation":"建立关联",Remove:"移除","Activate the hand tool":"激活手型工具 (用于移动画布)","Activate the lasso tool":"激活选择工具 (用于选择元素)","Activate the create/remove space tool":"激活工作空间创建或移除工具","Activate the global connect tool":"激活连接工具","Create IntermediateThrowEvent/BoundaryEvent":"创建过渡异常抛出事件/边界事件","Create expanded SubProcess":"创建展开的子流程","Create Pool/Participant":"创建池/道","Parallel Multi Instance":"多实例并行","Sequential Multi Instance":"多实例串行",Loop:"循环","Ad-hoc":"特别指定","Create {type}":"创建{type}",Task:"任务","Send Task":"发送性任务","Receive Task":"接收性任务","User Task":"用户交互性任务","Manual Task":"线下手动性任务","Business Rule Task":"业务规则性任务","Service Task":"服务性任务","Script Task":"脚本性任务","Call Activity":"呼叫性任务","Sub Process (collapsed)":"子流程 (折叠的)","Start Event":"启动事件",StartEvent:"启动事件","Intermediate Throw Event":"过渡异常抛出事件",IntermediateThrowEvent:"过渡异常抛出事件","End Event":"结束事件",EndEvent:"结束事件","Message Start Event":"消息性启动事件","Timer Start Event":"定时启动事件","Conditional Start Event":"条件性启动事件","Signal Start Event":"信号性启动事件","Error Start Event":"错误性启动事件","Escalation Start Event":"上升性启动事件","Compensation Start Event":"补偿性启动事件","Message Start Event (non-interrupting)":"消息性启动事件 (不可中断)","Timer Start Event (non-interrupting)":"定时启动事件 (不可中断)","Conditional Start Event (non-interrupting)":"条件性启动事件 (不可中断)","Signal Start Event (non-interrupting)":"信号性启动事件 (不可中断)","Escalation Start Event (non-interrupting)":"上升性启动事件 (不可中断)","Message Intermediate Catch Event":"消息性过渡异常捕捉事件","Message Intermediate Throw Event":"消息性过渡异常抛出事件","Timer Intermediate Catch Event":"定时过渡异常捕捉事件","Escalation Intermediate Throw Event":"上升性过渡异常抛出事件","Conditional Intermediate Catch Event":"条件性过渡异常捕捉事件","Link Intermediate Catch Event":"链接性过渡异常捕捉事件","Link Intermediate Throw Event":"链接性过渡异常抛出事件","Compensation Intermediate Throw Event":"补偿性过渡异常抛出事件","Signal Intermediate Catch Event":"信号性过渡异常捕捉事件","Signal Intermediate Throw Event":"信号性过渡异常抛出事件","Message End Event":"消息性结束事件","Escalation End Event":"上升性结束事件","Error End Event":"错误性结束事件","Cancel End Event":"撤销性结束事件","Compensation End Event":"补偿性结束事件","Signal End Event":"信号性结束事件","Terminate End Event":"终止性结束事件","Message Boundary Event":"消息性边界事件","Message Boundary Event (non-interrupting)":"消息性边界事件 (不可中断)","Timer Boundary Event":"定时边界事件","Timer Boundary Event (non-interrupting)":"定时边界 (不可中断)","Escalation Boundary Event":"上升性边界事件","Escalation Boundary Event (non-interrupting)":"上升性边界事件 (不可中断)","Conditional Boundary Event":"条件性边界事件","Conditional Boundary Event (non-interrupting)":"条件性边界事件 (不可中断)","Error Boundary Event":"错误性边界事件","Cancel Boundary Event":"撤销性边界事件","Signal Boundary Event":"信号性边界事件","Signal Boundary Event (non-interrupting)":"信号性边界事件 (不可中断)","Compensation Boundary Event":"补偿性边界事件","Exclusive Gateway":"排他性关口",ExclusiveGateway:"排他性关口","Parallel Gateway":"并行关口","Inclusive Gateway":"包容性关口","Complex Gateway":"复合性关口","Event based Gateway":"基于事件的关口",Transaction:"事务","Sub Process":"子流程","Event Sub Process":"事件子流程","Collapsed Pool":"折叠的池子","Expanded Pool":"展开的池子",DataObjectReference:"数据对象引用",DataStoreReference:"数据存储引用",TextAnnotation:"文本注释","Press SHIFT+Enter for line feed":"按下SHIFT+Enter来换行","no parent for {element} in {parent}":"在{parent}中不存在{element}的父级关系","no shape type specified":"未指定类型","flow elements must be children of pools/participants":"流程元素必须在池/道里面","out of bounds release":"超出边界","more than {count} child lanes":"超过{count}个子道","element required":"必需的元素","diagram not part of bpmn:Definitions":"不是有效的BPMN图表","no diagram to display":"没有可显示的图表","no process or collaboration to display":"没有可显示的流程或协作","element {element} referenced by {referenced}#{property} not yet drawn":"被{referenced}#{property}引用的{element}没有绘制","already rendered {element}":"已经存在{element}","failed to import {element}":"{element}导入失败",General:"通用",Id:"标识",Name:"名称",Value:"值","ToDo Url":"待办地址",Yes:"是",No:"否","Process Id":"流程标识","Process Name":"流程名称",Executable:"可执行","Imports & Globals":"类型与全局变量",Imports:"类型","Add Import":"添加类型",Globals:"全局变量","Add Global":"添加变量",Identifier:"标识(必须唯一)",Type:"变量类型","Type Name":"类型名称(任意Class Name)","Actor Id":"分配给","Actor of the User Task":"指定任务的执行者","Group Id":"用户组标识","Content Id":"","Comment Id":"",Skippable:"是否可跳过",Priority:"优先级","Organization Level":"组织级别","Role Codes":"角色编码(多个用逗号分开)","Roles of this User Task":"可执行任务的角色","Multi-User":"是否会签","Input/Output Parameters":"输入/输出参数","Input Parameters":"输入参数","Output Parameters":"输出参数",Parameters:"","Parameter Detail":"参数详情","Condition Type":"条件类型",Expression:"表达式",Script:"脚本","Script Format":"脚本语言","Script Type":"脚本类型","Inline Script":"内嵌脚本","External Resource":"外部文件",Resource:"文件路径","Gateway Direction":"关口方向类型",Diverging:"分叉",Converging:"汇聚",Mixed:"混合",Unspecified:"未指定"}},{}],4:[function(_dereq_,module,exports){"use strict";function placeHoldersCount(b64){var len=b64.length;if(len%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===b64[len-2]?2:"="===b64[len-1]?1:0}function byteLength(b64){return 3*b64.length/4-placeHoldersCount(b64)}function toByteArray(b64){var i,l,tmp,placeHolders,arr,len=b64.length;placeHolders=placeHoldersCount(b64),arr=new Arr(3*len/4-placeHolders),l=placeHolders>0?len-4:len;var L=0;for(i=0;i<l;i+=4)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[L++]=tmp>>16&255,arr[L++]=tmp>>8&255,arr[L++]=255&tmp;return 2===placeHolders?(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[L++]=255&tmp):1===placeHolders&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[L++]=tmp>>8&255,arr[L++]=255&tmp),arr}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[63&num]}function encodeChunk(uint8,start,end){for(var tmp,output=[],i=start;i<end;i+=3)tmp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2],output.push(tripletToBase64(tmp));return output.join("")}function fromByteArray(uint8){for(var tmp,len=uint8.length,extraBytes=len%3,output="",parts=[],i=0,len2=len-extraBytes;i<len2;i+=16383)parts.push(encodeChunk(uint8,i,i+16383>len2?len2:i+16383));return 1===extraBytes?(tmp=uint8[len-1],output+=lookup[tmp>>2],output+=lookup[tmp<<4&63],output+="=="):2===extraBytes&&(tmp=(uint8[len-2]<<8)+uint8[len-1],output+=lookup[tmp>>10],output+=lookup[tmp>>4&63],output+=lookup[tmp<<2&63],output+="="),parts.push(output),parts.join("")}exports.byteLength=byteLength,exports.toByteArray=toByteArray,exports.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63},{}],5:[function(_dereq_,module,exports){"use strict";function checkValidationError(err){var pattern=/unparsable content <([^>]+)> detected([\s\S]*)$/,match=pattern.exec(err.message);return match&&(err.message="unparsable content <"+match[1]+"> detected; this may indicate an invalid BPMN 2.0 diagram file"+match[2]),err}function ensureUnit(val){return val+(isNumber(val)?"px":"")}function Viewer(options){options=assign({},DEFAULT_OPTIONS,options),this.moddle=this._createModdle(options),this.container=this._createContainer(options),addProjectLogo(this.container),this._init(this.container,this.moddle,options)}function addProjectLogo(container){var logoData=PoweredBy.BPMNIO_LOGO,linkMarkup='<a href="http://bpmn.io" target="_blank" class="bjs-powered-by" title="Powered by bpmn.io" style="position: absolute; bottom: 15px; right: 15px; z-index: 100"><img src="data:image/png;base64,'+logoData+'"></a>',linkElement=domify(linkMarkup);container.appendChild(linkElement),domEvent.bind(linkElement,"click",function(event){PoweredBy.open(),event.preventDefault()})}var assign=_dereq_(202),omit=_dereq_(206),isNumber=_dereq_(196),domify=_dereq_(216),domQuery=_dereq_(218),domRemove=_dereq_(219),innerSVG=_dereq_(262),Diagram=_dereq_(38),BpmnModdle=_dereq_(19),inherits=_dereq_(82),Importer=_dereq_(12),DEFAULT_OPTIONS={width:"100%",height:"100%",position:"relative"};inherits(Viewer,Diagram),module.exports=Viewer,Viewer.prototype.importXML=function(xml,done){done=done||function(){};var self=this;xml=this._emit("import.parse.start",{xml:xml})||xml,this.moddle.fromXML(xml,"bpmn:Definitions",function(err,definitions,context){if(definitions=self._emit("import.parse.complete",{error:err,definitions:definitions,context:context})||definitions,err)return err=checkValidationError(err),self._emit("import.done",{error:err}),done(err);var parseWarnings=context.warnings;self.importDefinitions(definitions,function(err,importWarnings){var allWarnings=[].concat(parseWarnings,importWarnings||[]);self._emit("import.done",{error:err,warnings:allWarnings}),done(err,allWarnings)})})},Viewer.prototype.saveXML=function(options,done){done||(done=options,options={});var definitions=this.definitions;if(!definitions)return done(new Error("no definitions loaded"));this.moddle.toXML(definitions,options,done)},Viewer.prototype.saveSVG=function(options,done){done||(done=options,options={});var canvas=this.get("canvas"),contentNode=canvas.getDefaultLayer(),defsNode=domQuery("defs",canvas._svg),contents=innerSVG(contentNode),defs=defsNode?"<defs>"+innerSVG(defsNode)+"</defs>":"",bbox=contentNode.getBBox();done(null,'<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- created with bpmn-js / http://bpmn.io --\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+bbox.width+'" height="'+bbox.height+'" viewBox="'+bbox.x+" "+bbox.y+" "+bbox.width+" "+bbox.height+'" version="1.1">'+defs+contents+"</svg>")},Viewer.prototype.importDefinitions=function(definitions,done){try{this.definitions&&this.clear(),this.definitions=definitions,Importer.importBpmnDiagram(this,definitions,done)}catch(e){done(e)}},Viewer.prototype.getModules=function(){return this._modules},Viewer.prototype.destroy=function(){Diagram.prototype.destroy.call(this),domRemove(this.container)},Viewer.prototype.on=function(event,priority,callback,target){return this.get("eventBus").on(event,priority,callback,target)},Viewer.prototype.off=function(event,callback){this.get("eventBus").off(event,callback)},Viewer.prototype.attachTo=function(parentNode){if(!parentNode)throw new Error("parentNode required");this.detach(),parentNode.get&&parentNode.constructor.prototype.jquery&&(parentNode=parentNode.get(0)),"string"==typeof parentNode&&(parentNode=domQuery(parentNode));var container=this._container;parentNode.appendChild(container),this._emit("attach",{})},Viewer.prototype.detach=function(){var container=this._container,parentNode=container.parentNode;parentNode&&(this._emit("detach",{}),parentNode.removeChild(container))},Viewer.prototype._init=function(container,moddle,options){this._container=container;var baseModules=options.modules||this.getModules(),additionalModules=options.additionalModules||[],staticModules=[{bpmnjs:["value",this],moddle:["value",moddle]}],diagramModules=[].concat(staticModules,baseModules,additionalModules),diagramOptions=assign(omit(options,"additionalModules"),{canvas:assign({},options.canvas,{container:container}),modules:diagramModules});Diagram.call(this,diagramOptions),options&&options.container&&this.attachTo(options.container)},Viewer.prototype._emit=function(type,event){return this.get("eventBus").fire(type,event)},Viewer.prototype._createContainer=function(options){var container=domify('<div class="bjs-container"></div>');return assign(container.style,{width:ensureUnit(options.width),height:ensureUnit(options.height),position:options.position}),container},Viewer.prototype._createModdle=function(options){var moddleOptions=assign({},this._moddleExtensions,options.moddleExtensions);return new BpmnModdle(moddleOptions)},Viewer.prototype._modules=[_dereq_(6),_dereq_(60),_dereq_(59),_dereq_(55)],Viewer.prototype._moddleExtensions={};var PoweredBy=_dereq_(18),domEvent=_dereq_(217)},{12:12,18:18,19:19,196:196,202:202,206:206,216:216,217:217,218:218,219:219,262:262,38:38,55:55,59:59,6:6,60:60,82:82}],6:[function(_dereq_,module,exports){module.exports={__depends__:[_dereq_(9),_dereq_(14)]}},{14:14,9:9}],7:[function(_dereq_,module,exports){"use strict";function BpmnRenderer(eventBus,styles,pathMap,canvas,priority){function addMarker(id,options){var attrs=assign({fill:"black",strokeWidth:1,strokeLinecap:"round",strokeDasharray:"none"},options.attrs),ref=options.ref||{x:0,y:0},scale=options.scale||1;"none"===attrs.strokeDasharray&&(attrs.strokeDasharray=[1e4,1]);var marker=svgCreate("marker");svgAttr(options.element,attrs),svgAppend(marker,options.element),svgAttr(marker,{id:id,viewBox:"0 0 20 20",refX:ref.x,refY:ref.y,markerWidth:20*scale,markerHeight:20*scale,orient:"auto"});var defs=domQuery("defs",canvas._svg);defs||(defs=svgCreate("defs"),svgAppend(canvas._svg,defs)),svgAppend(defs,marker),markers[id]=marker}function marker(type,fill,stroke){var id=type+"-"+fill+"-"+stroke+"-"+rendererId;return markers[id]||createMarker(type,fill,stroke),"url(#"+id+")"}function createMarker(type,fill,stroke){var id=type+"-"+fill+"-"+stroke+"-"+rendererId;if("sequenceflow-end"===type){var sequenceflowEnd=svgCreate("path");svgAttr(sequenceflowEnd,{d:"M 1 5 L 11 10 L 1 15 Z"}),addMarker(id,{element:sequenceflowEnd,ref:{x:11,y:10},scale:.5,attrs:{fill:stroke,stroke:stroke}})}if("messageflow-start"===type){var messageflowStart=svgCreate("circle");svgAttr(messageflowStart,{cx:6,cy:6,r:3.5}),addMarker(id,{element:messageflowStart,attrs:{fill:fill,stroke:stroke},ref:{x:6,y:6}})}if("messageflow-end"===type){var messageflowEnd=svgCreate("path");svgAttr(messageflowEnd,{d:"m 1 5 l 0 -3 l 7 3 l -7 3 z"}),addMarker(id,{element:messageflowEnd,attrs:{fill:fill,stroke:stroke,strokeLinecap:"butt"},ref:{x:8.5,y:5}})}if("association-start"===type){var associationStart=svgCreate("path");svgAttr(associationStart,{d:"M 11 5 L 1 10 L 11 15"}),addMarker(id,{element:associationStart,attrs:{fill:"none",stroke:stroke,strokeWidth:1.5},ref:{x:1,y:10},scale:.5})}if("association-end"===type){var associationEnd=svgCreate("path");svgAttr(associationEnd,{d:"M 1 5 L 11 10 L 1 15"}),addMarker(id,{element:associationEnd,attrs:{fill:"none",stroke:stroke,strokeWidth:1.5},ref:{x:12,y:10},scale:.5})}if("conditional-flow-marker"===type){var conditionalflowMarker=svgCreate("path");svgAttr(conditionalflowMarker,{d:"M 0 10 L 8 6 L 16 10 L 8 14 Z"}),addMarker(id,{element:conditionalflowMarker,attrs:{fill:fill,stroke:stroke},ref:{x:-1,y:10},scale:.5})}if("conditional-default-flow-marker"===type){var conditionaldefaultflowMarker=svgCreate("path");svgAttr(conditionaldefaultflowMarker,{d:"M 6 4 L 10 16"}),addMarker(id,{element:conditionaldefaultflowMarker,attrs:{stroke:stroke},ref:{x:0,y:10},scale:.5})}}function drawCircle(parentGfx,width,height,offset,attrs){isObject(offset)&&(attrs=offset,offset=0),offset=offset||0,attrs=computeStyle(attrs,{stroke:"black",strokeWidth:2,fill:"white"});var cx=width/2,cy=height/2,circle=svgCreate("circle");return svgAttr(circle,{cx:cx,cy:cy,r:Math.round((width+height)/4-offset)}),svgAttr(circle,attrs),svgAppend(parentGfx,circle),circle}function drawRect(parentGfx,width,height,r,offset,attrs){isObject(offset)&&(attrs=offset,offset=0),offset=offset||0,attrs=computeStyle(attrs,{stroke:"black",strokeWidth:2,fill:"white"});var rect=svgCreate("rect");return svgAttr(rect,{x:offset,y:offset,width:width-2*offset,height:height-2*offset,rx:r,ry:r}),svgAttr(rect,attrs),svgAppend(parentGfx,rect),rect}function drawDiamond(parentGfx,width,height,attrs){var x_2=width/2,y_2=height/2,points=[{x:x_2,y:0},{x:width,y:y_2},{x:x_2,y:height},{x:0,y:y_2}],pointsString=points.map(function(point){return point.x+","+point.y}).join(" ");attrs=computeStyle(attrs,{stroke:"black",strokeWidth:2,fill:"white"});var polygon=svgCreate("polygon");return svgAttr(polygon,{points:pointsString}),svgAttr(polygon,attrs),svgAppend(parentGfx,polygon),polygon}function drawLine(parentGfx,waypoints,attrs){attrs=computeStyle(attrs,["no-fill"],{stroke:"black",strokeWidth:2,fill:"none"});var line=createLine(waypoints,attrs);return svgAppend(parentGfx,line),line}function drawPath(parentGfx,d,attrs){attrs=computeStyle(attrs,["no-fill"],{strokeWidth:2,stroke:"black"});var path=svgCreate("path");return svgAttr(path,{d:d}),svgAttr(path,attrs),svgAppend(parentGfx,path),path}function drawMarker(type,parentGfx,path,attrs){return drawPath(parentGfx,path,assign({"data-marker":type},attrs))}function as(type){return function(parentGfx,element){return handlers[type](parentGfx,element)}}function renderer(type){return handlers[type]}function renderEventContent(element,parentGfx){var event=getSemantic(element),isThrowing=isThrowEvent(event);return isTypedEvent(event,"bpmn:MessageEventDefinition")?renderer("bpmn:MessageEventDefinition")(parentGfx,element,isThrowing):isTypedEvent(event,"bpmn:TimerEventDefinition")?renderer("bpmn:TimerEventDefinition")(parentGfx,element,isThrowing):isTypedEvent(event,"bpmn:ConditionalEventDefinition")?renderer("bpmn:ConditionalEventDefinition")(parentGfx,element):isTypedEvent(event,"bpmn:SignalEventDefinition")?renderer("bpmn:SignalEventDefinition")(parentGfx,element,isThrowing):isTypedEvent(event,"bpmn:CancelEventDefinition")&&isTypedEvent(event,"bpmn:TerminateEventDefinition",{parallelMultiple:!1})?renderer("bpmn:MultipleEventDefinition")(parentGfx,element,isThrowing):isTypedEvent(event,"bpmn:CancelEventDefinition")&&isTypedEvent(event,"bpmn:TerminateEventDefinition",{parallelMultiple:!0})?renderer("bpmn:ParallelMultipleEventDefinition")(parentGfx,element,isThrowing):isTypedEvent(event,"bpmn:EscalationEventDefinition")?renderer("bpmn:EscalationEventDefinition")(parentGfx,element,isThrowing):isTypedEvent(event,"bpmn:LinkEventDefinition")?renderer("bpmn:LinkEventDefinition")(parentGfx,element,isThrowing):isTypedEvent(event,"bpmn:ErrorEventDefinition")?renderer("bpmn:ErrorEventDefinition")(parentGfx,element,isThrowing):isTypedEvent(event,"bpmn:CancelEventDefinition")?renderer("bpmn:CancelEventDefinition")(parentGfx,element,isThrowing):isTypedEvent(event,"bpmn:CompensateEventDefinition")?renderer("bpmn:CompensateEventDefinition")(parentGfx,element,isThrowing):isTypedEvent(event,"bpmn:TerminateEventDefinition")?renderer("bpmn:TerminateEventDefinition")(parentGfx,element,isThrowing):null}function renderLabel(parentGfx,label,options){var text=textUtil.createText(label||"",options);return svgClasses(text).add("djs-label"),svgAppend(parentGfx,text),text}function renderEmbeddedLabel(parentGfx,element,align){return renderLabel(parentGfx,getSemantic(element).name,{box:element,align:align,padding:5,style:{fill:getStrokeColor(element)}})}function renderExternalLabel(parentGfx,element){var semantic=getSemantic(element),box={width:90,height:30,x:element.width/2+element.x,y:element.height/2+element.y};return renderLabel(parentGfx,semantic.name,{box:box,fitBox:!0,style:{fontSize:"11px"}})}function renderLaneLabel(parentGfx,text,element){var textBox=renderLabel(parentGfx,text,{box:{height:30,width:element.height},align:"center-middle",style:{fill:getStrokeColor(element)}}),top=-1*element.height;transform(textBox,0,-top,270)}function createPathFromConnection(connection){for(var waypoints=connection.waypoints,pathData="m  "+waypoints[0].x+","+waypoints[0].y,i=1;i<waypoints.length;i++)pathData+="L"+waypoints[i].x+","+waypoints[i].y+" ";return pathData}function attachTaskMarkers(parentGfx,element,taskMarkers){var position,obj=getSemantic(element),subprocess=taskMarkers&&-1!==taskMarkers.indexOf("SubProcessMarker");position=subprocess?{seq:-21,parallel:-22,compensation:-42,loop:-18,adhoc:10}:{seq:-3,parallel:-6,compensation:-27,loop:0,adhoc:10},forEach(taskMarkers,function(marker){renderer(marker)(parentGfx,element,position)}),obj.isForCompensation&&renderer("CompensationMarker")(parentGfx,element,position),"bpmn:AdHocSubProcess"===obj.$type&&renderer("AdhocMarker")(parentGfx,element,position);var loopCharacteristics=obj.loopCharacteristics,isSequential=loopCharacteristics&&loopCharacteristics.isSequential;loopCharacteristics&&(void 0===isSequential&&renderer("LoopMarker")(parentGfx,element,position),!1===isSequential&&renderer("ParallelMarker")(parentGfx,element,position),!0===isSequential&&renderer("SequentialMarker")(parentGfx,element,position))}function renderDataItemCollection(parentGfx,element){var yPosition=(element.height-16)/element.height;drawPath(parentGfx,pathMap.getScaledPath("DATA_OBJECT_COLLECTION_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:.451,my:yPosition}}),{strokeWidth:2})}BaseRenderer.call(this,eventBus,priority);var rendererId=RENDERER_IDS.next(),textUtil=new TextUtil({style:LABEL_STYLE,size:{width:100}}),markers={},computeStyle=styles.computeStyle,handlers=this.handlers={"bpmn:Event":function(parentGfx,element,attrs){return drawCircle(parentGfx,element.width,element.height,attrs)},"bpmn:StartEvent":function(parentGfx,element){var attrs={fill:getFillColor(element),stroke:getStrokeColor(element)};getSemantic(element).isInterrupting||(attrs={strokeDasharray:"6",strokeLinecap:"round"});var circle=renderer("bpmn:Event")(parentGfx,element,attrs);return renderEventContent(element,parentGfx),circle},"bpmn:MessageEventDefinition":function(parentGfx,element,isThrowing){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_MESSAGE",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:element.width,containerHeight:element.height,position:{mx:.235,my:.315}}),{strokeWidth:1,fill:isThrowing?getStrokeColor(element):getFillColor(element),stroke:isThrowing?getFillColor(element):getStrokeColor(element)})},"bpmn:TimerEventDefinition":function(parentGfx,element){var circle=drawCircle(parentGfx,element.width,element.height,.2*element.height,{strokeWidth:2,fill:getFillColor(element),stroke:getStrokeColor(element)});drawPath(parentGfx,pathMap.getScaledPath("EVENT_TIMER_WH",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:element.width,containerHeight:element.height,position:{mx:.5,my:.5}}),{strokeWidth:2,strokeLinecap:"square",stroke:getStrokeColor(element)});for(var i=0;i<12;i++){var linePathData=pathMap.getScaledPath("EVENT_TIMER_LINE",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:element.width,containerHeight:element.height,position:{mx:.5,my:.5}}),width=element.width/2;drawPath(parentGfx,linePathData,{strokeWidth:1,strokeLinecap:"square",transform:"rotate("+30*i+","+element.height/2+","+width+")",stroke:getStrokeColor(element)})}return circle},"bpmn:EscalationEventDefinition":function(parentGfx,event,isThrowing){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_ESCALATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:event.width,containerHeight:event.height,position:{mx:.5,my:.2}}),{strokeWidth:1,fill:isThrowing?getStrokeColor(event):"none",stroke:getStrokeColor(event)})},"bpmn:ConditionalEventDefinition":function(parentGfx,event){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_CONDITIONAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:event.width,containerHeight:event.height,position:{mx:.5,my:.222}}),{strokeWidth:1,stroke:getStrokeColor(event)})},"bpmn:LinkEventDefinition":function(parentGfx,event,isThrowing){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_LINK",{xScaleFactor:1,yScaleFactor:1,containerWidth:event.width,containerHeight:event.height,position:{mx:.57,my:.263}}),{strokeWidth:1,fill:isThrowing?getStrokeColor(event):"none",stroke:getStrokeColor(event)})},"bpmn:ErrorEventDefinition":function(parentGfx,event,isThrowing){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_ERROR",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:event.width,containerHeight:event.height,position:{mx:.2,my:.722}}),{strokeWidth:1,fill:isThrowing?getStrokeColor(event):"none",stroke:getStrokeColor(event)})},"bpmn:CancelEventDefinition":function(parentGfx,event,isThrowing){var pathData=pathMap.getScaledPath("EVENT_CANCEL_45",{xScaleFactor:1,yScaleFactor:1,containerWidth:event.width,containerHeight:event.height,position:{mx:.638,my:-.055}}),fill=isThrowing?"black":"none",path=drawPath(parentGfx,pathData,{strokeWidth:1,fill:fill});return rotate(path,45),path},"bpmn:CompensateEventDefinition":function(parentGfx,event,isThrowing){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:event.width,containerHeight:event.height,position:{mx:.22,my:.5}}),{strokeWidth:1,fill:isThrowing?getStrokeColor(event):"none",stroke:getStrokeColor(event)})},"bpmn:SignalEventDefinition":function(parentGfx,event,isThrowing){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_SIGNAL",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:event.width,containerHeight:event.height,position:{mx:.5,my:.2}}),{strokeWidth:1,fill:isThrowing?getStrokeColor(event):"none",stroke:getStrokeColor(event)})},"bpmn:MultipleEventDefinition":function(parentGfx,event,isThrowing){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_MULTIPLE",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:event.width,containerHeight:event.height,position:{mx:.222,my:.36}}),{strokeWidth:1,fill:isThrowing?"black":"none"})},"bpmn:ParallelMultipleEventDefinition":function(parentGfx,event){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_PARALLEL_MULTIPLE",{xScaleFactor:1.2,yScaleFactor:1.2,containerWidth:event.width,containerHeight:event.height,position:{mx:.458,my:.194}}),{strokeWidth:1,fill:getStrokeColor(event),stroke:getStrokeColor(event)})},"bpmn:EndEvent":function(parentGfx,element){var circle=renderer("bpmn:Event")(parentGfx,element,{strokeWidth:4,fill:getFillColor(element),stroke:getStrokeColor(element)});return renderEventContent(element,parentGfx),circle},"bpmn:TerminateEventDefinition":function(parentGfx,element){return drawCircle(parentGfx,element.width,element.height,8,{strokeWidth:4,fill:getStrokeColor(element),stroke:getStrokeColor(element)})},"bpmn:IntermediateEvent":function(parentGfx,element){var outer=renderer("bpmn:Event")(parentGfx,element,{strokeWidth:1,fill:getFillColor(element),stroke:getStrokeColor(element)});return drawCircle(parentGfx,element.width,element.height,INNER_OUTER_DIST,{strokeWidth:1,fill:getFillColor(element,"none"),stroke:getStrokeColor(element)}),renderEventContent(element,parentGfx),outer},"bpmn:IntermediateCatchEvent":as("bpmn:IntermediateEvent"),"bpmn:IntermediateThrowEvent":as("bpmn:IntermediateEvent"),"bpmn:Activity":function(parentGfx,element,attrs){return drawRect(parentGfx,element.width,element.height,TASK_BORDER_RADIUS,attrs)},"bpmn:Task":function(parentGfx,element){var attrs={fill:getFillColor(element),stroke:getStrokeColor(element)},rect=renderer("bpmn:Activity")(parentGfx,element,attrs);return renderEmbeddedLabel(parentGfx,element,"center-middle"),attachTaskMarkers(parentGfx,element),rect},"bpmn:ServiceTask":function(parentGfx,element){var task=renderer("bpmn:Task")(parentGfx,element);return drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:12,y:18}}),{strokeWidth:1,fill:getFillColor(element),stroke:getStrokeColor(element)}),drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_SERVICE_FILL",{abspos:{x:17.2,y:18}}),{strokeWidth:0,fill:getFillColor(element)}),drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:17,y:22}}),{strokeWidth:1,fill:getFillColor(element),stroke:getStrokeColor(element)}),task},"bpmn:UserTask":function(parentGfx,element){var task=renderer("bpmn:Task")(parentGfx,element);return drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:getFillColor(element),stroke:getStrokeColor(element)}),drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:getFillColor(element),stroke:getStrokeColor(element)}),drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:getStrokeColor(element),stroke:getStrokeColor(element)}),task},"bpmn:ManualTask":function(parentGfx,element){var task=renderer("bpmn:Task")(parentGfx,element);return drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_MANUAL",{abspos:{x:17,y:15}}),{strokeWidth:.5,fill:getFillColor(element),stroke:getStrokeColor(element)}),task},"bpmn:SendTask":function(parentGfx,element){var task=renderer("bpmn:Task")(parentGfx,element);return drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:1,yScaleFactor:1,containerWidth:21,containerHeight:14,position:{mx:.285,my:.357}}),{strokeWidth:1,fill:getStrokeColor(element),stroke:getFillColor(element)}),task},"bpmn:ReceiveTask":function(parentGfx,element){var pathData,semantic=getSemantic(element),task=renderer("bpmn:Task")(parentGfx,element);return semantic.instantiate?(drawCircle(parentGfx,28,28,4.4,{strokeWidth:1}),pathData=pathMap.getScaledPath("TASK_TYPE_INSTANTIATING_SEND",{abspos:{x:7.77,y:9.52}})):pathData=pathMap.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:21,containerHeight:14,position:{mx:.3,my:.4}}),drawPath(parentGfx,pathData,{strokeWidth:1,fill:getFillColor(element),stroke:getStrokeColor(element)}),task},"bpmn:ScriptTask":function(parentGfx,element){var task=renderer("bpmn:Task")(parentGfx,element);return drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_SCRIPT",{abspos:{x:15,y:20}}),{strokeWidth:1,stroke:getStrokeColor(element)}),task},"bpmn:BusinessRuleTask":function(parentGfx,element){var task=renderer("bpmn:Task")(parentGfx,element),headerPathData=pathMap.getScaledPath("TASK_TYPE_BUSINESS_RULE_HEADER",{abspos:{x:8,y:8}}),businessHeaderPath=drawPath(parentGfx,headerPathData);svgAttr(businessHeaderPath,{strokeWidth:1,fill:getFillColor(element,"#aaaaaa"),stroke:getStrokeColor(element)});var headerData=pathMap.getScaledPath("TASK_TYPE_BUSINESS_RULE_MAIN",{abspos:{x:8,y:8}}),businessPath=drawPath(parentGfx,headerData);return svgAttr(businessPath,{strokeWidth:1,stroke:getStrokeColor(element)}),task},"bpmn:SubProcess":function(parentGfx,element,attrs){attrs=assign({fillOpacity:.95,fill:getFillColor(element),stroke:getStrokeColor(element)},attrs)
;var rect=renderer("bpmn:Activity")(parentGfx,element,attrs),expanded=DiUtil.isExpanded(element);return DiUtil.isEventSubProcess(element)&&svgAttr(rect,{strokeDasharray:"1,2"}),renderEmbeddedLabel(parentGfx,element,expanded?"center-top":"center-middle"),expanded?attachTaskMarkers(parentGfx,element):attachTaskMarkers(parentGfx,element,["SubProcessMarker"]),rect},"bpmn:AdHocSubProcess":function(parentGfx,element){return renderer("bpmn:SubProcess")(parentGfx,element)},"bpmn:Transaction":function(parentGfx,element){var outer=renderer("bpmn:SubProcess")(parentGfx,element),innerAttrs=styles.style(["no-fill","no-events"],{stroke:getStrokeColor(element)});return drawRect(parentGfx,element.width,element.height,TASK_BORDER_RADIUS-2,INNER_OUTER_DIST,innerAttrs),outer},"bpmn:CallActivity":function(parentGfx,element){return renderer("bpmn:SubProcess")(parentGfx,element,{strokeWidth:5})},"bpmn:Participant":function(parentGfx,element){var attrs={fillOpacity:.95,fill:getFillColor(element),stroke:getStrokeColor(element)},lane=renderer("bpmn:Lane")(parentGfx,element,attrs);DiUtil.isExpanded(element)?(drawLine(parentGfx,[{x:30,y:0},{x:30,y:element.height}],{stroke:getStrokeColor(element)}),renderLaneLabel(parentGfx,getSemantic(element).name,element)):renderLabel(parentGfx,getSemantic(element).name,{box:element,align:"center-middle",style:{fill:getStrokeColor(element)}});return!!getSemantic(element).participantMultiplicity&&renderer("ParticipantMultiplicityMarker")(parentGfx,element),lane},"bpmn:Lane":function(parentGfx,element,attrs){var rect=drawRect(parentGfx,element.width,element.height,0,assign({fill:getFillColor(element),stroke:getStrokeColor(element)},attrs)),semantic=getSemantic(element);if("bpmn:Lane"===semantic.$type){renderLaneLabel(parentGfx,semantic.name,element)}return rect},"bpmn:InclusiveGateway":function(parentGfx,element){var attrs={fill:getFillColor(element),stroke:getStrokeColor(element)},diamond=drawDiamond(parentGfx,element.width,element.height,attrs);return drawCircle(parentGfx,element.width,element.height,.24*element.height,{strokeWidth:2.5,fill:getFillColor(element),stroke:getStrokeColor(element)}),diamond},"bpmn:ExclusiveGateway":function(parentGfx,element){var attrs={fill:getFillColor(element),stroke:getStrokeColor(element)},diamond=drawDiamond(parentGfx,element.width,element.height,attrs),pathData=pathMap.getScaledPath("GATEWAY_EXCLUSIVE",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:element.width,containerHeight:element.height,position:{mx:.32,my:.3}});return getDi(element).isMarkerVisible&&drawPath(parentGfx,pathData,{strokeWidth:1,fill:getStrokeColor(element),stroke:getStrokeColor(element)}),diamond},"bpmn:ComplexGateway":function(parentGfx,element){var attrs={fill:getFillColor(element),stroke:getStrokeColor(element)},diamond=drawDiamond(parentGfx,element.width,element.height,attrs);return drawPath(parentGfx,pathMap.getScaledPath("GATEWAY_COMPLEX",{xScaleFactor:.5,yScaleFactor:.5,containerWidth:element.width,containerHeight:element.height,position:{mx:.46,my:.26}}),{strokeWidth:1,fill:getStrokeColor(element),stroke:getStrokeColor(element)}),diamond},"bpmn:ParallelGateway":function(parentGfx,element){var attrs={fill:getFillColor(element),stroke:getStrokeColor(element)},diamond=drawDiamond(parentGfx,element.width,element.height,attrs);return drawPath(parentGfx,pathMap.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.6,yScaleFactor:.6,containerWidth:element.width,containerHeight:element.height,position:{mx:.46,my:.2}}),{strokeWidth:1,fill:getStrokeColor(element),stroke:getStrokeColor(element)}),diamond},"bpmn:EventBasedGateway":function(parentGfx,element){var semantic=getSemantic(element),attrs={fill:getFillColor(element),stroke:getStrokeColor(element)},diamond=drawDiamond(parentGfx,element.width,element.height,attrs);drawCircle(parentGfx,element.width,element.height,.2*element.height,{strokeWidth:1,fill:"none",stroke:getStrokeColor(element)});var type=semantic.eventGatewayType,instantiate=!!semantic.instantiate;if("Parallel"===type){var pathData=pathMap.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:element.width,containerHeight:element.height,position:{mx:.474,my:.296}}),parallelPath=drawPath(parentGfx,pathData);svgAttr(parallelPath,{strokeWidth:1,fill:"none"})}else if("Exclusive"===type){if(!instantiate){var innerCircle=drawCircle(parentGfx,element.width,element.height,.26*element.height);svgAttr(innerCircle,{strokeWidth:1,fill:"none",stroke:getStrokeColor(element)})}!function(){var pathData=pathMap.getScaledPath("GATEWAY_EVENT_BASED",{xScaleFactor:.18,yScaleFactor:.18,containerWidth:element.width,containerHeight:element.height,position:{mx:.36,my:.44}}),attrs={strokeWidth:2,fill:getFillColor(element,"none"),stroke:getStrokeColor(element)};drawPath(parentGfx,pathData,attrs)}()}return diamond},"bpmn:Gateway":function(parentGfx,element){return drawDiamond(parentGfx,element.width,element.height)},"bpmn:SequenceFlow":function(parentGfx,element){var pathData=createPathFromConnection(element),fill=getFillColor(element),stroke=getStrokeColor(element),attrs={strokeLinejoin:"round",markerEnd:marker("sequenceflow-end",fill,stroke),stroke:getStrokeColor(element)},path=drawPath(parentGfx,pathData,attrs),sequenceFlow=getSemantic(element),source=element.source.businessObject;return sequenceFlow.conditionExpression&&source.$instanceOf("bpmn:Activity")&&svgAttr(path,{markerStart:marker("conditional-flow-marker",fill,stroke)}),source.default&&(source.$instanceOf("bpmn:Gateway")||source.$instanceOf("bpmn:Activity"))&&source.default===sequenceFlow&&svgAttr(path,{markerStart:marker("conditional-default-flow-marker",fill,stroke)}),path},"bpmn:Association":function(parentGfx,element,attrs){var semantic=getSemantic(element),fill=getFillColor(element),stroke=getStrokeColor(element);return attrs=assign({strokeDasharray:"0.5, 5",strokeLinecap:"round",strokeLinejoin:"round",stroke:getStrokeColor(element)},attrs||{}),"One"!==semantic.associationDirection&&"Both"!==semantic.associationDirection||(attrs.markerEnd=marker("association-end",fill,stroke)),"Both"===semantic.associationDirection&&(attrs.markerStart=marker("association-start",fill,stroke)),drawLine(parentGfx,element.waypoints,attrs)},"bpmn:DataInputAssociation":function(parentGfx,element){var fill=getFillColor(element),stroke=getStrokeColor(element);return renderer("bpmn:Association")(parentGfx,element,{markerEnd:marker("association-end",fill,stroke)})},"bpmn:DataOutputAssociation":function(parentGfx,element){var fill=getFillColor(element),stroke=getStrokeColor(element);return renderer("bpmn:Association")(parentGfx,element,{markerEnd:marker("association-end",fill,stroke)})},"bpmn:MessageFlow":function(parentGfx,element){var semantic=getSemantic(element),di=getDi(element),fill=getFillColor(element),stroke=getStrokeColor(element),pathData=createPathFromConnection(element),attrs={markerEnd:marker("messageflow-end",fill,stroke),markerStart:marker("messageflow-start",fill,stroke),strokeDasharray:"10, 12",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5px",stroke:getStrokeColor(element)},path=drawPath(parentGfx,pathData,attrs);if(semantic.messageRef){var midPoint=path.getPointAtLength(path.getTotalLength()/2),markerPathData=pathMap.getScaledPath("MESSAGE_FLOW_MARKER",{abspos:{x:midPoint.x,y:midPoint.y}}),messageAttrs={strokeWidth:1};"initiating"===di.messageVisibleKind?(messageAttrs.fill="white",messageAttrs.stroke="black"):(messageAttrs.fill="#888",messageAttrs.stroke="white"),drawPath(parentGfx,markerPathData,messageAttrs)}return path},"bpmn:DataObject":function(parentGfx,element){var pathData=pathMap.getScaledPath("DATA_OBJECT_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:.474,my:.296}}),elementObject=drawPath(parentGfx,pathData,{fill:getFillColor(element),stroke:getStrokeColor(element)});return isCollection(getSemantic(element))&&renderDataItemCollection(parentGfx,element),elementObject},"bpmn:DataObjectReference":as("bpmn:DataObject"),"bpmn:DataInput":function(parentGfx,element){var arrowPathData=pathMap.getRawPath("DATA_ARROW"),elementObject=renderer("bpmn:DataObject")(parentGfx,element);return drawPath(parentGfx,arrowPathData,{strokeWidth:1}),elementObject},"bpmn:DataOutput":function(parentGfx,element){var arrowPathData=pathMap.getRawPath("DATA_ARROW"),elementObject=renderer("bpmn:DataObject")(parentGfx,element);return drawPath(parentGfx,arrowPathData,{strokeWidth:1,fill:"black"}),elementObject},"bpmn:DataStoreReference":function(parentGfx,element){return drawPath(parentGfx,pathMap.getScaledPath("DATA_STORE",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:0,my:.133}}),{strokeWidth:2,fill:getFillColor(element),stroke:getStrokeColor(element)})},"bpmn:BoundaryEvent":function(parentGfx,element){var semantic=getSemantic(element),cancel=semantic.cancelActivity,attrs={strokeWidth:1,fill:getFillColor(element),stroke:getStrokeColor(element)};cancel||(attrs.strokeDasharray="6",attrs.strokeLinecap="round");var outer=renderer("bpmn:Event")(parentGfx,element,attrs);return drawCircle(parentGfx,element.width,element.height,INNER_OUTER_DIST,assign(attrs,{fill:"none"})),renderEventContent(element,parentGfx),outer},"bpmn:Group":function(parentGfx,element){return drawRect(parentGfx,element.width,element.height,TASK_BORDER_RADIUS,{strokeWidth:1,strokeDasharray:"8,3,1,3",fill:"none",pointerEvents:"none"})},label:function(parentGfx,element){return renderExternalLabel(parentGfx,element)},"bpmn:TextAnnotation":function(parentGfx,element){var style={fill:"none",stroke:"none"},textElement=drawRect(parentGfx,element.width,element.height,0,0,style);return drawPath(parentGfx,pathMap.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:0,my:0}}),{stroke:getStrokeColor(element)}),renderLabel(parentGfx,getSemantic(element).text||"",{box:element,align:"left-top",padding:5}),textElement},ParticipantMultiplicityMarker:function(parentGfx,element){drawMarker("participant-multiplicity",parentGfx,pathMap.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:element.width/2/element.width,my:(element.height-15)/element.height}}))},SubProcessMarker:function(parentGfx,element){var markerRect=drawRect(parentGfx,14,14,0,{strokeWidth:1,fill:getFillColor(element),stroke:getStrokeColor(element)});translate(markerRect,element.width/2-7.5,element.height-20),drawMarker("sub-process",parentGfx,pathMap.getScaledPath("MARKER_SUB_PROCESS",{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2-7.5)/element.width,my:(element.height-20)/element.height}}),{fill:getFillColor(element),stroke:getStrokeColor(element)})},ParallelMarker:function(parentGfx,element,position){drawMarker("parallel",parentGfx,pathMap.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2+position.parallel)/element.width,my:(element.height-20)/element.height}}))},SequentialMarker:function(parentGfx,element,position){drawMarker("sequential",parentGfx,pathMap.getScaledPath("MARKER_SEQUENTIAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2+position.seq)/element.width,my:(element.height-19)/element.height}}))},CompensationMarker:function(parentGfx,element,position){drawMarker("compensation",parentGfx,pathMap.getScaledPath("MARKER_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2+position.compensation)/element.width,my:(element.height-13)/element.height}}),{strokeWidth:1})},LoopMarker:function(parentGfx,element,position){drawMarker("loop",parentGfx,pathMap.getScaledPath("MARKER_LOOP",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2+position.loop)/element.width,my:(element.height-7)/element.height}}),{strokeWidth:1,fill:"none",strokeLinecap:"round",strokeMiterlimit:.5})},AdhocMarker:function(parentGfx,element,position){drawMarker("adhoc",parentGfx,pathMap.getScaledPath("MARKER_ADHOC",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2+position.adhoc)/element.width,my:(element.height-15)/element.height}}),{strokeWidth:1,fill:"black"})}}}function isTypedEvent(event,eventDefinitionType,filter){function matches(definition,filter){return every(filter,function(val,key){return definition[key]==val})}return some(event.eventDefinitions,function(definition){return definition.$type===eventDefinitionType&&matches(event,filter)})}function isThrowEvent(event){return"bpmn:IntermediateThrowEvent"===event.$type||"bpmn:EndEvent"===event.$type}function isCollection(element){var dataObject=element.dataObjectRef;return element.isCollection||dataObject&&dataObject.isCollection}function getDi(element){return element.businessObject.di}function getSemantic(element){return element.businessObject}function getCirclePath(shape){var cx=shape.x+shape.width/2,cy=shape.y+shape.height/2,radius=shape.width/2;return componentsToPath([["M",cx,cy],["m",0,-radius],["a",radius,radius,0,1,1,0,2*radius],["a",radius,radius,0,1,1,0,-2*radius],["z"]])}function getRoundRectPath(shape,borderRadius){var x=shape.x,y=shape.y,width=shape.width,height=shape.height;return componentsToPath([["M",x+borderRadius,y],["l",width-2*borderRadius,0],["a",borderRadius,borderRadius,0,0,1,borderRadius,borderRadius],["l",0,height-2*borderRadius],["a",borderRadius,borderRadius,0,0,1,-borderRadius,borderRadius],["l",2*borderRadius-width,0],["a",borderRadius,borderRadius,0,0,1,-borderRadius,-borderRadius],["l",0,2*borderRadius-height],["a",borderRadius,borderRadius,0,0,1,borderRadius,-borderRadius],["z"]])}function getDiamondPath(shape){var width=shape.width,height=shape.height,x=shape.x,y=shape.y,halfWidth=width/2,halfHeight=height/2;return componentsToPath([["M",x+halfWidth,y],["l",halfWidth,halfHeight],["l",-halfWidth,halfHeight],["l",-halfWidth,-halfHeight],["z"]])}function getRectPath(shape){var x=shape.x,y=shape.y,width=shape.width,height=shape.height;return componentsToPath([["M",x,y],["l",width,0],["l",0,height],["l",-width,0],["z"]])}function getFillColor(element,defaultColor){return getBusinessObject(element).di.get("fill")||defaultColor||"white"}function getStrokeColor(element,defaultColor){return getBusinessObject(element).di.get("stroke")||defaultColor||"black"}var inherits=_dereq_(82),isObject=_dereq_(197),assign=_dereq_(202),forEach=_dereq_(90),every=_dereq_(87),some=_dereq_(94),BaseRenderer=_dereq_(46),TextUtil=_dereq_(72),DiUtil=_dereq_(15),getBusinessObject=_dereq_(17).getBusinessObject,is=_dereq_(17).is,RenderUtil=_dereq_(70),componentsToPath=RenderUtil.componentsToPath,createLine=RenderUtil.createLine,domQuery=_dereq_(218),svgAppend=_dereq_(255),svgAttr=_dereq_(257),svgCreate=_dereq_(260),svgClasses=_dereq_(258),rotate=_dereq_(71).rotate,transform=_dereq_(71).transform,translate=_dereq_(71).translate,Ids=_dereq_(80),RENDERER_IDS=new Ids,TASK_BORDER_RADIUS=10,INNER_OUTER_DIST=3,LABEL_STYLE={fontFamily:"Arial, sans-serif",fontSize:12};inherits(BpmnRenderer,BaseRenderer),BpmnRenderer.$inject=["eventBus","styles","pathMap","canvas"],module.exports=BpmnRenderer,BpmnRenderer.prototype.canRender=function(element){return is(element,"bpmn:BaseElement")},BpmnRenderer.prototype.drawShape=function(parentGfx,element){var type=element.type;return(0,this.handlers[type])(parentGfx,element)},BpmnRenderer.prototype.drawConnection=function(parentGfx,element){var type=element.type;return(0,this.handlers[type])(parentGfx,element)},BpmnRenderer.prototype.getShapePath=function(element){return is(element,"bpmn:Event")?getCirclePath(element):is(element,"bpmn:Activity")?getRoundRectPath(element,TASK_BORDER_RADIUS):is(element,"bpmn:Gateway")?getDiamondPath(element):getRectPath(element)}},{15:15,17:17,197:197,202:202,218:218,255:255,257:257,258:258,260:260,46:46,70:70,71:71,72:72,80:80,82:82,87:87,90:90,94:94}],8:[function(_dereq_,module,exports){"use strict";function PathMap(){this.pathMap={EVENT_MESSAGE:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:36,width:36,heightElements:[6,14],widthElements:[10.5,21]},EVENT_SIGNAL:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z",height:36,width:36,heightElements:[18],widthElements:[10,20]},EVENT_ESCALATION:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x0},-{e.y1} l -{e.x0},{e.y1} Z",height:36,width:36,heightElements:[20,7],widthElements:[8]},EVENT_CONDITIONAL:{d:"M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z M {e.x2},{e.y3} l {e.x0},0 M {e.x2},{e.y4} l {e.x0},0 M {e.x2},{e.y5} l {e.x0},0 M {e.x2},{e.y6} l {e.x0},0 M {e.x2},{e.y7} l {e.x0},0 M {e.x2},{e.y8} l {e.x0},0 ",height:36,width:36,heightElements:[8.5,14.5,18,11.5,14.5,17.5,20.5,23.5,26.5],widthElements:[10.5,14.5,12.5]},EVENT_LINK:{d:"m {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z",height:36,width:36,heightElements:[4.4375,6.75,7.8125],widthElements:[9.84375,13.5]},EVENT_ERROR:{d:"m {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z",height:36,width:36,heightElements:[.023,8.737,8.151,16.564,10.591,8.714],widthElements:[.085,6.672,6.97,4.273,5.337,6.636]},EVENT_CANCEL_45:{d:"m {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:36,width:36,heightElements:[4.75,8.5],widthElements:[4.75,8.5]},EVENT_COMPENSATION:{d:"m {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x1},-{e.y2} {e.x2},-{e.y3} 0,{e.y1} -{e.x2},-{e.y3} z",height:36,width:36,heightElements:[6.5,13,.4,6.1],widthElements:[9,9.3,8.7]},EVENT_TIMER_WH:{d:"M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ",height:36,width:36,heightElements:[10,2],widthElements:[3,7]},EVENT_TIMER_LINE:{d:"M {mx},{my} m {e.x0},{e.y0} l -{e.x1},{e.y1} ",height:36,width:36,heightElements:[10,3],widthElements:[0,0]},EVENT_MULTIPLE:{d:"m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z",height:36,width:36,heightElements:[6.28099,12.56199],widthElements:[3.1405,9.42149,12.56198]},EVENT_PARALLEL_MULTIPLE:{d:"m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} -{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z",height:36,width:36,heightElements:[2.56228,7.68683],widthElements:[2.56228,7.68683]},GATEWAY_EXCLUSIVE:{d:"m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} {e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} {e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z",height:17.5,width:17.5,heightElements:[8.5,6.5312,-6.5312,-8.5],widthElements:[6.5,-6.5,3,-3,5,-5]},GATEWAY_PARALLEL:{d:"m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:30,width:30,heightElements:[5,12.5],widthElements:[5,12.5]},GATEWAY_EVENT_BASED:{d:"m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z",height:11,width:11,heightElements:[-6,6,12,-12],widthElements:[9,-3,-12]},GATEWAY_COMPLEX:{d:"m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} {e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} {e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} -{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z",height:17.125,width:17.125,heightElements:[4.875,3.4375,2.125,3],widthElements:[3.4375,2.125,4.875,3]},DATA_OBJECT_PATH:{d:"m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0",height:61,width:51,heightElements:[10,50,60],widthElements:[10,40,50,60]},DATA_OBJECT_COLLECTION_PATH:{d:"m {mx}, {my} m  0 15  l 0 -15 m  4 15  l 0 -15 m  4 15  l 0 -15 ",height:61,width:51,heightElements:[12],widthElements:[1,6,12,15]},DATA_ARROW:{d:"m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z",height:61,width:51,heightElements:[],widthElements:[]},DATA_STORE:{d:"m  {mx},{my} l  0,{e.y2} c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 l  0,-{e.y2} c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1} {e.x2},0m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0",height:61,width:61,heightElements:[7,10,45],widthElements:[2,58,60]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",height:30,width:10,heightElements:[30],widthElements:[10]},MARKER_SUB_PROCESS:{d:"m{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_PARALLEL:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},MARKER_SEQUENTIAL:{d:"m{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_COMPENSATION:{d:"m {mx},{my} 7,-5 0,10 z m 7.1,-0.3 6.9,-4.7 0,10 -6.9,-4.7 z",height:10,width:21,heightElements:[],widthElements:[]},MARKER_LOOP:{d:"m {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 -6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902",height:13.9,width:13.7,heightElements:[],widthElements:[]},MARKER_ADHOC:{d:"m {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 -3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 -2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z",height:4,width:15,heightElements:[],widthElements:[]},TASK_TYPE_SEND:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:14,width:21,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_SCRIPT:{d:"m {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z m -7,-12 l 5,0 m -4.5,3 l 4.5,0 m -3,3 l 5,0m -4,3 l 5,0",height:15,width:12.6,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_USER_1:{d:"m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 -4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 zm -8,6 l 0,5.5 m 11,0 l 0,-5"},TASK_TYPE_USER_2:{d:"m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 -2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 "},TASK_TYPE_USER_3:{d:"m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 -4.20799998,3.36699999 -4.20699998,4.34799999 z"},TASK_TYPE_MANUAL:{d:"m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 -0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 -1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 -10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 -0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 -1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 -0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 -5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z"},TASK_TYPE_INSTANTIATING_SEND:{d:"m {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6"},TASK_TYPE_SERVICE:{d:"m {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 -1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 -0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 -1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 -0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z m 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_SERVICE_FILL:{d:"m {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_BUSINESS_RULE_HEADER:{d:"m {mx},{my} 0,4 20,0 0,-4 z"},TASK_TYPE_BUSINESS_RULE_MAIN:{d:"m {mx},{my} 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"},MESSAGE_FLOW_MARKER:{d:"m {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6"}},this.getRawPath=function(pathId){return this.pathMap[pathId].d},this.getScaledPath=function(pathId,param){var mx,my,rawPath=this.pathMap[pathId];param.abspos?(mx=param.abspos.x,my=param.abspos.y):(mx=param.containerWidth*param.position.mx,my=param.containerHeight*param.position.my);var coordinates={};if(param.position){for(var heightRatio=param.containerHeight/rawPath.height*param.yScaleFactor,widthRatio=param.containerWidth/rawPath.width*param.xScaleFactor,heightIndex=0;heightIndex<rawPath.heightElements.length;heightIndex++)coordinates["y"+heightIndex]=rawPath.heightElements[heightIndex]*heightRatio;for(var widthIndex=0;widthIndex<rawPath.widthElements.length;widthIndex++)coordinates["x"+widthIndex]=rawPath.widthElements[widthIndex]*widthRatio}return format(rawPath.d,{mx:mx,my:my,e:coordinates})}}function replacer(all,key,obj){var res=obj;return key.replace(objNotationRegex,function(all,name,quote,quotedName,isFunc){name=name||quotedName,res&&(name in res&&(res=res[name]),"function"==typeof res&&isFunc&&(res=res()))}),res=(null==res||res==obj?all:res)+""}function format(str,obj){return String(str).replace(tokenRegex,function(all,key){return replacer(all,key,obj)})}module.exports=PathMap;var tokenRegex=/\{([^\}]+)\}/g,objNotationRegex=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g},{}],9:[function(_dereq_,module,exports){module.exports={__init__:["bpmnRenderer"],bpmnRenderer:["type",_dereq_(7)],pathMap:["type",_dereq_(8)]}},{7:7,8:8}],10:[function(_dereq_,module,exports){"use strict";function elementData(semantic,attrs){return assign({id:semantic.id,type:semantic.$type,businessObject:semantic},attrs)}function collectWaypoints(waypoints){return map(waypoints,function(p){return{x:p.x,y:p.y}})}function notYetDrawn(translate,semantic,refSemantic,property){return new Error(translate("element {element} referenced by {referenced}#{property} not yet drawn",{element:elementToString(refSemantic),referenced:elementToString(semantic),property:property}))}function BpmnImporter(eventBus,canvas,elementFactory,elementRegistry,translate){this._eventBus=eventBus,this._canvas=canvas,this._elementFactory=elementFactory,this._elementRegistry=elementRegistry,this._translate=translate,this._textUtil=new TextUtil}function getLayoutedBounds(bounds,text,textUtil){var layoutedLabelDimensions=textUtil.getDimensions(text,{box:{width:90,height:30,x:bounds.width/2+bounds.x,y:bounds.height/2+bounds.y},style:EXTERNAL_LABEL_STYLE});return{x:Math.round(bounds.x+bounds.width/2-layoutedLabelDimensions.width/2),y:Math.round(bounds.y),width:Math.ceil(layoutedLabelDimensions.width),height:Math.ceil(layoutedLabelDimensions.height)}}var assign=_dereq_(202),map=_dereq_(92),LabelUtil=_dereq_(16),TextUtil=_dereq_(72),is=_dereq_(17).is,hasExternalLabel=LabelUtil.hasExternalLabel,getExternalLabelBounds=LabelUtil.getExternalLabelBounds,isExpanded=_dereq_(15).isExpanded,elementToString=_dereq_(13).elementToString;BpmnImporter.$inject=["eventBus","canvas","elementFactory","elementRegistry","translate"],module.exports=BpmnImporter,BpmnImporter.prototype.add=function(semantic,parentElement){var element,hidden,di=semantic.di,translate=this._translate;if(is(di,"bpmndi:BPMNPlane"))element=this._elementFactory.createRoot(elementData(semantic)),this._canvas.setRootElement(element);else if(is(di,"bpmndi:BPMNShape")){var collapsed=!isExpanded(semantic);hidden=parentElement&&(parentElement.hidden||parentElement.collapsed);var bounds=semantic.di.bounds;element=this._elementFactory.createShape(elementData(semantic,{collapsed:collapsed,hidden:hidden,x:Math.round(bounds.x),y:Math.round(bounds.y),width:Math.round(bounds.width),height:Math.round(bounds.height)})),is(semantic,"bpmn:BoundaryEvent")&&this._attachBoundary(semantic,element),this._canvas.addShape(element,parentElement)}else{if(!is(di,"bpmndi:BPMNEdge"))throw new Error(translate("unknown di {di} for element {semantic}",{di:elementToString(di),semantic:elementToString(semantic)}));var source=this._getSource(semantic),target=this._getTarget(semantic);hidden=parentElement&&(parentElement.hidden||parentElement.collapsed),element=this._elementFactory.createConnection(elementData(semantic,{hidden:hidden,source:source,target:target,waypoints:collectWaypoints(semantic.di.waypoint)})),is(semantic,"bpmn:DataAssociation")&&(parentElement=null),this._canvas.addConnection(element,parentElement)}return hasExternalLabel(semantic)&&this.addLabel(semantic,element),this._eventBus.fire("bpmnElement.added",{element:element}),element},BpmnImporter.prototype._attachBoundary=function(boundarySemantic,boundaryElement){var translate=this._translate,hostSemantic=boundarySemantic.attachedToRef;if(!hostSemantic)throw new Error(translate("missing {semantic}#attachedToRef",{semantic:elementToString(boundarySemantic)}));var host=this._elementRegistry.get(hostSemantic.id),attachers=host&&host.attachers;if(!host)throw notYetDrawn(translate,boundarySemantic,hostSemantic,"attachedToRef");boundaryElement.host=host,attachers||(host.attachers=attachers=[]),-1===attachers.indexOf(boundaryElement)&&attachers.push(boundaryElement)},BpmnImporter.prototype.addLabel=function(semantic,element){var bounds,text,label;return bounds=getExternalLabelBounds(semantic,element),text=semantic.name,text&&(bounds=getLayoutedBounds(bounds,text,this._textUtil)),label=this._elementFactory.createLabel(elementData(semantic,{id:semantic.id+"_label",labelTarget:element,type:"label",
hidden:element.hidden||!semantic.name,x:Math.round(bounds.x),y:Math.round(bounds.y),width:Math.round(bounds.width),height:Math.round(bounds.height)})),this._canvas.addShape(label,element.parent)},BpmnImporter.prototype._getEnd=function(semantic,side){var element,refSemantic,type=semantic.$type,translate=this._translate;if(refSemantic=semantic[side+"Ref"],"source"===side&&"bpmn:DataInputAssociation"===type&&(refSemantic=refSemantic&&refSemantic[0]),("source"===side&&"bpmn:DataOutputAssociation"===type||"target"===side&&"bpmn:DataInputAssociation"===type)&&(refSemantic=semantic.$parent),element=refSemantic&&this._getElement(refSemantic))return element;throw refSemantic?notYetDrawn(translate,semantic,refSemantic,side+"Ref"):new Error(translate("{semantic}#{side} Ref not specified",{semantic:elementToString(semantic),side:side}))},BpmnImporter.prototype._getSource=function(semantic){return this._getEnd(semantic,"source")},BpmnImporter.prototype._getTarget=function(semantic){return this._getEnd(semantic,"target")},BpmnImporter.prototype._getElement=function(semantic){return this._elementRegistry.get(semantic.id)};var EXTERNAL_LABEL_STYLE={fontFamily:"Arial, sans-serif",fontSize:"11px"}},{13:13,15:15,16:16,17:17,202:202,72:72,92:92}],11:[function(_dereq_,module,exports){"use strict";function is(element,type){return element.$instanceOf(type)}function findDisplayCandidate(definitions){return find(definitions.rootElements,function(e){return is(e,"bpmn:Process")||is(e,"bpmn:Collaboration")})}function BpmnTreeWalker(handler,translate){function contextual(fn,ctx){return function(e){fn(e,ctx)}}function handled(element){handledElements[element.id]=element}function isHandled(element){return handledElements[element.id]}function visit(element,ctx){if(element.gfx)throw new Error(translate("already rendered {element}",{element:elementToString(element)}));return handler.element(element,ctx)}function visitRoot(element,diagram){return handler.root(element,diagram)}function visitIfDi(element,ctx){try{var gfx=element.di&&visit(element,ctx);return handled(element),gfx}catch(e){logError(e.message,{element:element,error:e}),console.error(translate("failed to import {element}",{element:elementToString(element)})),console.error(e)}}function logError(message,context){handler.error(message,context)}function registerDi(di){var bpmnElement=di.bpmnElement;bpmnElement?bpmnElement.di?logError(translate("multiple DI elements defined for {element}",{element:elementToString(bpmnElement)}),{element:bpmnElement}):(diRefs.bind(bpmnElement,"di"),bpmnElement.di=di):logError(translate("no bpmnElement referenced in {element}",{element:elementToString(di)}),{element:di})}function handleDiagram(diagram){handlePlane(diagram.plane)}function handlePlane(plane){registerDi(plane),forEach(plane.planeElement,handlePlaneElement)}function handlePlaneElement(planeElement){registerDi(planeElement)}function handleDefinitions(definitions,diagram){var diagrams=definitions.diagrams;if(diagram&&-1===diagrams.indexOf(diagram))throw new Error(translate("diagram not part of bpmn:Definitions"));if(!diagram&&diagrams&&diagrams.length&&(diagram=diagrams[0]),!diagram)throw new Error(translate("no diagram to display"));handleDiagram(diagram);var plane=diagram.plane;if(!plane)throw new Error(translate("no plane for {element}",{element:elementToString(diagram)}));var rootElement=plane.bpmnElement;if(!rootElement){if(!(rootElement=findDisplayCandidate(definitions)))throw new Error(translate("no process or collaboration to display"));logError(translate("correcting missing bpmnElement on {plane} to {rootElement}",{plane:elementToString(plane),rootElement:elementToString(rootElement)})),plane.bpmnElement=rootElement,registerDi(plane)}var ctx=visitRoot(rootElement,plane);if(is(rootElement,"bpmn:Process"))handleProcess(rootElement,ctx);else{if(!is(rootElement,"bpmn:Collaboration"))throw new Error(translate("unsupported bpmnElement for {plane}: {rootElement}",{plane:elementToString(plane),rootElement:elementToString(rootElement)}));handleCollaboration(rootElement),handleUnhandledProcesses(definitions.rootElements)}handleDeferred(deferred)}function handleDeferred(deferred){forEach(deferred,function(d){d()})}function handleProcess(process,context){handleFlowElementsContainer(process,context),handleIoSpecification(process.ioSpecification,context),handleArtifacts(process.artifacts,context),handled(process)}function handleUnhandledProcesses(rootElements){filter(rootElements,function(e){return!isHandled(e)&&is(e,"bpmn:Process")&&e.laneSets}).forEach(contextual(handleProcess))}function handleMessageFlow(messageFlow,context){visitIfDi(messageFlow,context)}function handleMessageFlows(messageFlows,context){forEach(messageFlows,contextual(handleMessageFlow,context))}function handleDataAssociation(association,context){visitIfDi(association,context)}function handleDataInput(dataInput,context){visitIfDi(dataInput,context)}function handleDataOutput(dataOutput,context){visitIfDi(dataOutput,context)}function handleArtifact(artifact,context){visitIfDi(artifact,context)}function handleArtifacts(artifacts,context){forEach(artifacts,function(e){is(e,"bpmn:Association")?deferred.push(function(){handleArtifact(e,context)}):handleArtifact(e,context)})}function handleIoSpecification(ioSpecification,context){ioSpecification&&(forEach(ioSpecification.dataInputs,contextual(handleDataInput,context)),forEach(ioSpecification.dataOutputs,contextual(handleDataOutput,context)))}function handleSubProcess(subProcess,context){handleFlowElementsContainer(subProcess,context),handleArtifacts(subProcess.artifacts,context)}function handleFlowNode(flowNode,context){var childCtx=visitIfDi(flowNode,context);is(flowNode,"bpmn:SubProcess")&&handleSubProcess(flowNode,childCtx||context),is(flowNode,"bpmn:Activity")&&handleIoSpecification(flowNode.ioSpecification,context),deferred.push(function(){forEach(flowNode.dataInputAssociations,contextual(handleDataAssociation,context)),forEach(flowNode.dataOutputAssociations,contextual(handleDataAssociation,context))})}function handleSequenceFlow(sequenceFlow,context){visitIfDi(sequenceFlow,context)}function handleDataElement(dataObject,context){visitIfDi(dataObject,context)}function handleBoundaryEvent(dataObject,context){visitIfDi(dataObject,context)}function handleLane(lane,context){var newContext=visitIfDi(lane,context);lane.childLaneSet&&handleLaneSet(lane.childLaneSet,newContext||context),wireFlowNodeRefs(lane)}function handleLaneSet(laneSet,context){forEach(laneSet.lanes,contextual(handleLane,context))}function handleLaneSets(laneSets,context){forEach(laneSets,contextual(handleLaneSet,context))}function handleFlowElementsContainer(container,context){container.laneSets&&handleLaneSets(container.laneSets,context),handleFlowElements(container.flowElements,context)}function handleFlowElements(flowElements,context){forEach(flowElements,function(e){is(e,"bpmn:SequenceFlow")?deferred.push(function(){handleSequenceFlow(e,context)}):is(e,"bpmn:BoundaryEvent")?deferred.unshift(function(){handleBoundaryEvent(e,context)}):is(e,"bpmn:FlowNode")?handleFlowNode(e,context):is(e,"bpmn:DataObject")||(is(e,"bpmn:DataStoreReference")?handleDataElement(e,context):is(e,"bpmn:DataObjectReference")?handleDataElement(e,context):logError(translate("unrecognized flowElement {element} in context {context}",{element:elementToString(e),context:context?elementToString(context.businessObject):"null"}),{element:e,context:context}))})}function handleParticipant(participant,context){var newCtx=visitIfDi(participant,context),process=participant.processRef;process&&handleProcess(process,newCtx||context)}function handleCollaboration(collaboration){forEach(collaboration.participants,contextual(handleParticipant)),handleArtifacts(collaboration.artifacts),deferred.push(function(){handleMessageFlows(collaboration.messageFlows)})}function wireFlowNodeRefs(lane){forEach(lane.flowNodeRef,function(flowNode){var lanes=flowNode.get("lanes");lanes&&lanes.push(lane)})}var handledElements={},deferred=[];return{handleDefinitions:handleDefinitions}}var filter=_dereq_(88),find=_dereq_(89),forEach=_dereq_(90),Refs=_dereq_(232),elementToString=_dereq_(13).elementToString,diRefs=new Refs({name:"bpmnElement",enumerable:!0},{name:"di"});module.exports=BpmnTreeWalker},{13:13,232:232,88:88,89:89,90:90}],12:[function(_dereq_,module,exports){"use strict";function importBpmnDiagram(diagram,definitions,done){var error,importer=diagram.get("bpmnImporter"),eventBus=diagram.get("eventBus"),translate=diagram.get("translate"),warnings=[];eventBus.fire("import.render.start",{definitions:definitions});try{!function(definitions){new BpmnTreeWalker({root:function(element){return importer.add(element)},element:function(element,parentShape){return importer.add(element,parentShape)},error:function(message,context){warnings.push({message:message,context:context})}},translate).handleDefinitions(definitions)}(definitions)}catch(e){error=e}eventBus.fire("import.render.complete",{error:error,warnings:warnings}),done(error,warnings)}var BpmnTreeWalker=_dereq_(11);module.exports.importBpmnDiagram=importBpmnDiagram},{11:11}],13:[function(_dereq_,module,exports){"use strict";module.exports.elementToString=function(e){return e?"<"+e.$type+(e.id?' id="'+e.id:"")+'" />':"<null>"}},{}],14:[function(_dereq_,module,exports){module.exports={__depends__:[_dereq_(60)],bpmnImporter:["type",_dereq_(10)]}},{10:10,60:60}],15:[function(_dereq_,module,exports){"use strict";function hasEventDefinition(element,eventType){var bo=getBusinessObject(element),hasEventDefinition=!1;return bo.eventDefinitions&&forEach(bo.eventDefinitions,function(event){is(event,eventType)&&(hasEventDefinition=!0)}),hasEventDefinition}var is=_dereq_(17).is,getBusinessObject=_dereq_(17).getBusinessObject,forEach=_dereq_(90);module.exports.isExpanded=function(element){return!is(element,"bpmn:CallActivity")&&(is(element,"bpmn:SubProcess")?!!getBusinessObject(element).di.isExpanded:!is(element,"bpmn:Participant")||!!getBusinessObject(element).processRef)},module.exports.isInterrupting=function(element){return element&&!1!==getBusinessObject(element).isInterrupting},module.exports.isEventSubProcess=function(element){return element&&!!getBusinessObject(element).triggeredByEvent},module.exports.hasEventDefinition=hasEventDefinition,module.exports.hasErrorEventDefinition=function(element){return hasEventDefinition(element,"bpmn:ErrorEventDefinition")},module.exports.hasEscalationEventDefinition=function(element){return hasEventDefinition(element,"bpmn:EscalationEventDefinition")},module.exports.hasCompensateEventDefinition=function(element){return hasEventDefinition(element,"bpmn:CompensateEventDefinition")}},{17:17,90:90}],16:[function(_dereq_,module,exports){"use strict";function getFlowLabelPosition(waypoints){var mid=waypoints.length/2-1,first=waypoints[Math.floor(mid)],second=waypoints[Math.ceil(mid+.01)],position=getWaypointsMid(waypoints),angle=Math.atan((second.y-first.y)/(second.x-first.x)),x=position.x,y=position.y;return Math.abs(angle)<Math.PI/2?y-=FLOW_LABEL_INDENT:x+=FLOW_LABEL_INDENT,{x:x,y:y}}function getWaypointsMid(waypoints){var mid=waypoints.length/2-1,first=waypoints[Math.floor(mid)],second=waypoints[Math.ceil(mid+.01)];return{x:first.x+(second.x-first.x)/2,y:first.y+(second.y-first.y)/2}}function getExternalLabelMid(element){return element.waypoints?getFlowLabelPosition(element.waypoints):{x:element.x+element.width/2,y:element.y+element.height+DEFAULT_LABEL_SIZE.height/2}}var assign=_dereq_(202),is=_dereq_(17).is,DEFAULT_LABEL_SIZE=module.exports.DEFAULT_LABEL_SIZE={width:90,height:20},FLOW_LABEL_INDENT=module.exports.FLOW_LABEL_INDENT=15;module.exports.hasExternalLabel=function(semantic){return is(semantic,"bpmn:Event")||is(semantic,"bpmn:Gateway")||is(semantic,"bpmn:DataStoreReference")||is(semantic,"bpmn:DataObjectReference")||is(semantic,"bpmn:SequenceFlow")||is(semantic,"bpmn:MessageFlow")},module.exports.getFlowLabelPosition=getFlowLabelPosition,module.exports.getWaypointsMid=getWaypointsMid,module.exports.getExternalLabelMid=getExternalLabelMid,module.exports.getExternalLabelBounds=function(semantic,element){var mid,size,bounds,di=semantic.di,label=di.label;return label&&label.bounds?(bounds=label.bounds,size={width:Math.max(DEFAULT_LABEL_SIZE.width,bounds.width),height:bounds.height},mid={x:bounds.x+bounds.width/2,y:bounds.y+bounds.height/2}):(mid=getExternalLabelMid(element),size=DEFAULT_LABEL_SIZE),assign({x:mid.x-size.width/2,y:mid.y-size.height/2},size)}},{17:17,202:202}],17:[function(_dereq_,module,exports){"use strict";function is(element,type){var bo=getBusinessObject(element);return bo&&"function"==typeof bo.$instanceOf&&bo.$instanceOf(type)}function getBusinessObject(element){return element&&element.businessObject||element}module.exports.is=is,module.exports.getBusinessObject=getBusinessObject},{}],18:[function(_dereq_,module,exports){"use strict";function css(attrs){return attrs.join(";")}function open(){lightbox||(lightbox=domify(LIGHTBOX_MARKUP),domDelegate.bind(lightbox,".backdrop","click",function(event){document.body.removeChild(lightbox)})),document.body.appendChild(lightbox)}var lightbox,domify=_dereq_(216),domDelegate=_dereq_(215),logoData=module.exports.BPMNIO_LOGO="iVBORw0KGgoAAAANSUhEUgAAADQAAAA0CAMAAADypuvZAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADBQTFRFiMte9PrwldFwfcZPqtqN0+zEyOe1XLgjvuKncsJAZ70y6fXh3vDT////UrQV////G2zN+AAAABB0Uk5T////////////////////AOAjXRkAAAHDSURBVHjavJZJkoUgDEBJmAX8979tM8u3E6x20VlYJfFFMoL4vBDxATxZcakIOJTWSmxvKWVIkJ8jHvlRv1F2LFrVISCZI+tCtQx+XfewgVTfyY3plPiQEAzI3zWy+kR6NBhFBYeBuscJLOUuA2WVLpCjVIaFzrNQZArxAZKUQm6gsj37L9Cb7dnIBUKxENaaMJQqMpDXvSL+ktxdGRm2IsKgJGGPg7atwUG5CcFUEuSv+CwQqizTrvDTNXdMU2bMiDWZd8d7QIySWVRsb2vBBioxOFt4OinPBapL+neAb5KL5IJ8szOza2/DYoipUCx+CjO0Bpsv0V6mktNZ+k8rlABlWG0FrOpKYVo8DT3dBeLEjUBAj7moDogVii7nSS9QzZnFcOVBp1g2PyBQ3Vr5aIapN91VJy33HTJLC1iX2FY6F8gRdaAeIEfVONgtFCzZTmoLEdOjBDfsIOA6128gw3eu1shAajdZNAORxuQDJN5A5PbEG6gNIu24QJD5iNyRMZIr6bsHbCtCU/OaOaSvgkUyDMdDa1BXGf5HJ1To+/Ym6mCKT02Y+/Sa126ZKyd3jxhzpc1r8zVL6YM1Qy/kR4ABAFJ6iQUnivhAAAAAAElFTkSuQmCC",LIGHTBOX_STYLES=css(["z-index: 1001","position: fixed","top: 0","left: 0","right: 0","bottom: 0"]),BACKDROP_STYLES=css(["width: 100%","height: 100%","background: rgba(0,0,0,0.2)"]),NOTICE_STYLES=css(["position: absolute","left: 50%","top: 40%","margin: 0 -130px","width: 260px","padding: 10px","background: white","border: solid 1px #AAA","border-radius: 3px","font-family: Helvetica, Arial, sans-serif","font-size: 14px","line-height: 1.2em"]),LIGHTBOX_MARKUP='<div class="bjs-powered-by-lightbox" style="'+LIGHTBOX_STYLES+'"><div class="backdrop" style="'+BACKDROP_STYLES+'"></div><div class="notice" style="'+NOTICE_STYLES+'"><a href="http://bpmn.io" target="_blank" style="float: left; margin-right: 10px"><img src="data:image/png;base64,'+logoData+'"></a>Web-based tooling for BPMN, DMN and CMMN diagrams powered by <a href="http://bpmn.io" target="_blank">bpmn.io</a>.</div></div>';module.exports.open=open},{215:215,216:216}],19:[function(_dereq_,module,exports){module.exports=_dereq_(21)},{21:21}],20:[function(_dereq_,module,exports){"use strict";function BpmnModdle(packages,options){Moddle.call(this,packages,options)}var isString=_dereq_(199),isFunction=_dereq_(194),assign=_dereq_(202),Moddle=_dereq_(223),XmlReader=_dereq_(221),XmlWriter=_dereq_(222);BpmnModdle.prototype=Object.create(Moddle.prototype),module.exports=BpmnModdle,BpmnModdle.prototype.fromXML=function(xmlStr,typeName,options,done){isString(typeName)||(done=options,options=typeName,typeName="bpmn:Definitions"),isFunction(options)&&(done=options,options={});var reader=new XmlReader(assign({model:this,lax:!0},options)),rootHandler=reader.handler(typeName);reader.fromXML(xmlStr,rootHandler,done)},BpmnModdle.prototype.toXML=function(element,options,done){isFunction(options)&&(done=options,options={});var writer=new XmlWriter(options);try{var result=writer.toXML(element);done(null,result)}catch(e){done(e)}}},{194:194,199:199,202:202,221:221,222:222,223:223}],21:[function(_dereq_,module,exports){"use strict";var assign=_dereq_(202),BpmnModdle=_dereq_(20),packages={bpmn:_dereq_(23),bpmndi:_dereq_(24),dc:_dereq_(25),di:_dereq_(26),bioc:_dereq_(22)};module.exports=function(additionalPackages,options){return new BpmnModdle(assign({},packages,additionalPackages),options)}},{20:20,202:202,22:22,23:23,24:24,25:25,26:26}],22:[function(_dereq_,module,exports){module.exports={name:"bpmn.io colors for BPMN",uri:"http://bpmn.io/schema/bpmn/biocolor/1.0",prefix:"bioc",types:[{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]}],emumerations:[],associations:[]}},{}],23:[function(_dereq_,module,exports){module.exports={name:"BPMN20",uri:"http://www.omg.org/spec/BPMN/20100524/MODEL",associations:[],types:[{name:"Interface",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"operations",type:"Operation",isMany:!0},{name:"implementationRef",type:"String",isAttr:!0}]},{name:"Operation",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"inMessageRef",type:"Message",isReference:!0},{name:"outMessageRef",type:"Message",isReference:!0},{name:"errorRef",type:"Error",isMany:!0,isReference:!0},{name:"implementationRef",type:"String",isAttr:!0}]},{name:"EndPoint",superClass:["RootElement"]},{name:"Auditing",superClass:["BaseElement"]},{name:"GlobalTask",superClass:["CallableElement"],properties:[{name:"resources",type:"ResourceRole",isMany:!0}]},{name:"Monitoring",superClass:["BaseElement"]},{name:"Performer",superClass:["ResourceRole"]},{name:"Process",superClass:["FlowElementsContainer","CallableElement"],properties:[{name:"processType",type:"ProcessType",isAttr:!0},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"properties",type:"Property",isMany:!0},{name:"laneSets",type:"LaneSet",isMany:!0,replaces:"FlowElementsContainer#laneSets"},{name:"flowElements",type:"FlowElement",isMany:!0,replaces:"FlowElementsContainer#flowElements"},{name:"artifacts",type:"Artifact",isMany:!0},{name:"resources",type:"ResourceRole",isMany:!0},{name:"correlationSubscriptions",type:"CorrelationSubscription",isMany:!0},{name:"supports",type:"Process",isMany:!0,isReference:!0},{name:"definitionalCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"isExecutable",isAttr:!0,type:"Boolean"}]},{name:"LaneSet",superClass:["BaseElement"],properties:[{name:"lanes",type:"Lane",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Lane",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"partitionElementRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"partitionElement",type:"BaseElement"},{name:"flowNodeRef",type:"FlowNode",isMany:!0,isReference:!0},{name:"childLaneSet",type:"LaneSet",xml:{serialize:"xsi:type"}}]},{name:"GlobalManualTask",superClass:["GlobalTask"]},{name:"ManualTask",superClass:["Task"]},{name:"UserTask",superClass:["Task"],properties:[{name:"renderings",type:"Rendering",isMany:!0},{name:"implementation",isAttr:!0,type:"String"}]},{name:"Rendering",superClass:["BaseElement"]},{name:"HumanPerformer",superClass:["Performer"]},{name:"PotentialOwner",superClass:["HumanPerformer"]},{name:"GlobalUserTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"renderings",type:"Rendering",isMany:!0}]},{name:"Gateway",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"gatewayDirection",type:"GatewayDirection",default:"Unspecified",isAttr:!0}]},{name:"EventBasedGateway",superClass:["Gateway"],properties:[{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"eventGatewayType",type:"EventBasedGatewayType",isAttr:!0,default:"Exclusive"}]},{name:"ComplexGateway",superClass:["Gateway"],properties:[{name:"activationCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ExclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"InclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ParallelGateway",superClass:["Gateway"]},{name:"RootElement",isAbstract:!0,superClass:["BaseElement"]},{name:"Relationship",superClass:["BaseElement"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"direction",type:"RelationshipDirection",isAttr:!0},{name:"source",isMany:!0,isReference:!0,type:"Element"},{name:"target",isMany:!0,isReference:!0,type:"Element"}]},{name:"BaseElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,type:"String",isId:!0},{name:"documentation",type:"Documentation",isMany:!0},{name:"extensionDefinitions",type:"ExtensionDefinition",isMany:!0,isReference:!0},{name:"extensionElements",type:"ExtensionElements"}]},{name:"Extension",properties:[{name:"mustUnderstand",default:!1,isAttr:!0,type:"Boolean"},{name:"definition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"extensionAttributeDefinitions",type:"ExtensionAttributeDefinition",isMany:!0}]},{name:"ExtensionAttributeDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"type",isAttr:!0,type:"String"},{name:"isReference",default:!1,isAttr:!0,type:"Boolean"},{name:"extensionDefinition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionElements",properties:[{name:"valueRef",isAttr:!0,isReference:!0,type:"Element"},{name:"values",type:"Element",isMany:!0},{name:"extensionAttributeDefinition",type:"ExtensionAttributeDefinition",isAttr:!0,isReference:!0}]},{name:"Documentation",superClass:["BaseElement"],properties:[{name:"text",type:"String",isBody:!0},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Event",isAbstract:!0,superClass:["FlowNode","InteractionNode"],properties:[{name:"properties",type:"Property",isMany:!0}]},{name:"IntermediateCatchEvent",superClass:["CatchEvent"]},{name:"IntermediateThrowEvent",superClass:["ThrowEvent"]},{name:"EndEvent",superClass:["ThrowEvent"]},{name:"StartEvent",superClass:["CatchEvent"],properties:[{name:"isInterrupting",default:!0,isAttr:!0,type:"Boolean"}]},{name:"ThrowEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"inputSet",type:"InputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"CatchEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"parallelMultiple",isAttr:!0,type:"Boolean",default:!1},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"outputSet",type:"OutputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"BoundaryEvent",superClass:["CatchEvent"],properties:[{name:"cancelActivity",default:!0,isAttr:!0,type:"Boolean"},{name:"attachedToRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"EventDefinition",isAbstract:!0,superClass:["RootElement"]},{name:"CancelEventDefinition",superClass:["EventDefinition"]},{name:"ErrorEventDefinition",superClass:["EventDefinition"],properties:[{name:"errorRef",type:"Error",isAttr:!0,isReference:!0}]},{name:"TerminateEventDefinition",superClass:["EventDefinition"]},{name:"EscalationEventDefinition",superClass:["EventDefinition"],properties:[{name:"escalationRef",type:"Escalation",isAttr:!0,isReference:!0}]},{name:"Escalation",properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"escalationCode",isAttr:!0,type:"String"}],superClass:["RootElement"]},{name:"CompensateEventDefinition",superClass:["EventDefinition"],properties:[{name:"waitForCompletion",isAttr:!0,type:"Boolean"},{name:"activityRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"TimerEventDefinition",superClass:["EventDefinition"],properties:[{name:"timeDate",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeCycle",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeDuration",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"LinkEventDefinition",superClass:["EventDefinition"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"target",type:"LinkEventDefinition",isAttr:!0,isReference:!0},{name:"source",type:"LinkEventDefinition",isMany:!0,isReference:!0}]},{name:"MessageEventDefinition",superClass:["EventDefinition"],properties:[{name:"messageRef",type:"Message",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"ConditionalEventDefinition",superClass:["EventDefinition"],properties:[{name:"condition",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"SignalEventDefinition",superClass:["EventDefinition"],properties:[{name:"signalRef",type:"Signal",isAttr:!0,isReference:!0}]},{name:"Signal",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ImplicitThrowEvent",superClass:["ThrowEvent"]},{name:"DataState",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"ItemAwareElement",superClass:["BaseElement"],properties:[{name:"itemSubjectRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"dataState",type:"DataState"}]},{name:"DataAssociation",superClass:["BaseElement"],properties:[{name:"assignment",type:"Assignment",isMany:!0},{name:"sourceRef",type:"ItemAwareElement",isMany:!0,isReference:!0},{name:"targetRef",type:"ItemAwareElement",isReference:!0},{name:"transformation",type:"FormalExpression",xml:{serialize:"property"}}]},{name:"DataInput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"inputSetRef",type:"InputSet",isVirtual:!0,isMany:!0,isReference:!0},{name:"inputSetWithOptional",type:"InputSet",isVirtual:!0,isMany:!0,isReference:!0},{name:"inputSetWithWhileExecuting",type:"InputSet",isVirtual:!0,isMany:!0,isReference:!0}]},{name:"DataOutput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"outputSetRef",type:"OutputSet",isVirtual:!0,isMany:!0,isReference:!0},{name:"outputSetWithOptional",type:"OutputSet",isVirtual:!0,isMany:!0,isReference:!0},{name:"outputSetWithWhileExecuting",type:"OutputSet",isVirtual:!0,isMany:!0,isReference:!0}]},{name:"InputSet",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"dataInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"optionalInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"whileExecutingInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"outputSetRefs",type:"OutputSet",isMany:!0,isReference:!0}]},{name:"OutputSet",superClass:["BaseElement"],properties:[{name:"dataOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"inputSetRefs",type:"InputSet",isMany:!0,isReference:!0},{name:"optionalOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"whileExecutingOutputRefs",type:"DataOutput",isMany:!0,isReference:!0}]},{name:"Property",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"DataInputAssociation",superClass:["DataAssociation"]},{name:"DataOutputAssociation",superClass:["DataAssociation"]},{name:"InputOutputSpecification",superClass:["BaseElement"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"inputSets",type:"InputSet",isMany:!0},{name:"outputSets",type:"OutputSet",isMany:!0}]},{name:"DataObject",superClass:["FlowElement","ItemAwareElement"],properties:[{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"}]},{name:"InputOutputBinding",properties:[{name:"inputDataRef",type:"InputSet",isAttr:!0,isReference:!0},{name:"outputDataRef",type:"OutputSet",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"Assignment",superClass:["BaseElement"],properties:[{name:"from",type:"Expression",xml:{serialize:"xsi:type"}},{name:"to",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"DataStore",superClass:["RootElement","ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"capacity",isAttr:!0,type:"Integer"},{name:"isUnlimited",default:!0,isAttr:!0,type:"Boolean"}]},{name:"DataStoreReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataStoreRef",type:"DataStore",isAttr:!0,isReference:!0}]},{name:"DataObjectReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataObjectRef",type:"DataObject",isAttr:!0,isReference:!0}]},{name:"ConversationLink",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ConversationAssociation",superClass:["BaseElement"],properties:[{name:"innerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0},{name:"outerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0}]},{name:"CallConversation",superClass:["ConversationNode"],properties:[{name:"calledCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"Conversation",superClass:["ConversationNode"]},{name:"SubConversation",superClass:["ConversationNode"],properties:[{name:"conversationNodes",type:"ConversationNode",isMany:!0}]},{name:"ConversationNode",isAbstract:!0,superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRefs",type:"Participant",isMany:!0,isReference:!0},{name:"messageFlowRefs",type:"MessageFlow",isMany:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0}]},{name:"GlobalConversation",superClass:["Collaboration"]},{name:"PartnerEntity",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"PartnerRole",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"CorrelationProperty",superClass:["RootElement"],properties:[{name:"correlationPropertyRetrievalExpression",type:"CorrelationPropertyRetrievalExpression",isMany:!0},{name:"name",isAttr:!0,type:"String"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Error",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"errorCode",isAttr:!0,type:"String"}]},{name:"CorrelationKey",superClass:["BaseElement"],properties:[{name:"correlationPropertyRef",type:"CorrelationProperty",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Expression",superClass:["BaseElement"],isAbstract:!1,properties:[{name:"body",type:"String",isBody:!0}]},{name:"FormalExpression",superClass:["Expression"],properties:[{name:"language",isAttr:!0,type:"String"},{name:"evaluatesToTypeRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Message",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"itemRef",type:"ItemDefinition",isAttr:!0,
isReference:!0}]},{name:"ItemDefinition",superClass:["RootElement"],properties:[{name:"itemKind",type:"ItemKind",isAttr:!0},{name:"structureRef",type:"String",isAttr:!0},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"import",type:"Import",isAttr:!0,isReference:!0}]},{name:"FlowElement",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"categoryValueRef",type:"CategoryValue",isMany:!0,isReference:!0}]},{name:"SequenceFlow",superClass:["FlowElement"],properties:[{name:"isImmediate",isAttr:!0,type:"Boolean"},{name:"conditionExpression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"sourceRef",type:"FlowNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"FlowNode",isAttr:!0,isReference:!0}]},{name:"FlowElementsContainer",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"laneSets",type:"LaneSet",isMany:!0},{name:"flowElements",type:"FlowElement",isMany:!0}]},{name:"CallableElement",isAbstract:!0,superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"supportedInterfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"ioBinding",type:"InputOutputBinding",isMany:!0,xml:{serialize:"property"}}]},{name:"FlowNode",isAbstract:!0,superClass:["FlowElement"],properties:[{name:"incoming",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"outgoing",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"lanes",type:"Lane",isVirtual:!0,isMany:!0,isReference:!0}]},{name:"CorrelationPropertyRetrievalExpression",superClass:["BaseElement"],properties:[{name:"messagePath",type:"FormalExpression"},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"CorrelationPropertyBinding",superClass:["BaseElement"],properties:[{name:"dataPath",type:"FormalExpression"},{name:"correlationPropertyRef",type:"CorrelationProperty",isAttr:!0,isReference:!0}]},{name:"Resource",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"resourceParameters",type:"ResourceParameter",isMany:!0}]},{name:"ResourceParameter",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isRequired",isAttr:!0,type:"Boolean"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"CorrelationSubscription",superClass:["BaseElement"],properties:[{name:"correlationKeyRef",type:"CorrelationKey",isAttr:!0,isReference:!0},{name:"correlationPropertyBinding",type:"CorrelationPropertyBinding",isMany:!0}]},{name:"MessageFlow",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"MessageFlowAssociation",superClass:["BaseElement"],properties:[{name:"innerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0},{name:"outerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0}]},{name:"InteractionNode",isAbstract:!0,properties:[{name:"incomingConversationLinks",type:"ConversationLink",isVirtual:!0,isMany:!0,isReference:!0},{name:"outgoingConversationLinks",type:"ConversationLink",isVirtual:!0,isMany:!0,isReference:!0}]},{name:"Participant",superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"interfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"participantMultiplicity",type:"ParticipantMultiplicity"},{name:"endPointRefs",type:"EndPoint",isMany:!0,isReference:!0},{name:"processRef",type:"Process",isAttr:!0,isReference:!0}]},{name:"ParticipantAssociation",superClass:["BaseElement"],properties:[{name:"innerParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"outerParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"ParticipantMultiplicity",properties:[{name:"minimum",default:0,isAttr:!0,type:"Integer"},{name:"maximum",default:1,isAttr:!0,type:"Integer"}]},{name:"Collaboration",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"participants",type:"Participant",isMany:!0},{name:"messageFlows",type:"MessageFlow",isMany:!0},{name:"artifacts",type:"Artifact",isMany:!0},{name:"conversations",type:"ConversationNode",isMany:!0},{name:"conversationAssociations",type:"ConversationAssociation"},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0},{name:"messageFlowAssociations",type:"MessageFlowAssociation",isMany:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"choreographyRef",type:"Choreography",isMany:!0,isReference:!0},{name:"conversationLinks",type:"ConversationLink",isMany:!0}]},{name:"ChoreographyActivity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"participantRefs",type:"Participant",isMany:!0,isReference:!0},{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"loopType",type:"ChoreographyLoopType",default:"None",isAttr:!0}]},{name:"CallChoreography",superClass:["ChoreographyActivity"],properties:[{name:"calledChoreographyRef",type:"Choreography",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"SubChoreography",superClass:["ChoreographyActivity","FlowElementsContainer"],properties:[{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"ChoreographyTask",superClass:["ChoreographyActivity"],properties:[{name:"messageFlowRef",type:"MessageFlow",isMany:!0,isReference:!0}]},{name:"Choreography",superClass:["FlowElementsContainer","Collaboration"]},{name:"GlobalChoreographyTask",superClass:["Choreography"],properties:[{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"TextAnnotation",superClass:["Artifact"],properties:[{name:"text",type:"String"},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Group",superClass:["Artifact"],properties:[{name:"categoryValueRef",type:"CategoryValue",isAttr:!0,isReference:!0}]},{name:"Association",superClass:["Artifact"],properties:[{name:"associationDirection",type:"AssociationDirection",isAttr:!0},{name:"sourceRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"targetRef",type:"BaseElement",isAttr:!0,isReference:!0}]},{name:"Category",superClass:["RootElement"],properties:[{name:"categoryValue",type:"CategoryValue",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Artifact",isAbstract:!0,superClass:["BaseElement"]},{name:"CategoryValue",superClass:["BaseElement"],properties:[{name:"categorizedFlowElements",type:"FlowElement",isVirtual:!0,isMany:!0,isReference:!0},{name:"value",isAttr:!0,type:"String"}]},{name:"Activity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"isForCompensation",default:!1,isAttr:!0,type:"Boolean"},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"boundaryEventRefs",type:"BoundaryEvent",isMany:!0,isReference:!0},{name:"properties",type:"Property",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"startQuantity",default:1,isAttr:!0,type:"Integer"},{name:"resources",type:"ResourceRole",isMany:!0},{name:"completionQuantity",default:1,isAttr:!0,type:"Integer"},{name:"loopCharacteristics",type:"LoopCharacteristics"}]},{name:"ServiceTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"SubProcess",superClass:["Activity","FlowElementsContainer","InteractionNode"],properties:[{name:"triggeredByEvent",default:!1,isAttr:!0,type:"Boolean"},{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"LoopCharacteristics",isAbstract:!0,superClass:["BaseElement"]},{name:"MultiInstanceLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"isSequential",default:!1,isAttr:!0,type:"Boolean"},{name:"behavior",type:"MultiInstanceBehavior",default:"All",isAttr:!0},{name:"loopCardinality",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopDataInputRef",type:"ItemAwareElement",isReference:!0},{name:"loopDataOutputRef",type:"ItemAwareElement",isReference:!0},{name:"inputDataItem",type:"DataInput",xml:{serialize:"property"}},{name:"outputDataItem",type:"DataOutput",xml:{serialize:"property"}},{name:"complexBehaviorDefinition",type:"ComplexBehaviorDefinition",isMany:!0},{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"oneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0},{name:"noneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0}]},{name:"StandardLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"testBefore",default:!1,isAttr:!0,type:"Boolean"},{name:"loopCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopMaximum",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"CallActivity",superClass:["Activity"],properties:[{name:"calledElement",type:"String",isAttr:!0}]},{name:"Task",superClass:["Activity","InteractionNode"]},{name:"SendTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ReceiveTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ScriptTask",superClass:["Task"],properties:[{name:"scriptFormat",isAttr:!0,type:"String"},{name:"script",type:"String"}]},{name:"BusinessRuleTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"AdHocSubProcess",superClass:["SubProcess"],properties:[{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"ordering",type:"AdHocOrdering",isAttr:!0},{name:"cancelRemainingInstances",default:!0,isAttr:!0,type:"Boolean"}]},{name:"Transaction",superClass:["SubProcess"],properties:[{name:"protocol",isAttr:!0,type:"String"},{name:"method",isAttr:!0,type:"String"}]},{name:"GlobalScriptTask",superClass:["GlobalTask"],properties:[{name:"scriptLanguage",isAttr:!0,type:"String"},{name:"script",isAttr:!0,type:"String"}]},{name:"GlobalBusinessRuleTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"ComplexBehaviorDefinition",superClass:["BaseElement"],properties:[{name:"condition",type:"FormalExpression"},{name:"event",type:"ImplicitThrowEvent"}]},{name:"ResourceRole",superClass:["BaseElement"],properties:[{name:"resourceRef",type:"Resource",isReference:!0},{name:"resourceParameterBindings",type:"ResourceParameterBinding",isMany:!0},{name:"resourceAssignmentExpression",type:"ResourceAssignmentExpression"},{name:"name",isAttr:!0,type:"String"}]},{name:"ResourceParameterBinding",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"parameterRef",type:"ResourceParameter",isAttr:!0,isReference:!0}]},{name:"ResourceAssignmentExpression",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}}],superClass:["BaseElement"]},{name:"Import",properties:[{name:"importType",isAttr:!0,type:"String"},{name:"location",isAttr:!0,type:"String"},{name:"namespace",isAttr:!0,type:"String"}]},{name:"Definitions",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"targetNamespace",isAttr:!0,type:"String"},{name:"expressionLanguage",default:"http://www.w3.org/1999/XPath",isAttr:!0,type:"String"},{name:"typeLanguage",default:"http://www.w3.org/2001/XMLSchema",isAttr:!0,type:"String"},{name:"imports",type:"Import",isMany:!0},{name:"extensions",type:"Extension",isMany:!0},{name:"rootElements",type:"RootElement",isMany:!0},{name:"diagrams",isMany:!0,type:"bpmndi:BPMNDiagram"},{name:"exporter",isAttr:!0,type:"String"},{name:"relationships",type:"Relationship",isMany:!0},{name:"exporterVersion",isAttr:!0,type:"String"}]}],emumerations:[{name:"ProcessType",literalValues:[{name:"None"},{name:"Public"},{name:"Private"}]},{name:"GatewayDirection",literalValues:[{name:"Unspecified"},{name:"Converging"},{name:"Diverging"},{name:"Mixed"}]},{name:"EventBasedGatewayType",literalValues:[{name:"Parallel"},{name:"Exclusive"}]},{name:"RelationshipDirection",literalValues:[{name:"None"},{name:"Forward"},{name:"Backward"},{name:"Both"}]},{name:"ItemKind",literalValues:[{name:"Physical"},{name:"Information"}]},{name:"ChoreographyLoopType",literalValues:[{name:"None"},{name:"Standard"},{name:"MultiInstanceSequential"},{name:"MultiInstanceParallel"}]},{name:"AssociationDirection",literalValues:[{name:"None"},{name:"One"},{name:"Both"}]},{name:"MultiInstanceBehavior",literalValues:[{name:"None"},{name:"One"},{name:"All"},{name:"Complex"}]},{name:"AdHocOrdering",literalValues:[{name:"Parallel"},{name:"Sequential"}]}],prefix:"bpmn",xml:{tagAlias:"lowerCase",typePrefix:"t"}}},{}],24:[function(_dereq_,module,exports){module.exports={name:"BPMNDI",uri:"http://www.omg.org/spec/BPMN/20100524/DI",types:[{name:"BPMNDiagram",properties:[{name:"plane",type:"BPMNPlane",redefines:"di:Diagram#rootElement"},{name:"labelStyle",type:"BPMNLabelStyle",isMany:!0}],superClass:["di:Diagram"]},{name:"BPMNPlane",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"}],superClass:["di:Plane"]},{name:"BPMNShape",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"isHorizontal",isAttr:!0,type:"Boolean"},{name:"isExpanded",isAttr:!0,type:"Boolean"},{name:"isMarkerVisible",isAttr:!0,type:"Boolean"},{name:"label",type:"BPMNLabel"},{name:"isMessageVisible",isAttr:!0,type:"Boolean"},{name:"participantBandKind",type:"ParticipantBandKind",isAttr:!0},{name:"choreographyActivityShape",type:"BPMNShape",isAttr:!0,isReference:!0}],superClass:["di:LabeledShape"]},{name:"BPMNEdge",properties:[{name:"label",type:"BPMNLabel"},{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"sourceElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#source"},{name:"targetElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#target"},{name:"messageVisibleKind",type:"MessageVisibleKind",isAttr:!0,default:"initiating"}],superClass:["di:LabeledEdge"]},{name:"BPMNLabel",properties:[{name:"labelStyle",type:"BPMNLabelStyle",isAttr:!0,isReference:!0,redefines:"di:DiagramElement#style"}],superClass:["di:Label"]},{name:"BPMNLabelStyle",properties:[{name:"font",type:"dc:Font"}],superClass:["di:Style"]}],emumerations:[{name:"ParticipantBandKind",literalValues:[{name:"top_initiating"},{name:"middle_initiating"},{name:"bottom_initiating"},{name:"top_non_initiating"},{name:"middle_non_initiating"},{name:"bottom_non_initiating"}]},{name:"MessageVisibleKind",literalValues:[{name:"initiating"},{name:"non_initiating"}]}],associations:[],prefix:"bpmndi"}},{}],25:[function(_dereq_,module,exports){module.exports={name:"DC",uri:"http://www.omg.org/spec/DD/20100524/DC",types:[{name:"Boolean"},{name:"Integer"},{name:"Real"},{name:"String"},{name:"Font",properties:[{name:"name",type:"String",isAttr:!0},{name:"size",type:"Real",isAttr:!0},{name:"isBold",type:"Boolean",isAttr:!0},{name:"isItalic",type:"Boolean",isAttr:!0},{name:"isUnderline",type:"Boolean",isAttr:!0},{name:"isStrikeThrough",type:"Boolean",isAttr:!0}]},{name:"Point",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0}]},{name:"Bounds",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0},{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]}],prefix:"dc",associations:[]}},{}],26:[function(_dereq_,module,exports){module.exports={name:"DI",uri:"http://www.omg.org/spec/DD/20100524/DI",types:[{name:"DiagramElement",isAbstract:!0,properties:[{name:"id",type:"String",isAttr:!0,isId:!0},{name:"extension",type:"Extension"},{name:"owningDiagram",type:"Diagram",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"owningElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"modelElement",isReadOnly:!0,isVirtual:!0,isReference:!0,type:"Element"},{name:"style",type:"Style",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"ownedElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isMany:!0}]},{name:"Node",isAbstract:!0,superClass:["DiagramElement"]},{name:"Edge",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"source",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"target",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"waypoint",isUnique:!1,isMany:!0,type:"dc:Point",xml:{serialize:"xsi:type"}}]},{name:"Diagram",isAbstract:!0,properties:[{name:"id",type:"String",isAttr:!0,isId:!0},{name:"rootElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0},{name:"name",isAttr:!0,type:"String"},{name:"documentation",isAttr:!0,type:"String"},{name:"resolution",isAttr:!0,type:"Real"},{name:"ownedStyle",type:"Style",isReadOnly:!0,isVirtual:!0,isMany:!0}]},{name:"Shape",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Plane",isAbstract:!0,superClass:["Node"],properties:[{name:"planeElement",type:"DiagramElement",subsettedProperty:"DiagramElement-ownedElement",isMany:!0}]},{name:"LabeledEdge",isAbstract:!0,superClass:["Edge"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isVirtual:!0,isMany:!0}]},{name:"LabeledShape",isAbstract:!0,superClass:["Shape"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isVirtual:!0,isMany:!0}]},{name:"Label",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Style",isAbstract:!0,properties:[{name:"id",type:"String",isAttr:!0,isId:!0}]},{name:"Extension",properties:[{name:"values",type:"Element",isMany:!0}]}],associations:[],prefix:"di",xml:{tagAlias:"lowerCase"}}},{}],27:[function(_dereq_,module,exports){},{}],28:[function(_dereq_,module,exports){(function(global){"use strict";function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(that,length){if(kMaxLength()<length)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(that=new Uint8Array(length),that.__proto__=Buffer.prototype):(null===that&&(that=new Buffer(length)),that.length=length),that}function Buffer(arg,encodingOrOffset,length){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(arg,encodingOrOffset,length);if("number"==typeof arg){if("string"==typeof encodingOrOffset)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,arg)}return from(this,arg,encodingOrOffset,length)}function from(that,value,encodingOrOffset,length){if("number"==typeof value)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&value instanceof ArrayBuffer?fromArrayBuffer(that,value,encodingOrOffset,length):"string"==typeof value?fromString(that,value,encodingOrOffset):fromObject(that,value)}function assertSize(size){if("number"!=typeof size)throw new TypeError('"size" argument must be a number');if(size<0)throw new RangeError('"size" argument must not be negative')}function alloc(that,size,fill,encoding){return assertSize(size),size<=0?createBuffer(that,size):void 0!==fill?"string"==typeof encoding?createBuffer(that,size).fill(fill,encoding):createBuffer(that,size).fill(fill):createBuffer(that,size)}function allocUnsafe(that,size){if(assertSize(size),that=createBuffer(that,size<0?0:0|checked(size)),!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;i<size;++i)that[i]=0;return that}function fromString(that,string,encoding){if("string"==typeof encoding&&""!==encoding||(encoding="utf8"),!Buffer.isEncoding(encoding))throw new TypeError('"encoding" must be a valid string encoding');var length=0|byteLength(string,encoding);that=createBuffer(that,length);var actual=that.write(string,encoding);return actual!==length&&(that=that.slice(0,actual)),that}function fromArrayLike(that,array){var length=array.length<0?0:0|checked(array.length);that=createBuffer(that,length);for(var i=0;i<length;i+=1)that[i]=255&array[i];return that}function fromArrayBuffer(that,array,byteOffset,length){if(array.byteLength,byteOffset<0||array.byteLength<byteOffset)throw new RangeError("'offset' is out of bounds");if(array.byteLength<byteOffset+(length||0))throw new RangeError("'length' is out of bounds");return array=void 0===byteOffset&&void 0===length?new Uint8Array(array):void 0===length?new Uint8Array(array,byteOffset):new Uint8Array(array,byteOffset,length),Buffer.TYPED_ARRAY_SUPPORT?(that=array,that.__proto__=Buffer.prototype):that=fromArrayLike(that,array),that}function fromObject(that,obj){if(Buffer.isBuffer(obj)){var len=0|checked(obj.length);return that=createBuffer(that,len),0===that.length?that:(obj.copy(that,0,0,len),that)}if(obj){if("undefined"!=typeof ArrayBuffer&&obj.buffer instanceof ArrayBuffer||"length"in obj)return"number"!=typeof obj.length||isnan(obj.length)?createBuffer(that,0):fromArrayLike(that,obj);if("Buffer"===obj.type&&isArray(obj.data))return fromArrayLike(that,obj.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(length){if(length>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|length}function SlowBuffer(length){return+length!=length&&(length=0),Buffer.alloc(+length)}function byteLength(string,encoding){if(Buffer.isBuffer(string))return string.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(string)||string instanceof ArrayBuffer))return string.byteLength;"string"!=typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":case void 0:return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function slowToString(encoding,start,end){var loweredCase=!1;if((void 0===start||start<0)&&(start=0),start>this.length)return"";if((void 0===end||end>this.length)&&(end=this.length),end<=0)return"";if(end>>>=0,start>>>=0,end<=start)return"";for(encoding||(encoding="utf8");;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}function swap(b,n,m){var i=b[n];b[n]=b[m],b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;if("string"==typeof byteOffset?(encoding=byteOffset,byteOffset=0):byteOffset>2147483647?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),byteOffset=+byteOffset,isNaN(byteOffset)&&(byteOffset=dir?0:buffer.length-1),byteOffset<0&&(byteOffset=buffer.length+byteOffset),byteOffset>=buffer.length){if(dir)return-1;byteOffset=buffer.length-1}else if(byteOffset<0){if(!dir)return-1;byteOffset=0}if("string"==typeof val&&(val=Buffer.from(val,encoding)),Buffer.isBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"==typeof val)return val&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?dir?Uint8Array.prototype.indexOf.call(buffer,val,byteOffset):Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}var indexSize=1,arrLength=arr.length,valLength=val.length;if(void 0!==encoding&&("ucs2"===(encoding=String(encoding).toLowerCase())||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(arr.length<2||val.length<2)return-1;indexSize=2,arrLength/=2,valLength/=2,byteOffset/=2}var i;if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++)if(read(arr,i)===read(val,-1===foundIndex?0:i-foundIndex)){if(-1===foundIndex&&(foundIndex=i),i-foundIndex+1===valLength)return foundIndex*indexSize}else-1!==foundIndex&&(i-=i-foundIndex),foundIndex=-1}else for(byteOffset+valLength>arrLength&&(byteOffset=arrLength-valLength),i=byteOffset;i>=0;i--){for(var found=!0,j=0;j<valLength;j++)if(read(arr,i+j)!==read(val,j)){found=!1;break}if(found)return i}return-1}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length))>remaining&&(length=remaining):length=remaining;var strLen=string.length;if(strLen%2!=0)throw new TypeError("Invalid hex string");length>strLen/2&&(length=strLen/2);for(var i=0;i<length;++i){var parsed=parseInt(string.substr(2*i,2),16);if(isNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;i<end;){var firstByte=buf[i],codePoint=null,bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:secondByte=buf[i+1],128==(192&secondByte)&&(tempCodePoint=(31&firstByte)<<6|63&secondByte)>127&&(codePoint=tempCodePoint);break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128==(192&secondByte)&&128==(192&thirdByte)&&(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte)>2047&&(tempCodePoint<55296||tempCodePoint>57343)&&(codePoint=tempCodePoint);break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128==(192&secondByte)&&128==(192&thirdByte)&&128==(192&fourthByte)&&(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte)>65535&&tempCodePoint<1114112&&(codePoint=tempCodePoint)}}null===codePoint?(codePoint=65533,bytesPerSequence=1):codePoint>65535&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return decodeCodePointsArray(res)}function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,codePoints);for(var res="",i=0;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(127&buf[i]);return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0),(!end||end<0||end>len)&&(end=len);for(var out="",i=start;i<end;++i)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!=0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}function objectWriteUInt16(buf,value,offset,littleEndian){value<0&&(value=65535+value+1);for(var i=0,j=Math.min(buf.length-offset,2);i<j;++i)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?i:1-i)}function objectWriteUInt32(buf,value,offset,littleEndian){value<0&&(value=4294967295+value+1);for(var i=0,j=Math.min(buf.length-offset,4);i<j;++i)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}function base64clean(str){if(str=stringtrim(str).replace(INVALID_BASE64_RE,""),str.length<2)return"";for(;str.length%4!=0;)str+="=";return str}function stringtrim(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}function toHex(n){return n<16?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){units=units||1/0;for(var codePoint,length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){if((codePoint=string.charCodeAt(i))>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=65536+(leadSurrogate-55296<<10|codePoint-56320)}else leadSurrogate&&(units-=3)>-1&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function asciiToBytes(str){for(var byteArray=[],i=0;i<str.length;++i)byteArray.push(255&str.charCodeAt(i));return byteArray}function utf16leToBytes(str,units){
for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);++i)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}function isnan(val){return val!==val}var base64=_dereq_(4),ieee754=_dereq_(81),isArray=_dereq_(84);exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50,Buffer.TYPED_ARRAY_SUPPORT=void 0!==global.TYPED_ARRAY_SUPPORT?global.TYPED_ARRAY_SUPPORT:function(){try{var arr=new Uint8Array(1);return arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===arr.foo()&&"function"==typeof arr.subarray&&0===arr.subarray(1,1).byteLength}catch(e){return!1}}(),exports.kMaxLength=kMaxLength(),Buffer.poolSize=8192,Buffer._augment=function(arr){return arr.__proto__=Buffer.prototype,arr},Buffer.from=function(value,encodingOrOffset,length){return from(null,value,encodingOrOffset,length)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0})),Buffer.alloc=function(size,fill,encoding){return alloc(null,size,fill,encoding)},Buffer.allocUnsafe=function(size){return allocUnsafe(null,size)},Buffer.allocUnsafeSlow=function(size){return allocUnsafe(null,size)},Buffer.isBuffer=function(b){return!(null==b||!b._isBuffer)},Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);var i;if(void 0===length)for(length=0,i=0;i<list.length;++i)length+=list[i].length;var buffer=Buffer.allocUnsafe(length),pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(!Buffer.isBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(buffer,pos),pos+=buf.length}return buffer},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var len=this.length;if(len%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<len;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function(){var len=this.length;if(len%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function(){var len=this.length;if(len%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toString=function(){var length=0|this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;return this.length>0&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function(target,start,end,thisStart,thisEnd){if(!Buffer.isBuffer(target))throw new TypeError("Argument must be a Buffer");if(void 0===start&&(start=0),void 0===end&&(end=target?target.length:0),void 0===thisStart&&(thisStart=0),void 0===thisEnd&&(thisEnd=this.length),start<0||end>target.length||thisStart<0||thisEnd>this.length)throw new RangeError("out of range index");if(thisStart>=thisEnd&&start>=end)return 0;if(thisStart>=thisEnd)return-1;if(start>=end)return 1;if(start>>>=0,end>>>=0,thisStart>>>=0,thisEnd>>>=0,this===target)return 0;for(var x=thisEnd-thisStart,y=end-start,len=Math.min(x,y),thisCopy=this.slice(thisStart,thisEnd),targetCopy=target.slice(start,end),i=0;i<len;++i)if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i],y=targetCopy[i];break}return x<y?-1:y<x?1:0},Buffer.prototype.includes=function(val,byteOffset,encoding){return-1!==this.indexOf(val,byteOffset,encoding)},Buffer.prototype.indexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)},Buffer.prototype.lastIndexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else{if(!isFinite(offset))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");offset|=0,isFinite(length)?(length|=0,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0)}var remaining=this.length-offset;if((void 0===length||length>remaining)&&(length=remaining),string.length>0&&(length<0||offset<0)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;Buffer.prototype.slice=function(start,end){var len=this.length;start=~~start,end=void 0===end?len:~~end,start<0?(start+=len)<0&&(start=0):start>len&&(start=len),end<0?(end+=len)<0&&(end=0):end>len&&(end=len),end<start&&(end=start);var newBuf;if(Buffer.TYPED_ARRAY_SUPPORT)newBuf=this.subarray(start,end),newBuf.__proto__=Buffer.prototype;else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,void 0);for(var i=0;i<sliceLen;++i)newBuf[i]=this[i+start]}return newBuf},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,byteLength|=0,!noAssert){checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0)}var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,byteLength|=0,!noAssert){checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0)}var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i-1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i+1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),value<0&&(value=255+value+1),this[offset]=255&value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),value<0&&(value=4294967295+value+1),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),end>0&&end<start&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(targetStart<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var i,len=end-start;if(this===target&&start<targetStart&&targetStart<end)for(i=len-1;i>=0;--i)target[i+targetStart]=this[i+start];else if(len<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(i=0;i<len;++i)target[i+targetStart]=this[i+start];else Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart);return len},Buffer.prototype.fill=function(val,start,end,encoding){if("string"==typeof val){if("string"==typeof start?(encoding=start,start=0,end=this.length):"string"==typeof end&&(encoding=end,end=this.length),1===val.length){var code=val.charCodeAt(0);code<256&&(val=code)}if(void 0!==encoding&&"string"!=typeof encoding)throw new TypeError("encoding must be a string");if("string"==typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding)}else"number"==typeof val&&(val&=255);if(start<0||this.length<start||this.length<end)throw new RangeError("Out of range index");if(end<=start)return this;start>>>=0,end=void 0===end?this.length:end>>>0,val||(val=0);var i;if("number"==typeof val)for(i=start;i<end;++i)this[i]=val;else{var bytes=Buffer.isBuffer(val)?val:utf8ToBytes(new Buffer(val,encoding).toString()),len=bytes.length;for(i=0;i<end-start;++i)this[i+start]=bytes[i%len]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{4:4,81:81,84:84}],29:[function(_dereq_,module,exports){function ClassList(el){if(!el||!el.nodeType)throw new Error("A DOM element reference is required");this.el=el,this.list=el.classList}try{var index=_dereq_(34)}catch(err){var index=_dereq_(34)}var re=/\s+/,toString=Object.prototype.toString;module.exports=function(el){return new ClassList(el)},ClassList.prototype.add=function(name){if(this.list)return this.list.add(name),this;var arr=this.array();return~index(arr,name)||arr.push(name),this.el.className=arr.join(" "),this},ClassList.prototype.remove=function(name){if("[object RegExp]"==toString.call(name))return this.removeMatching(name);if(this.list)return this.list.remove(name),this;var arr=this.array(),i=index(arr,name);return~i&&arr.splice(i,1),this.el.className=arr.join(" "),this},ClassList.prototype.removeMatching=function(re){for(var arr=this.array(),i=0;i<arr.length;i++)re.test(arr[i])&&this.remove(arr[i]);return this},ClassList.prototype.toggle=function(name,force){return this.list?(void 0!==force?force!==this.list.toggle(name,force)&&this.list.toggle(name):this.list.toggle(name),this):(void 0!==force?force?this.add(name):this.remove(name):this.has(name)?this.remove(name):this.add(name),this)},ClassList.prototype.array=function(){var className=this.el.getAttribute("class")||"",str=className.replace(/^\s+|\s+$/g,""),arr=str.split(re);return""===arr[0]&&arr.shift(),arr},ClassList.prototype.has=ClassList.prototype.contains=function(name){return this.list?this.list.contains(name):!!~index(this.array(),name)}},{34:34}],30:[function(_dereq_,module,exports){try{var closest=_dereq_(31)}catch(err){var closest=_dereq_(31)}try{var event=_dereq_(32)}catch(err){var event=_dereq_(32)}exports.bind=function(el,selector,type,fn,capture){return event.bind(el,type,function(e){var target=e.target||e.srcElement;e.delegateTarget=closest(target,selector,!0,el),e.delegateTarget&&fn.call(el,e)},capture)},exports.unbind=function(el,type,fn,capture){event.unbind(el,type,fn,capture)}},{31:31,32:32}],31:[function(_dereq_,module,exports){function closest(el,selector,scope){for(scope=scope||document.documentElement;el&&el!==scope;){if(matches(el,selector))return el;el=el.parentNode}return matches(el,selector)?el:null}try{var matches=_dereq_(35)}catch(err){var matches=_dereq_(35)}module.exports=closest},{35:35}],32:[function(_dereq_,module,exports){function detect(){bind=window.addEventListener?"addEventListener":"attachEvent",unbind=window.removeEventListener?"removeEventListener":"detachEvent",prefix="addEventListener"!==bind?"on":""}var bind,unbind,prefix;exports.bind=function(el,type,fn,capture){return bind||detect(),el[bind](prefix+type,fn,capture||!1),fn},exports.unbind=function(el,type,fn,capture){return unbind||detect(),el[unbind](prefix+type,fn,capture||!1),fn}},{}],33:[function(_dereq_,module,exports){var bind=window.addEventListener?"addEventListener":"attachEvent",unbind=window.removeEventListener?"removeEventListener":"detachEvent",prefix="addEventListener"!==bind?"on":"";exports.bind=function(el,type,fn,capture){return el[bind](prefix+type,fn,capture||!1),fn},exports.unbind=function(el,type,fn,capture){return el[unbind](prefix+type,fn,capture||!1),fn}},{}],34:[function(_dereq_,module,exports){module.exports=function(arr,obj){if(arr.indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i)if(arr[i]===obj)return i;return-1}},{}],35:[function(_dereq_,module,exports){function match(el,selector){if(!el||1!==el.nodeType)return!1;if(vendor)return vendor.call(el,selector);for(var nodes=query.all(selector,el.parentNode),i=0;i<nodes.length;++i)if(nodes[i]==el)return!0;return!1}try{var query=_dereq_(36)}catch(err){var query=_dereq_(36)}var proto=Element.prototype,vendor=proto.matches||proto.webkitMatchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector;module.exports=match},{36:36}],36:[function(_dereq_,module,exports){function one(selector,el){return el.querySelector(selector)}exports=module.exports=function(selector,el){return el=el||document,one(selector,el)},exports.all=function(selector,el){return el=el||document,el.querySelectorAll(selector)},exports.engine=function(obj){if(!obj.one)throw new Error(".one callback required");if(!obj.all)throw new Error(".all callback required");return one=obj.one,exports.all=obj.all,exports}},{}],37:[function(_dereq_,module,exports){(function(Buffer){function isArray(arg){return Array.isArray?Array.isArray(arg):"[object Array]"===objectToString(arg)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNullOrUndefined(arg){return null==arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isSymbol(arg){return"symbol"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return"[object Date]"===objectToString(d)}function isError(e){return"[object Error]"===objectToString(e)||e instanceof Error}function isFunction(arg){return"function"==typeof arg}function isPrimitive(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||void 0===arg}function objectToString(o){return Object.prototype.toString.call(o)}exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=Buffer.isBuffer}).call(this,{isBuffer:_dereq_(83)})},{83:83}],38:[function(_dereq_,module,exports){module.exports=_dereq_(39)},{39:39}],39:[function(_dereq_,module,exports){"use strict";function bootstrap(bootstrapModules){function hasModule(m){return modules.indexOf(m)>=0}function addModule(m){modules.push(m)}function visit(m){hasModule(m)||((m.__depends__||[]).forEach(visit),hasModule(m)||(addModule(m),(m.__init__||[]).forEach(function(c){components.push(c)})))}var modules=[],components=[];bootstrapModules.forEach(visit);var injector=new di.Injector(modules);return components.forEach(function(c){try{injector["string"==typeof c?"get":"invoke"](c)}catch(e){throw console.error("Failed to instantiate component"),console.error(e.stack),e}}),injector}function createInjector(options){return options=options||{},bootstrap([{config:["value",options]},_dereq_(45)].concat(options.modules||[]))}function Diagram(options,injector){this.injector=injector=injector||createInjector(options),this.get=injector.get,this.invoke=injector.invoke,this.get("eventBus").fire("diagram.init")}var di=_dereq_(74);module.exports=Diagram,Diagram.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")},Diagram.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")}},{45:45,74:74}],40:[function(_dereq_,module,exports){"use strict";function round(number,resolution){return Math.round(number*resolution)/resolution}function ensurePx(number){return isNumber(number)?number+"px":number}function createContainer(options){options=assign({},{width:"100%",height:"100%"},options);var container=options.container||document.body,parent=document.createElement("div");return parent.setAttribute("class","djs-container"),assign(parent.style,{position:"relative",overflow:"hidden",width:ensurePx(options.width),height:ensurePx(options.height)}),container.appendChild(parent),parent}function createGroup(parent,cls){var group=svgCreate("g");return svgClasses(group).add(cls),svgAppend(parent,group),group}function Canvas(config,eventBus,graphicsFactory,elementRegistry){this._eventBus=eventBus,this._elementRegistry=elementRegistry,this._graphicsFactory=graphicsFactory,this._init(config||{})}function setCTM(node,m){var mstr="matrix("+m.a+","+m.b+","+m.c+","+m.d+","+m.e+","+m.f+")";node.setAttribute("transform",mstr)}var isNumber=_dereq_(196),assign=_dereq_(202),forEach=_dereq_(90),every=_dereq_(87),debounce=_dereq_(97),Collections=_dereq_(63),Elements=_dereq_(64),svgAppend=_dereq_(255),svgAttr=_dereq_(257),svgClasses=_dereq_(258),svgCreate=_dereq_(260),svgTransform=_dereq_(264),createMatrix=_dereq_(261).createMatrix,REQUIRED_MODEL_ATTRS={shape:["x","y","width","height"],connection:["waypoints"]};Canvas.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"],module.exports=Canvas,Canvas.prototype._init=function(config){var eventBus=this._eventBus,container=this._container=createContainer(config),svg=this._svg=svgCreate("svg");svgAttr(svg,{width:"100%",height:"100%"}),svgAppend(container,svg);var viewport=this._viewport=createGroup(svg,"viewport");this._layers={},!1!==config.deferUpdate&&(this._viewboxChanged=debounce(this._viewboxChanged,300)),eventBus.on("diagram.init",function(){eventBus.fire("canvas.init",{svg:svg,viewport:viewport}),this.resized()},this),eventBus.on("diagram.destroy",500,this._destroy,this),eventBus.on("diagram.clear",500,this._clear,this)},Canvas.prototype._destroy=function(emit){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});var parent=this._container.parentNode;parent&&parent.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._rootElement,delete this._viewport},Canvas.prototype._clear=function(){var self=this;this._elementRegistry.getAll().forEach(function(element){var type=Elements.getType(element);"root"===type?self.setRootElement(null,!0):self._removeElement(element,type)}),delete this._cachedViewbox},Canvas.prototype.getDefaultLayer=function(){return this.getLayer("base")},Canvas.prototype.getLayer=function(name){if(!name)throw new Error("must specify a name");var layer=this._layers[name];return layer||(layer=this._layers[name]=createGroup(this._viewport,"layer-"+name)),layer},Canvas.prototype.getContainer=function(){return this._container},Canvas.prototype._updateMarker=function(element,marker,add){var container;element.id||(element=this._elementRegistry.get(element)),(container=this._elementRegistry._elements[element.id])&&(forEach([container.gfx,container.secondaryGfx],function(gfx){gfx&&(add?svgClasses(gfx).add(marker):svgClasses(gfx).remove(marker))}),this._eventBus.fire("element.marker.update",{element:element,gfx:container.gfx,marker:marker,add:!!add}))},Canvas.prototype.addMarker=function(element,marker){this._updateMarker(element,marker,!0)},Canvas.prototype.removeMarker=function(element,marker){this._updateMarker(element,marker,!1)},Canvas.prototype.hasMarker=function(element,marker){element.id||(element=this._elementRegistry.get(element));var gfx=this.getGraphics(element);return svgClasses(gfx).has(marker)},Canvas.prototype.toggleMarker=function(element,marker){this.hasMarker(element,marker)?this.removeMarker(element,marker):this.addMarker(element,marker)},Canvas.prototype.getRootElement=function(){return this._rootElement||this.setRootElement({id:"__implicitroot",children:[]}),this._rootElement},Canvas.prototype.setRootElement=function(element,override){element&&this._ensureValid("root",element);var currentRoot=this._rootElement,elementRegistry=this._elementRegistry,eventBus=this._eventBus;if(currentRoot){if(!override)throw new Error("rootElement already set, need to specify override");eventBus.fire("root.remove",{element:currentRoot}),eventBus.fire("root.removed",{element:currentRoot}),elementRegistry.remove(currentRoot)}if(element){var gfx=this.getDefaultLayer();eventBus.fire("root.add",{element:element}),elementRegistry.add(element,gfx,this._svg),eventBus.fire("root.added",{element:element,gfx:gfx})}return this._rootElement=element,element},Canvas.prototype._ensureValid=function(type,element){if(!element.id)throw new Error("element must have an id");if(this._elementRegistry.get(element.id))throw new Error("element with id "+element.id+" already exists");var requiredAttrs=REQUIRED_MODEL_ATTRS[type];if(!every(requiredAttrs,function(attr){return void 0!==element[attr]}))throw new Error("must supply { "+requiredAttrs.join(", ")+" } with "+type)},Canvas.prototype._setParent=function(element,parent,parentIndex){Collections.add(parent.children,element,parentIndex),element.parent=parent},Canvas.prototype._addElement=function(type,element,parent,parentIndex){parent=parent||this.getRootElement();var eventBus=this._eventBus,graphicsFactory=this._graphicsFactory;this._ensureValid(type,element),eventBus.fire(type+".add",{element:element,parent:parent}),this._setParent(element,parent,parentIndex);var gfx=graphicsFactory.create(type,element);return this._elementRegistry.add(element,gfx),graphicsFactory.update(type,element,gfx),eventBus.fire(type+".added",{element:element,gfx:gfx}),element},Canvas.prototype.addShape=function(shape,parent,parentIndex){return this._addElement("shape",shape,parent,parentIndex)},Canvas.prototype.addConnection=function(connection,parent,parentIndex){return this._addElement("connection",connection,parent,parentIndex)},Canvas.prototype._removeElement=function(element,type){var elementRegistry=this._elementRegistry,graphicsFactory=this._graphicsFactory,eventBus=this._eventBus;if(element=elementRegistry.get(element.id||element))return eventBus.fire(type+".remove",{element:element}),graphicsFactory.remove(element),Collections.remove(element.parent&&element.parent.children,element),element.parent=null,eventBus.fire(type+".removed",{element:element}),elementRegistry.remove(element),element},Canvas.prototype.removeShape=function(shape){return this._removeElement(shape,"shape")},Canvas.prototype.removeConnection=function(connection){return this._removeElement(connection,"connection")},Canvas.prototype.getGraphics=function(element,secondary){return this._elementRegistry.getGraphics(element,secondary)},Canvas.prototype._changeViewbox=function(changeFn){this._eventBus.fire("canvas.viewbox.changing"),changeFn.apply(this),this._cachedViewbox=null,this._viewboxChanged()},Canvas.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})},Canvas.prototype.viewbox=function(box){if(void 0===box&&this._cachedViewbox)return this._cachedViewbox;var innerBox,matrix,scale,x,y,viewport=this._viewport,outerBox=this.getSize();if(!box){innerBox=this.getDefaultLayer().getBBox();var transform=svgTransform(viewport);return matrix=transform?transform.matrix:createMatrix(),scale=round(matrix.a,1e3),x=round(-matrix.e||0,1e3),y=round(-matrix.f||0,1e3),box=this._cachedViewbox={x:x?x/scale:0,y:y?y/scale:0,width:outerBox.width/scale,height:outerBox.height/scale,scale:scale,inner:{width:innerBox.width,height:innerBox.height,x:innerBox.x,y:innerBox.y},outer:outerBox}}return this._changeViewbox(function(){scale=Math.min(outerBox.width/box.width,outerBox.height/box.height);var matrix=this._svg.createSVGMatrix().scale(scale).translate(-box.x,-box.y);svgTransform(viewport,matrix)}),box},
Canvas.prototype.scroll=function(delta){var node=this._viewport,matrix=node.getCTM();return delta&&this._changeViewbox(function(){delta=assign({dx:0,dy:0},delta||{}),matrix=this._svg.createSVGMatrix().translate(delta.dx,delta.dy).multiply(matrix),setCTM(node,matrix)}),{x:matrix.e,y:matrix.f}},Canvas.prototype.zoom=function(newScale,center){if(!newScale)return this.viewbox(newScale).scale;if("fit-viewport"===newScale)return this._fitViewport(center);var outer,matrix;return this._changeViewbox(function(){"object"!=typeof center&&(outer=this.viewbox().outer,center={x:outer.width/2,y:outer.height/2}),matrix=this._setZoom(newScale,center)}),round(matrix.a,1e3)},Canvas.prototype._fitViewport=function(center){var newScale,newViewbox,vbox=this.viewbox(),outer=vbox.outer,inner=vbox.inner;return inner.x>=0&&inner.y>=0&&inner.x+inner.width<=outer.width&&inner.y+inner.height<=outer.height&&!center?newViewbox={x:0,y:0,width:Math.max(inner.width+inner.x,outer.width),height:Math.max(inner.height+inner.y,outer.height)}:(newScale=Math.min(1,outer.width/inner.width,outer.height/inner.height),newViewbox={x:inner.x+(center?inner.width/2-outer.width/newScale/2:0),y:inner.y+(center?inner.height/2-outer.height/newScale/2:0),width:outer.width/newScale,height:outer.height/newScale}),this.viewbox(newViewbox),this.viewbox(!1).scale},Canvas.prototype._setZoom=function(scale,center){var centerPoint,originalPoint,currentMatrix,scaleMatrix,newMatrix,svg=this._svg,viewport=this._viewport,matrix=svg.createSVGMatrix(),point=svg.createSVGPoint();currentMatrix=viewport.getCTM();var currentScale=currentMatrix.a;return center?(centerPoint=assign(point,center),originalPoint=centerPoint.matrixTransform(currentMatrix.inverse()),scaleMatrix=matrix.translate(originalPoint.x,originalPoint.y).scale(1/currentScale*scale).translate(-originalPoint.x,-originalPoint.y),newMatrix=currentMatrix.multiply(scaleMatrix)):newMatrix=matrix.scale(scale),setCTM(this._viewport,newMatrix),newMatrix},Canvas.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}},Canvas.prototype.getAbsoluteBBox=function(element){var bbox,vbox=this.viewbox();if(element.waypoints){bbox=this.getGraphics(element).getBBox()}else bbox=element;return{x:bbox.x*vbox.scale-vbox.x*vbox.scale,y:bbox.y*vbox.scale-vbox.y*vbox.scale,width:bbox.width*vbox.scale,height:bbox.height*vbox.scale}},Canvas.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")}},{196:196,202:202,255:255,257:257,258:258,260:260,261:261,264:264,63:63,64:64,87:87,90:90,97:97}],41:[function(_dereq_,module,exports){"use strict";function ElementFactory(){this._uid=12}var Model=_dereq_(62),assign=_dereq_(202);module.exports=ElementFactory,ElementFactory.prototype.createRoot=function(attrs){return this.create("root",attrs)},ElementFactory.prototype.createLabel=function(attrs){return this.create("label",attrs)},ElementFactory.prototype.createShape=function(attrs){return this.create("shape",attrs)},ElementFactory.prototype.createConnection=function(attrs){return this.create("connection",attrs)},ElementFactory.prototype.create=function(type,attrs){return attrs=assign({},attrs||{}),attrs.id||(attrs.id=type+"_"+this._uid++),Model.create(type,attrs)}},{202:202,62:62}],42:[function(_dereq_,module,exports){"use strict";function ElementRegistry(eventBus){this._elements={},this._eventBus=eventBus}var ELEMENT_ID="data-element-id",svgAttr=_dereq_(257);ElementRegistry.$inject=["eventBus"],module.exports=ElementRegistry,ElementRegistry.prototype.add=function(element,gfx,secondaryGfx){var id=element.id;this._validateId(id),svgAttr(gfx,ELEMENT_ID,id),secondaryGfx&&svgAttr(secondaryGfx,ELEMENT_ID,id),this._elements[id]={element:element,gfx:gfx,secondaryGfx:secondaryGfx}},ElementRegistry.prototype.remove=function(element){var elements=this._elements,id=element.id||element,container=id&&elements[id];container&&(svgAttr(container.gfx,ELEMENT_ID,""),container.secondaryGfx&&svgAttr(container.secondaryGfx,ELEMENT_ID,""),delete elements[id])},ElementRegistry.prototype.updateId=function(element,newId){this._validateId(newId),"string"==typeof element&&(element=this.get(element)),this._eventBus.fire("element.updateId",{element:element,newId:newId});var gfx=this.getGraphics(element),secondaryGfx=this.getGraphics(element,!0);this.remove(element),element.id=newId,this.add(element,gfx,secondaryGfx)},ElementRegistry.prototype.get=function(filter){var id;id="string"==typeof filter?filter:filter&&svgAttr(filter,ELEMENT_ID);var container=this._elements[id];return container&&container.element},ElementRegistry.prototype.filter=function(fn){var filtered=[];return this.forEach(function(element,gfx){fn(element,gfx)&&filtered.push(element)}),filtered},ElementRegistry.prototype.getAll=function(){return this.filter(function(e){return e})},ElementRegistry.prototype.forEach=function(fn){var map=this._elements;Object.keys(map).forEach(function(id){var container=map[id],element=container.element,gfx=container.gfx;return fn(element,gfx)})},ElementRegistry.prototype.getGraphics=function(filter,secondary){var id=filter.id||filter,container=this._elements[id];return container&&(secondary?container.secondaryGfx:container.gfx)},ElementRegistry.prototype._validateId=function(id){if(!id)throw new Error("element must have an id");if(this._elements[id])throw new Error("element with id "+id+" already added")}},{257:257}],43:[function(_dereq_,module,exports){"use strict";function EventBus(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}function Event(){}function invokeFunction(fn,args){return fn.apply(null,args)}var isFunction=_dereq_(194),isArray=_dereq_(193),isNumber=_dereq_(196),bind=_dereq_(96),assign=_dereq_(202),slice=Array.prototype.slice;module.exports=EventBus,EventBus.prototype.on=function(events,priority,callback,that){if(events=isArray(events)?events:[events],isFunction(priority)&&(that=callback,callback=priority,priority=1e3),!isNumber(priority))throw new Error("priority must be a number");var actualCallback=callback;that&&(actualCallback=bind(callback,that),actualCallback.__fn=callback.__fn||callback);var self=this,listener={priority:priority,callback:actualCallback};events.forEach(function(e){self._addListener(e,listener)})},EventBus.prototype.once=function(event,priority,callback,that){function wrappedCallback(){return self.off(event,wrappedCallback),callback.apply(that,arguments)}var self=this;if(isFunction(priority)&&(that=callback,callback=priority,priority=1e3),!isNumber(priority))throw new Error("priority must be a number");wrappedCallback.__fn=callback,this.on(event,priority,wrappedCallback)},EventBus.prototype.off=function(event,callback){var listener,listenerCallback,idx,listeners=this._getListeners(event);if(callback)for(idx=listeners.length-1;listener=listeners[idx];idx--)(listenerCallback=listener.callback)!==callback&&listenerCallback.__fn!==callback||listeners.splice(idx,1);else listeners.length=0},EventBus.prototype.fire=function(type,data){var event,listeners,returnValue,args;if(args=slice.call(arguments),"object"==typeof type&&(event=type,type=event.type),!type)throw new Error("no event type specified");if(listeners=this._listeners[type]){data instanceof Event?event=data:(event=new Event,event.init(data)),args[0]=event;var originalType=event.type;type!==originalType&&(event.type=type);try{returnValue=this._invokeListeners(event,args,listeners)}finally{type!==originalType&&(event.type=originalType)}return void 0===returnValue&&event.defaultPrevented&&(returnValue=!1),returnValue}},EventBus.prototype.handleError=function(error){return!1===this.fire("error",{error:error})},EventBus.prototype._destroy=function(){this._listeners={}},EventBus.prototype._invokeListeners=function(event,args,listeners){var idx,listener,returnValue;for(idx=0;(listener=listeners[idx])&&!event.cancelBubble;idx++)returnValue=this._invokeListener(event,args,listener);return returnValue},EventBus.prototype._invokeListener=function(event,args,listener){var returnValue;try{returnValue=invokeFunction(listener.callback,args),void 0!==returnValue&&(event.returnValue=returnValue,event.stopPropagation()),!1===returnValue&&event.preventDefault()}catch(e){if(!this.handleError(e))throw console.error("unhandled error in event listener"),console.error(e.stack),e}return returnValue},EventBus.prototype._addListener=function(event,newListener){var existingListener,idx,listeners=this._getListeners(event);for(idx=0;existingListener=listeners[idx];idx++)if(existingListener.priority<newListener.priority)return void listeners.splice(idx,0,newListener);listeners.push(newListener)},EventBus.prototype._getListeners=function(name){var listeners=this._listeners[name];return listeners||(this._listeners[name]=listeners=[]),listeners},module.exports.Event=Event,Event.prototype.stopPropagation=function(){this.cancelBubble=!0},Event.prototype.preventDefault=function(){this.defaultPrevented=!0},Event.prototype.init=function(data){assign(this,data||{})}},{193:193,194:194,196:196,202:202,96:96}],44:[function(_dereq_,module,exports){"use strict";function GraphicsFactory(eventBus,elementRegistry){this._eventBus=eventBus,this._elementRegistry=elementRegistry}function prependTo(newNode,parentNode){parentNode.insertBefore(newNode,parentNode.firstChild)}var forEach=_dereq_(90),reduce=_dereq_(93),GraphicsUtil=_dereq_(66),translate=_dereq_(71).translate,domClear=_dereq_(214),svgAppend=_dereq_(255),svgAttr=_dereq_(257),svgClasses=_dereq_(258),svgCreate=_dereq_(260),svgRemove=_dereq_(263);GraphicsFactory.$inject=["eventBus","elementRegistry"],module.exports=GraphicsFactory,GraphicsFactory.prototype._getChildren=function(element){var childrenGfx,gfx=this._elementRegistry.getGraphics(element);return element.parent?(childrenGfx=GraphicsUtil.getChildren(gfx))||(childrenGfx=svgCreate("g"),svgClasses(childrenGfx).add("djs-children"),svgAppend(gfx.parentNode,childrenGfx)):childrenGfx=gfx,childrenGfx},GraphicsFactory.prototype._clear=function(gfx){var visual=GraphicsUtil.getVisual(gfx);return domClear(visual),visual},GraphicsFactory.prototype._createContainer=function(type,parentGfx){var outerGfx=svgCreate("g");svgClasses(outerGfx).add("djs-group"),svgAppend(parentGfx,outerGfx);var gfx=svgCreate("g");svgClasses(gfx).add("djs-element"),svgClasses(gfx).add("djs-"+type),svgAppend(outerGfx,gfx);var visual=svgCreate("g");return svgClasses(visual).add("djs-visual"),svgAppend(gfx,visual),gfx},GraphicsFactory.prototype.create=function(type,element){var childrenGfx=this._getChildren(element.parent);return this._createContainer(type,childrenGfx)},GraphicsFactory.prototype.updateContainments=function(elements){var parents,self=this,elementRegistry=this._elementRegistry;parents=reduce(elements,function(map,e){return e.parent&&(map[e.parent.id]=e.parent),map},{}),forEach(parents,function(parent){var childGfx=self._getChildren(parent),children=parent.children;children&&forEach(children.slice().reverse(),function(c){prependTo(elementRegistry.getGraphics(c).parentNode,childGfx)})})},GraphicsFactory.prototype.drawShape=function(visual,element){return this._eventBus.fire("render.shape",{gfx:visual,element:element})},GraphicsFactory.prototype.getShapePath=function(element){return this._eventBus.fire("render.getShapePath",element)},GraphicsFactory.prototype.drawConnection=function(visual,element){return this._eventBus.fire("render.connection",{gfx:visual,element:element})},GraphicsFactory.prototype.getConnectionPath=function(waypoints){return this._eventBus.fire("render.getConnectionPath",waypoints)},GraphicsFactory.prototype.update=function(type,element,gfx){if(element.parent){var visual=this._clear(gfx);if("shape"===type)this.drawShape(visual,element),translate(gfx,element.x,element.y);else{if("connection"!==type)throw new Error("unknown type: "+type);this.drawConnection(visual,element)}element.hidden?svgAttr(gfx,"display","none"):svgAttr(gfx,"display","block")}},GraphicsFactory.prototype.remove=function(element){var gfx=this._elementRegistry.getGraphics(element);svgRemove(gfx.parentNode)}},{214:214,255:255,257:257,258:258,260:260,263:263,66:66,71:71,90:90,93:93}],45:[function(_dereq_,module,exports){module.exports={__depends__:[_dereq_(49)],__init__:["canvas"],canvas:["type",_dereq_(40)],elementRegistry:["type",_dereq_(42)],elementFactory:["type",_dereq_(41)],eventBus:["type",_dereq_(43)],graphicsFactory:["type",_dereq_(44)]}},{40:40,41:41,42:42,43:43,44:44,49:49}],46:[function(_dereq_,module,exports){"use strict";function BaseRenderer(eventBus,renderPriority){var self=this;renderPriority=renderPriority||DEFAULT_RENDER_PRIORITY,eventBus.on(["render.shape","render.connection"],renderPriority,function(evt,context){var type=evt.type,element=context.element,visuals=context.gfx;if(self.canRender(element))return"render.shape"===type?self.drawShape(visuals,element):self.drawConnection(visuals,element)}),eventBus.on(["render.getShapePath","render.getConnectionPath"],renderPriority,function(evt,element){if(self.canRender(element))return"render.getShapePath"===evt.type?self.getShapePath(element):self.getConnectionPath(element)})}var DEFAULT_RENDER_PRIORITY=1e3;BaseRenderer.prototype.canRender=function(){},BaseRenderer.prototype.drawShape=function(){},BaseRenderer.prototype.drawConnection=function(){},BaseRenderer.prototype.getShapePath=function(){},BaseRenderer.prototype.getConnectionPath=function(){},module.exports=BaseRenderer},{}],47:[function(_dereq_,module,exports){"use strict";function DefaultRenderer(eventBus,styles){BaseRenderer.call(this,eventBus,DEFAULT_RENDER_PRIORITY),this.CONNECTION_STYLE=styles.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=styles.style({fill:"white",stroke:"fuchsia",strokeWidth:2})}var inherits=_dereq_(82),BaseRenderer=_dereq_(46),renderUtil=_dereq_(70),componentsToPath=renderUtil.componentsToPath,createLine=renderUtil.createLine,svgAppend=_dereq_(255),svgAttr=_dereq_(257),svgCreate=_dereq_(260),DEFAULT_RENDER_PRIORITY=1;inherits(DefaultRenderer,BaseRenderer),DefaultRenderer.prototype.canRender=function(){return!0},DefaultRenderer.prototype.drawShape=function(visuals,element){var rect=svgCreate("rect");return svgAttr(rect,{x:0,y:0,width:element.width||0,height:element.height||0}),svgAttr(rect,this.SHAPE_STYLE),svgAppend(visuals,rect),rect},DefaultRenderer.prototype.drawConnection=function(visuals,connection){var line=createLine(connection.waypoints,this.CONNECTION_STYLE);return svgAppend(visuals,line),line},DefaultRenderer.prototype.getShapePath=function(shape){var x=shape.x,y=shape.y,width=shape.width,height=shape.height;return componentsToPath([["M",x,y],["l",width,0],["l",0,height],["l",-width,0],["z"]])},DefaultRenderer.prototype.getConnectionPath=function(connection){var idx,point,waypoints=connection.waypoints,connectionPath=[];for(idx=0;point=waypoints[idx];idx++)point=point.original||point,connectionPath.push([0===idx?"M":"L",point.x,point.y]);return componentsToPath(connectionPath)},DefaultRenderer.$inject=["eventBus","styles"],module.exports=DefaultRenderer},{255:255,257:257,260:260,46:46,70:70,82:82}],48:[function(_dereq_,module,exports){"use strict";function Styles(){var defaultTraits={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},self=this;this.cls=function(className,traits,additionalAttrs){var attrs=this.style(traits,additionalAttrs);return assign(attrs,{class:className})},this.style=function(traits,additionalAttrs){isArray(traits)||additionalAttrs||(additionalAttrs=traits,traits=[]);var attrs=reduce(traits,function(attrs,t){return assign(attrs,defaultTraits[t]||{})},{});return additionalAttrs?assign(attrs,additionalAttrs):attrs},this.computeStyle=function(custom,traits,defaultStyles){return isArray(traits)||(defaultStyles=traits,traits=[]),self.style(traits||[],assign({},defaultStyles,custom||{}))}}var isArray=_dereq_(193),assign=_dereq_(202),reduce=_dereq_(93);module.exports=Styles},{193:193,202:202,93:93}],49:[function(_dereq_,module,exports){module.exports={__init__:["defaultRenderer"],defaultRenderer:["type",_dereq_(47)],styles:["type",_dereq_(48)]}},{47:47,48:48}],50:[function(_dereq_,module,exports){"use strict";function InteractionEvents(eventBus,elementRegistry,styles){function fire(type,event,element){if(isPrimaryButton(event)){var target,gfx;element?gfx=elementRegistry.getGraphics(element):(target=event.delegateTarget||event.target)&&(gfx=target,element=elementRegistry.get(gfx)),gfx&&element&&!1===eventBus.fire(type,{element:element,gfx:gfx,originalEvent:event})&&(event.stopPropagation(),event.preventDefault())}}function mouseHandler(type){var fn=handlers[type];return fn||(fn=handlers[type]=function(event){fire(type,event)}),fn}function triggerMouseEvent(eventName,event,targetElement){var localEventName=bindings[eventName];if(!localEventName)throw new Error("unmapped DOM event name <"+eventName+">");return fire(localEventName,event,targetElement)}function registerEvent(node,event,localEvent){var handler=mouseHandler(localEvent);handler.$delegate=domDelegate.bind(node,elementSelector,event,handler)}function unregisterEvent(node,event,localEvent){domDelegate.unbind(node,event,mouseHandler(localEvent).$delegate)}function registerEvents(svg){forEach(bindings,function(val,key){registerEvent(svg,key,val)})}function unregisterEvents(svg){forEach(bindings,function(val,key){unregisterEvent(svg,key,val)})}var HIT_STYLE=styles.cls("djs-hit",["no-fill","no-border"],{stroke:"white",strokeWidth:15}),handlers={},bindings={mouseover:"element.hover",mouseout:"element.out",click:"element.click",dblclick:"element.dblclick",mousedown:"element.mousedown",mouseup:"element.mouseup"},elementSelector="svg, .djs-element";eventBus.on("canvas.destroy",function(event){unregisterEvents(event.svg)}),eventBus.on("canvas.init",function(event){registerEvents(event.svg)}),eventBus.on(["shape.added","connection.added"],function(event){var hit,element=event.element,gfx=event.gfx;element.waypoints?hit=createLine(element.waypoints):(hit=svgCreate("rect"),svgAttr(hit,{x:0,y:0,width:element.width,height:element.height})),svgAttr(hit,HIT_STYLE),svgAppend(gfx,hit)}),eventBus.on("shape.changed",LOW_PRIORITY,function(event){var element=event.element,gfx=event.gfx,hit=domQuery(".djs-hit",gfx);svgAttr(hit,{width:element.width,height:element.height})}),eventBus.on("connection.changed",function(event){var element=event.element,gfx=event.gfx,hit=domQuery(".djs-hit",gfx);updateLine(hit,element.waypoints)}),this.fire=fire,this.triggerMouseEvent=triggerMouseEvent,this.mouseHandler=mouseHandler,this.registerEvent=registerEvent,this.unregisterEvent=unregisterEvent}var forEach=_dereq_(90),domDelegate=_dereq_(215),isPrimaryButton=_dereq_(68).isPrimaryButton,svgAppend=_dereq_(255),svgAttr=_dereq_(257),svgCreate=_dereq_(260),domQuery=_dereq_(218),renderUtil=_dereq_(70),createLine=renderUtil.createLine,updateLine=renderUtil.updateLine,LOW_PRIORITY=500;InteractionEvents.$inject=["eventBus","elementRegistry","styles"],module.exports=InteractionEvents},{215:215,218:218,255:255,257:257,260:260,68:68,70:70,90:90}],51:[function(_dereq_,module,exports){module.exports={__init__:["interactionEvents"],interactionEvents:["type",_dereq_(50)]}},{50:50}],52:[function(_dereq_,module,exports){"use strict";function Outline(eventBus,styles,elementRegistry){function createOutline(gfx,bounds){var outline=svgCreate("rect");return svgAttr(outline,assign({x:10,y:10,width:100,height:100},OUTLINE_STYLE)),svgAppend(gfx,outline),outline}this.offset=6;var OUTLINE_STYLE=styles.cls("djs-outline",["no-fill"]),self=this;eventBus.on(["shape.added","shape.changed"],LOW_PRIORITY,function(event){var element=event.element,gfx=event.gfx,outline=domQuery(".djs-outline",gfx);outline||(outline=createOutline(gfx,element)),self.updateShapeOutline(outline,element)}),eventBus.on(["connection.added","connection.changed"],function(event){var element=event.element,gfx=event.gfx,outline=domQuery(".djs-outline",gfx);outline||(outline=createOutline(gfx,element)),self.updateConnectionOutline(outline,element)})}var getBBox=_dereq_(64).getBBox,LOW_PRIORITY=500,svgAppend=_dereq_(255),svgAttr=_dereq_(257),svgCreate=_dereq_(260),domQuery=_dereq_(218),assign=_dereq_(202);Outline.prototype.updateShapeOutline=function(outline,element){svgAttr(outline,{x:-this.offset,y:-this.offset,width:element.width+2*this.offset,height:element.height+2*this.offset})},Outline.prototype.updateConnectionOutline=function(outline,connection){var bbox=getBBox(connection);svgAttr(outline,{x:bbox.x-this.offset,y:bbox.y-this.offset,width:bbox.width+2*this.offset,height:bbox.height+2*this.offset})},Outline.$inject=["eventBus","styles","elementRegistry"],module.exports=Outline},{202:202,218:218,255:255,257:257,260:260,64:64}],53:[function(_dereq_,module,exports){"use strict";module.exports={__init__:["outline"],outline:["type",_dereq_(52)]}},{52:52}],54:[function(_dereq_,module,exports){"use strict";function createRoot(parent){var root=domify('<div class="djs-overlay-container" style="position: absolute; width: 0; height: 0;" />');return parent.insertBefore(root,parent.firstChild),root}function setPosition(el,x,y){assign(el.style,{left:x+"px",top:y+"px"})}function setVisible(el,visible){el.style.display=!1===visible?"none":""}function Overlays(eventBus,canvas,elementRegistry){this._eventBus=eventBus,this._canvas=canvas,this._elementRegistry=elementRegistry,this._ids=ids,this._overlayDefaults={show:{minZoom:.7,maxZoom:5}},this._overlays={},this._overlayContainers=[],this._overlayRoot=createRoot(canvas.getContainer()),this._init()}var isArray=_dereq_(193),isString=_dereq_(199),isObject=_dereq_(197),assign=_dereq_(202),forEach=_dereq_(90),find=_dereq_(89),filter=_dereq_(88),domify=_dereq_(216),domClasses=_dereq_(213),domAttr=_dereq_(212),domRemove=_dereq_(219),domClear=_dereq_(214),getBBox=_dereq_(64).getBBox,ids=new(_dereq_(67))("ov");Overlays.$inject=["eventBus","canvas","elementRegistry"],module.exports=Overlays,Overlays.prototype.get=function(search){if(isString(search)&&(search={id:search}),isString(search.element)&&(search.element=this._elementRegistry.get(search.element)),search.element){var container=this._getOverlayContainer(search.element,!0);return container?search.type?filter(container.overlays,{type:search.type}):container.overlays.slice():[]}return search.type?filter(this._overlays,{type:search.type}):search.id?this._overlays[search.id]:null},Overlays.prototype.add=function(element,type,overlay){if(isObject(type)&&(overlay=type,type=null),element.id||(element=this._elementRegistry.get(element)),!overlay.position)throw new Error("must specifiy overlay position");if(!overlay.html)throw new Error("must specifiy overlay html");if(!element)throw new Error("invalid element specified");var id=this._ids.next();return overlay=assign({},this._overlayDefaults,overlay,{id:id,type:type,element:element,html:overlay.html}),this._addOverlay(overlay),id},Overlays.prototype.remove=function(filter){var overlays=this.get(filter)||[];isArray(overlays)||(overlays=[overlays]);var self=this;forEach(overlays,function(overlay){var container=self._getOverlayContainer(overlay.element,!0);if(overlay&&(domRemove(overlay.html),domRemove(overlay.htmlContainer),delete overlay.htmlContainer,delete overlay.element,delete self._overlays[overlay.id]),container){var idx=container.overlays.indexOf(overlay);-1!==idx&&container.overlays.splice(idx,1)}})},Overlays.prototype.show=function(){setVisible(this._overlayRoot)},Overlays.prototype.hide=function(){setVisible(this._overlayRoot,!1)},Overlays.prototype.clear=function(){this._overlays={},this._overlayContainers=[],domClear(this._overlayRoot)},Overlays.prototype._updateOverlayContainer=function(container){var element=container.element,html=container.html,x=element.x,y=element.y;if(element.waypoints){var bbox=getBBox(element);x=bbox.x,y=bbox.y}setPosition(html,x,y),domAttr(container.html,"data-container-id",element.id)},Overlays.prototype._updateOverlay=function(overlay){var position=overlay.position,htmlContainer=overlay.htmlContainer,element=overlay.element,left=position.left,top=position.top;if(void 0!==position.right){var width;width=element.waypoints?getBBox(element).width:element.width,left=-1*position.right+width}if(void 0!==position.bottom){var height;height=element.waypoints?getBBox(element).height:element.height,top=-1*position.bottom+height}setPosition(htmlContainer,left||0,top||0)},Overlays.prototype._createOverlayContainer=function(element){var html=domify('<div class="djs-overlays" style="position: absolute" />');this._overlayRoot.appendChild(html);var container={html:html,element:element,overlays:[]};return this._updateOverlayContainer(container),this._overlayContainers.push(container),container},Overlays.prototype._updateRoot=function(viewbox){var a=viewbox.scale||1,d=viewbox.scale||1,matrix="matrix("+a+",0,0,"+d+","+-1*viewbox.x*a+","+-1*viewbox.y*d+")";this._overlayRoot.style.transform=matrix,this._overlayRoot.style["-ms-transform"]=matrix,this._overlayRoot.style["-webkit-transform"]=matrix},Overlays.prototype._getOverlayContainer=function(element,raw){var container=find(this._overlayContainers,function(c){return c.element===element});return container||raw?container:this._createOverlayContainer(element)},Overlays.prototype._addOverlay=function(overlay){var htmlContainer,overlayContainer,id=overlay.id,element=overlay.element,html=overlay.html;html.get&&html.constructor.prototype.jquery&&(html=html.get(0)),isString(html)&&(html=domify(html)),overlayContainer=this._getOverlayContainer(element),htmlContainer=domify('<div class="djs-overlay" data-overlay-id="'+id+'" style="position: absolute">'),htmlContainer.appendChild(html),overlay.type&&domClasses(htmlContainer).add("djs-overlay-"+overlay.type),overlay.htmlContainer=htmlContainer,overlayContainer.overlays.push(overlay),overlayContainer.html.appendChild(htmlContainer),this._overlays[id]=overlay,this._updateOverlay(overlay),this._updateOverlayVisibilty(overlay,this._canvas.viewbox())},Overlays.prototype._updateOverlayVisibilty=function(overlay,viewbox){var show=overlay.show,htmlContainer=overlay.htmlContainer,visible=!0;show&&((show.minZoom>viewbox.scale||show.maxZoom<viewbox.scale)&&(visible=!1),setVisible(htmlContainer,visible))},Overlays.prototype._updateOverlaysVisibilty=function(viewbox){var self=this;forEach(this._overlays,function(overlay){self._updateOverlayVisibilty(overlay,viewbox)})},Overlays.prototype._init=function(){function updateViewbox(viewbox){self._updateRoot(viewbox),self._updateOverlaysVisibilty(viewbox),self.show()}var eventBus=this._eventBus,self=this;eventBus.on("canvas.viewbox.changing",function(event){self.hide()}),eventBus.on("canvas.viewbox.changed",function(event){updateViewbox(event.viewbox)}),eventBus.on(["shape.remove","connection.remove"],function(e){var element=e.element,overlays=self.get({element:element});forEach(overlays,function(o){self.remove(o.id)});var container=self._getOverlayContainer(element);if(container){domRemove(container.html);var i=self._overlayContainers.indexOf(container);-1!==i&&self._overlayContainers.splice(i,1)}}),eventBus.on("element.changed",500,function(e){var element=e.element,container=self._getOverlayContainer(element,!0);container&&(forEach(container.overlays,function(overlay){self._updateOverlay(overlay)}),self._updateOverlayContainer(container))}),eventBus.on("element.marker.update",function(e){var container=self._getOverlayContainer(e.element,!0);container&&domClasses(container.html)[e.add?"add":"remove"](e.marker)}),eventBus.on("diagram.clear",this.clear,this)}},{193:193,197:197,199:199,202:202,212:212,213:213,214:214,216:216,219:219,64:64,67:67,88:88,89:89,90:90}],55:[function(_dereq_,module,exports){module.exports={__init__:["overlays"],overlays:["type",_dereq_(54)]}},{54:54}],56:[function(_dereq_,module,exports){"use strict";function Selection(eventBus){this._eventBus=eventBus,this._selectedElements=[];var self=this;eventBus.on(["shape.remove","connection.remove"],function(e){var element=e.element;self.deselect(element)}),eventBus.on(["diagram.clear"],function(e){self.select(null)})}var isArray=_dereq_(193),forEach=_dereq_(90);Selection.$inject=["eventBus"],module.exports=Selection,Selection.prototype.deselect=function(element){var selectedElements=this._selectedElements,idx=selectedElements.indexOf(element);if(-1!==idx){var oldSelection=selectedElements.slice();selectedElements.splice(idx,1),this._eventBus.fire("selection.changed",{oldSelection:oldSelection,newSelection:selectedElements})}},Selection.prototype.get=function(){return this._selectedElements},Selection.prototype.isSelected=function(element){return-1!==this._selectedElements.indexOf(element)},Selection.prototype.select=function(elements,add){var selectedElements=this._selectedElements,oldSelection=selectedElements.slice();isArray(elements)||(elements=elements?[elements]:[]),add?forEach(elements,function(element){-1===selectedElements.indexOf(element)&&selectedElements.push(element)}):this._selectedElements=selectedElements=elements.slice(),this._eventBus.fire("selection.changed",{oldSelection:oldSelection,newSelection:selectedElements})}},{193:193,90:90}],57:[function(_dereq_,module,exports){"use strict";function SelectionBehavior(eventBus,selection,canvas,elementRegistry){eventBus.on("create.end",500,function(e){e.context.canExecute&&selection.select(e.context.shape)}),eventBus.on("connect.end",500,function(e){e.context.canExecute&&e.context.target&&selection.select(e.context.target)}),eventBus.on("shape.move.end",500,function(e){var previousSelection=e.previousSelection||[],shape=elementRegistry.get(e.context.shape.id);find(previousSelection,function(selectedShape){return shape.id===selectedShape.id})||selection.select(shape)}),eventBus.on("element.click",function(event){var element=event.element;element===canvas.getRootElement()&&(element=null);var isSelected=selection.isSelected(element),isMultiSelect=selection.get().length>1,add=hasPrimaryModifier(event);if(isSelected&&isMultiSelect)return add?selection.deselect(element):selection.select(element);isSelected?selection.deselect(element):selection.select(element,add)})}var hasPrimaryModifier=_dereq_(68).hasPrimaryModifier,find=_dereq_(89);SelectionBehavior.$inject=["eventBus","selection","canvas","elementRegistry"],module.exports=SelectionBehavior},{68:68,89:89}],58:[function(_dereq_,module,exports){"use strict";function SelectionVisuals(events,canvas,selection,styles){function addMarker(e,cls){canvas.addMarker(e,cls)}function removeMarker(e,cls){canvas.removeMarker(e,cls)}this._multiSelectionBox=null,events.on("element.hover",function(event){addMarker(event.element,MARKER_HOVER)}),events.on("element.out",function(event){removeMarker(event.element,MARKER_HOVER)}),events.on("selection.changed",function(event){function deselect(s){removeMarker(s,MARKER_SELECTED)}function select(s){addMarker(s,MARKER_SELECTED)}var oldSelection=event.oldSelection,newSelection=event.newSelection;forEach(oldSelection,function(e){-1===newSelection.indexOf(e)&&deselect(e)}),forEach(newSelection,function(e){-1===oldSelection.indexOf(e)&&select(e)})})}var forEach=_dereq_(90),MARKER_HOVER="hover",MARKER_SELECTED="selected";SelectionVisuals.$inject=["eventBus","canvas","selection","styles"],module.exports=SelectionVisuals},{90:90}],59:[function(_dereq_,module,exports){module.exports={__init__:["selectionVisuals","selectionBehavior"],__depends__:[_dereq_(51),_dereq_(53)],selection:["type",_dereq_(56)],selectionVisuals:["type",_dereq_(58)],selectionBehavior:["type",_dereq_(57)]}},{51:51,53:53,56:56,57:57,58:58}],60:[function(_dereq_,module,exports){module.exports={translate:["value",_dereq_(61)]}},{61:61}],61:[function(_dereq_,module,exports){"use strict";module.exports=function(template,replacements){return replacements=replacements||{},template.replace(/{([^}]+)}/g,function(_,key){return replacements[key]||"{"+key+"}"})}},{}],62:[function(_dereq_,module,exports){"use strict";function Base(){
Object.defineProperty(this,"businessObject",{writable:!0}),parentRefs.bind(this,"parent"),labelRefs.bind(this,"label"),outgoingRefs.bind(this,"outgoing"),incomingRefs.bind(this,"incoming")}function Shape(){Base.call(this),parentRefs.bind(this,"children"),attacherRefs.bind(this,"host"),attacherRefs.bind(this,"attachers")}function Root(){Shape.call(this)}function Label(){Shape.call(this),labelRefs.bind(this,"labelTarget")}function Connection(){Base.call(this),outgoingRefs.bind(this,"source"),incomingRefs.bind(this,"target")}var assign=_dereq_(202),inherits=_dereq_(82),Refs=_dereq_(232),parentRefs=new Refs({name:"children",enumerable:!0,collection:!0},{name:"parent"}),labelRefs=new Refs({name:"label",enumerable:!0},{name:"labelTarget"}),attacherRefs=new Refs({name:"attachers",collection:!0},{name:"host"}),outgoingRefs=new Refs({name:"outgoing",collection:!0},{name:"source"}),incomingRefs=new Refs({name:"incoming",collection:!0},{name:"target"});inherits(Shape,Base),inherits(Root,Shape),inherits(Label,Shape),inherits(Connection,Base);var types={connection:Connection,shape:Shape,label:Label,root:Root};module.exports.create=function(type,attrs){var Type=types[type];if(!Type)throw new Error("unknown type: <"+type+">");return assign(new Type,attrs)},module.exports.Base=Base,module.exports.Root=Root,module.exports.Shape=Shape,module.exports.Connection=Connection,module.exports.Label=Label},{202:202,232:232,82:82}],63:[function(_dereq_,module,exports){"use strict";module.exports.remove=function(collection,element){if(!collection||!element)return-1;var idx=collection.indexOf(element);return-1!==idx&&collection.splice(idx,1),idx},module.exports.add=function(collection,element,idx){if(collection&&element){"number"!=typeof idx&&(idx=-1);var currentIdx=collection.indexOf(element);if(-1!==currentIdx){if(currentIdx===idx)return;if(-1===idx)return;collection.splice(currentIdx,1)}-1!==idx?collection.splice(idx,0,element):collection.push(element)}},module.exports.indexOf=function(collection,element){return collection&&element?collection.indexOf(element):-1}},{}],64:[function(_dereq_,module,exports){"use strict";function add(elements,e,unique){var canAdd=!unique||-1===elements.indexOf(e);return canAdd&&elements.push(e),canAdd}function eachElement(elements,fn,depth){depth=depth||0,isArray(elements)||(elements=[elements]),forEach(elements,function(s,i){var filter=fn(s,i,depth);isArray(filter)&&filter.length&&eachElement(filter,fn,depth+1)})}function selfAndChildren(elements,unique,maxDepth){var result=[],processedChildren=[];return eachElement(elements,function(element,i,depth){add(result,element,unique);var children=element.children;if((-1===maxDepth||depth<maxDepth)&&children&&add(processedChildren,children,unique))return children}),result}function selfAndDirectChildren(elements,allowDuplicates){return selfAndChildren(elements,!allowDuplicates,1)}function selfAndAllChildren(elements,allowDuplicates){return selfAndChildren(elements,!allowDuplicates,-1)}function getClosure(elements){function handleConnection(c){topLevel[c.source.id]&&topLevel[c.target.id]&&(topLevel[c.id]=c),allShapes[c.source.id]&&allShapes[c.target.id]&&(enclosedConnections[c.id]=enclosedElements[c.id]=c),allConnections[c.id]=c}function handleElement(element){if(enclosedElements[element.id]=element,!element.waypoints)return allShapes[element.id]=element,forEach(element.incoming,handleConnection),forEach(element.outgoing,handleConnection),element.children;enclosedConnections[element.id]=allConnections[element.id]=element}var topLevel=groupBy(elements,function(e){return e.id}),allShapes={},allConnections={},enclosedElements={},enclosedConnections={};return eachElement(elements,handleElement),{allShapes:allShapes,allConnections:allConnections,topLevel:topLevel,enclosedConnections:enclosedConnections,enclosedElements:enclosedElements}}function getBBox(elements,stopRecursion){stopRecursion=!!stopRecursion,isArray(elements)||(elements=[elements]);var minX,minY,maxX,maxY;return forEach(elements,function(element){var bbox=element;element.waypoints&&!stopRecursion&&(bbox=getBBox(element.waypoints,!0));var x=bbox.x,y=bbox.y,height=bbox.height||0,width=bbox.width||0;(x<minX||void 0===minX)&&(minX=x),(y<minY||void 0===minY)&&(minY=y),(x+width>maxX||void 0===maxX)&&(maxX=x+width),(y+height>maxY||void 0===maxY)&&(maxY=y+height)}),{x:minX,y:minY,height:maxY-minY,width:maxX-minX}}function getEnclosedElements(elements,bbox){var filteredElements={};return forEach(elements,function(element){var e=element;e.waypoints&&(e=getBBox(e)),!isNumber(bbox.y)&&e.x>bbox.x&&(filteredElements[element.id]=element),!isNumber(bbox.x)&&e.y>bbox.y&&(filteredElements[element.id]=element),e.x>bbox.x&&e.y>bbox.y&&(isNumber(bbox.width)&&isNumber(bbox.height)&&e.width+e.x<bbox.width+bbox.x&&e.height+e.y<bbox.height+bbox.y?filteredElements[element.id]=element:isNumber(bbox.width)&&isNumber(bbox.height)||(filteredElements[element.id]=element))}),filteredElements}function getElementType(element){return"waypoints"in element?"connection":"x"in element?"shape":"root"}var isArray=_dereq_(193),isNumber=_dereq_(196),groupBy=_dereq_(91),forEach=_dereq_(90);module.exports.add=add,module.exports.eachElement=eachElement,module.exports.selfAndDirectChildren=selfAndDirectChildren,module.exports.selfAndAllChildren=selfAndAllChildren,module.exports.getBBox=getBBox,module.exports.getEnclosedElements=getEnclosedElements,module.exports.getClosure=getClosure,module.exports.getType=getElementType},{193:193,196:196,90:90,91:91}],65:[function(_dereq_,module,exports){"use strict";function __preventDefault(event){return event&&event.preventDefault()}function __stopPropagation(event,immediate){event&&(event.stopPropagation&&event.stopPropagation(),immediate&&event.stopImmediatePropagation&&event.stopImmediatePropagation())}function getOriginal(event){return event.originalEvent||event.srcEvent}function stopEvent(event,immediate){stopPropagation(event,immediate),preventDefault(event)}function preventDefault(event){__preventDefault(event),__preventDefault(getOriginal(event))}function stopPropagation(event,immediate){__stopPropagation(event,immediate),__stopPropagation(getOriginal(event),immediate)}function toPoint(event){return event.pointers&&event.pointers.length&&(event=event.pointers[0]),event.touches&&event.touches.length&&(event=event.touches[0]),event?{x:event.clientX,y:event.clientY}:null}module.exports.getOriginal=getOriginal,module.exports.stopEvent=stopEvent,module.exports.preventDefault=preventDefault,module.exports.stopPropagation=stopPropagation,module.exports.toPoint=toPoint},{}],66:[function(_dereq_,module,exports){"use strict";function getVisual(gfx){return domQuery(".djs-visual",gfx)}function getChildren(gfx){return gfx.parentNode.childNodes[1]}var domQuery=_dereq_(218);module.exports.getVisual=getVisual,module.exports.getChildren=getChildren},{218:218}],67:[function(_dereq_,module,exports){"use strict";function IdGenerator(prefix){this._counter=0,this._prefix=(prefix?prefix+"-":"")+Math.floor(1e9*Math.random())+"-"}module.exports=IdGenerator,IdGenerator.prototype.next=function(){return this._prefix+ ++this._counter}},{}],68:[function(_dereq_,module,exports){"use strict";function isPrimaryButton(event){return!(getOriginalEvent(event)||event).button}var getOriginalEvent=_dereq_(65).getOriginal,isMac=_dereq_(69).isMac;module.exports.isPrimaryButton=isPrimaryButton,module.exports.isMac=isMac,module.exports.hasPrimaryModifier=function(event){var originalEvent=getOriginalEvent(event)||event;return!!isPrimaryButton(event)&&(isMac()?originalEvent.metaKey:originalEvent.ctrlKey)},module.exports.hasSecondaryModifier=function(event){var originalEvent=getOriginalEvent(event)||event;return isPrimaryButton(event)&&originalEvent.shiftKey}},{65:65,69:69}],69:[function(_dereq_,module,exports){"use strict";module.exports.isMac=function(){return/mac/i.test(navigator.platform)}},{}],70:[function(_dereq_,module,exports){"use strict";function toSVGPoints(points){for(var p,result="",i=0;p=points[i];i++)result+=p.x+","+p.y+" ";return result}var svgAttr=_dereq_(257),svgCreate=_dereq_(260);module.exports.componentsToPath=function(elements){return elements.join(",").replace(/,?([A-z]),?/g,"$1")},module.exports.toSVGPoints=toSVGPoints,module.exports.createLine=function(points,attrs){var line=svgCreate("polyline");return svgAttr(line,{points:toSVGPoints(points)}),attrs&&svgAttr(line,attrs),line},module.exports.updateLine=function(gfx,points){return svgAttr(gfx,{points:toSVGPoints(points)}),gfx}},{257:257,260:260}],71:[function(_dereq_,module,exports){"use strict";var svgTransform=_dereq_(264),createTransform=_dereq_(261).createTransform;module.exports.transform=function(gfx,x,y,angle,amount){var translate=createTransform();translate.setTranslate(x,y);var rotate=createTransform();rotate.setRotate(angle,0,0);var scale=createTransform();scale.setScale(amount||1,amount||1),svgTransform(gfx,[translate,rotate,scale])},module.exports.translate=function(gfx,x,y){var translate=createTransform();translate.setTranslate(x,y),svgTransform(gfx,translate)},module.exports.rotate=function(gfx,angle){var rotate=createTransform();rotate.setRotate(angle,0,0),svgTransform(gfx,rotate)},module.exports.scale=function(gfx,amount){var scale=createTransform();scale.setScale(amount,amount),svgTransform(gfx,scale)}},{261:261,264:264}],72:[function(_dereq_,module,exports){"use strict";function parseAlign(align){var parts=align.split("-");return{horizontal:parts[0]||"center",vertical:parts[1]||"top"}}function parsePadding(padding){return isObject(padding)?assign({top:0,left:0,right:0,bottom:0},padding):{top:padding,left:padding,right:padding,bottom:padding}}function getTextBBox(text,fakeText){fakeText.textContent=text;try{var bbox,emptyLine=""===text;return fakeText.textContent=emptyLine?"dummy":text,bbox=pick(fakeText.getBBox(),["width","height"]),emptyLine&&(bbox.width=0),bbox}catch(e){return{width:0,height:0}}}function layoutNext(lines,maxWidth,fakeText){for(var textBBox,originalLine=lines.shift(),fitLine=originalLine;;){if(textBBox=getTextBBox(fitLine,fakeText),textBBox.width=fitLine?textBBox.width:0," "===fitLine||""===fitLine||textBBox.width<Math.round(maxWidth)||fitLine.length<2)return fit(lines,fitLine,originalLine,textBBox);fitLine=shortenLine(fitLine,textBBox.width,maxWidth)}}function fit(lines,fitLine,originalLine,textBBox){if(fitLine.length<originalLine.length){var remainder=originalLine.slice(fitLine.length).trim();lines.unshift(remainder)}return{width:textBBox.width,height:textBBox.height,text:fitLine}}function semanticShorten(line,maxLength){var part,parts=line.split(/(\s|-)/g),shortenedParts=[],length=0;if(parts.length>1)for(;part=parts.shift();){if(!(part.length+length<maxLength)){"-"===part&&shortenedParts.pop();break}shortenedParts.push(part),length+=part.length}return shortenedParts.join("")}function shortenLine(line,width,maxWidth){var length=Math.max(line.length*(maxWidth/width),1),shortenedLine=semanticShorten(line,length);return shortenedLine||(shortenedLine=line.slice(0,Math.max(Math.round(length-1),1))),shortenedLine}function getHelperSvg(){var helperSvg=document.getElementById("helper-svg");return helperSvg||(helperSvg=svgCreate("svg"),svgAttr(helperSvg,{id:"helper-svg",width:0,height:0,style:"visibility: hidden; position: fixed"}),document.body.appendChild(helperSvg)),helperSvg}function Text(config){this._config=assign({},{size:DEFAULT_LABEL_SIZE,padding:DEFAULT_BOX_PADDING,style:{},align:"center-top"},config||{})}var isObject=_dereq_(197),assign=_dereq_(202),pick=_dereq_(208),forEach=_dereq_(90),reduce=_dereq_(93),merge=_dereq_(205),svgAppend=_dereq_(255),svgAttr=_dereq_(257),svgCreate=_dereq_(260),svgRemove=_dereq_(263),DEFAULT_BOX_PADDING=0,DEFAULT_LABEL_SIZE={width:150,height:50};Text.prototype.createText=function(text,options){return this.layoutText(text,options).element},Text.prototype.getDimensions=function(text,options){return this.layoutText(text,options).dimensions},Text.prototype.layoutText=function(text,options){var box=merge({},this._config.size,options.box||{}),style=merge({},this._config.style,options.style||{}),align=parseAlign(options.align||this._config.align),padding=parsePadding(void 0!==options.padding?options.padding:this._config.padding),fitBox=options.fitBox||!1,lines=text.split(/\r?\n/g),layouted=[],maxWidth=box.width-padding.left-padding.right,helperText=svgCreate("text");svgAttr(helperText,{x:0,y:0}),svgAttr(helperText,style);var helperSvg=getHelperSvg();for(svgAppend(helperSvg,helperText);lines.length;)layouted.push(layoutNext(lines,maxWidth,helperText));var y,x,totalHeight=reduce(layouted,function(sum,line,idx){return sum+line.height},0),maxLineWidth=reduce(layouted,function(sum,line,idx){return line.width>sum?line.width:sum},0);switch(align.vertical){case"middle":y=(box.height-totalHeight)/2-layouted[0].height/4;break;default:y=padding.top}var textElement=svgCreate("text");return svgAttr(textElement,style),forEach(layouted,function(line){switch(y+=line.height,align.horizontal){case"left":x=padding.left;break;case"right":x=(fitBox?maxLineWidth:maxWidth)-padding.right-line.width;break;default:x=Math.max(((fitBox?maxLineWidth:maxWidth)-line.width)/2+padding.left,0)}var tspan=svgCreate("tspan");svgAttr(tspan,{x:x,y:y}),tspan.textContent=line.text,svgAppend(textElement,tspan)}),svgRemove(helperText),{dimensions:{width:maxLineWidth,height:totalHeight},element:textElement}},module.exports=Text},{197:197,202:202,205:205,208:208,255:255,257:257,260:260,263:263,90:90,93:93}],73:[function(_dereq_,module,exports){var isArray=function(obj){return"[object Array]"===Object.prototype.toString.call(obj)},annotate=function(){var args=Array.prototype.slice.call(arguments);1===args.length&&isArray(args[0])&&(args=args[0]);var fn=args.pop();return fn.$inject=args,fn},FN_ARGS=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,FN_ARG=/\/\*([^\*]*)\*\//m,parse=function(fn){if("function"!=typeof fn)throw new Error('Cannot annotate "'+fn+'". Expected a function!');var match=fn.toString().match(FN_ARGS);return match[1]&&match[1].split(",").map(function(arg){return match=arg.match(FN_ARG),match?match[1].trim():arg.trim()})||[]};exports.annotate=annotate,exports.parse=parse,exports.isArray=isArray},{}],74:[function(_dereq_,module,exports){module.exports={annotate:_dereq_(73).annotate,Module:_dereq_(76),Injector:_dereq_(75)}},{73:73,75:75,76:76}],75:[function(_dereq_,module,exports){var Module=_dereq_(76),autoAnnotate=_dereq_(73).parse,annotate=_dereq_(73).annotate,isArray=_dereq_(73).isArray,Injector=function(modules,parent){parent=parent||{get:function(name,strict){if(currentlyResolving.push(name),!1===strict)return null;throw error('No provider for "'+name+'"!')}};var currentlyResolving=[],providers=this._providers=Object.create(parent._providers||null),instances=this._instances=Object.create(null),self=instances.injector=this,error=function(msg){var stack=currentlyResolving.join(" -> ");return currentlyResolving.length=0,new Error(stack?msg+" (Resolving: "+stack+")":msg)},get=function(name,strict){if(!providers[name]&&-1!==name.indexOf(".")){for(var parts=name.split("."),pivot=get(parts.shift());parts.length;)pivot=pivot[parts.shift()];return pivot}if(Object.hasOwnProperty.call(instances,name))return instances[name];if(Object.hasOwnProperty.call(providers,name)){if(-1!==currentlyResolving.indexOf(name))throw currentlyResolving.push(name),error("Cannot resolve circular dependency!");return currentlyResolving.push(name),instances[name]=providers[name][0](providers[name][1]),currentlyResolving.pop(),instances[name]}return parent.get(name,strict)},instantiate=function(Type){var instance=Object.create(Type.prototype),returned=invoke(Type,instance);return"object"==typeof returned?returned:instance},invoke=function(fn,context){if("function"!=typeof fn){if(!isArray(fn))throw new Error('Cannot invoke "'+fn+'". Expected a function!');fn=annotate(fn.slice())}var inject=fn.$inject&&fn.$inject||autoAnnotate(fn),dependencies=inject.map(function(dep){return get(dep)});return fn.apply(context,dependencies)},createPrivateInjectorFactory=function(privateChildInjector){return annotate(function(key){return privateChildInjector.get(key)})},createChild=function(modules,forceNewInstances){if(forceNewInstances&&forceNewInstances.length){var provider,cacheIdx,privateChildInjector,privateChildInjectorFactory,fromParentModule=Object.create(null),matchedScopes=Object.create(null),privateInjectorsCache=[],privateChildInjectors=[],privateChildFactories=[];for(var name in providers)provider=providers[name],-1!==forceNewInstances.indexOf(name)&&("private"===provider[2]?(cacheIdx=privateInjectorsCache.indexOf(provider[3]),-1===cacheIdx?(privateChildInjector=provider[3].createChild([],forceNewInstances),privateChildInjectorFactory=createPrivateInjectorFactory(privateChildInjector),privateInjectorsCache.push(provider[3]),privateChildInjectors.push(privateChildInjector),privateChildFactories.push(privateChildInjectorFactory),fromParentModule[name]=[privateChildInjectorFactory,name,"private",privateChildInjector]):fromParentModule[name]=[privateChildFactories[cacheIdx],name,"private",privateChildInjectors[cacheIdx]]):fromParentModule[name]=[provider[2],provider[1]],matchedScopes[name]=!0),"factory"!==provider[2]&&"type"!==provider[2]||!provider[1].$scope||forceNewInstances.forEach(function(scope){-1!==provider[1].$scope.indexOf(scope)&&(fromParentModule[name]=[provider[2],provider[1]],matchedScopes[scope]=!0)});forceNewInstances.forEach(function(scope){if(!matchedScopes[scope])throw new Error('No provider for "'+scope+'". Cannot use provider from the parent!')}),modules.unshift(fromParentModule)}return new Injector(modules,self)},factoryMap={factory:invoke,type:instantiate,value:function(value){return value}};modules.forEach(function(module){function arrayUnwrap(type,value){return"value"!==type&&isArray(value)&&(value=annotate(value.slice())),value}if(module instanceof Module)module.forEach(function(provider){var name=provider[0],type=provider[1],value=provider[2];providers[name]=[factoryMap[type],arrayUnwrap(type,value),type]});else if("object"==typeof module)if(module.__exports__){var clonedModule=Object.keys(module).reduce(function(m,key){return"__"!==key.substring(0,2)&&(m[key]=module[key]),m},Object.create(null)),privateInjector=new Injector((module.__modules__||[]).concat([clonedModule]),self),getFromPrivateInjector=annotate(function(key){return privateInjector.get(key)});module.__exports__.forEach(function(key){providers[key]=[getFromPrivateInjector,key,"private",privateInjector]})}else Object.keys(module).forEach(function(name){if("private"===module[name][2])return void(providers[name]=module[name]);var type=module[name][0],value=module[name][1];providers[name]=[factoryMap[type],arrayUnwrap(type,value),type]})}),this.get=get,this.invoke=invoke,this.instantiate=instantiate,this.createChild=createChild};module.exports=Injector},{73:73,76:76}],76:[function(_dereq_,module,exports){var Module=function(){var providers=[];this.factory=function(name,factory){return providers.push([name,"factory",factory]),this},this.value=function(name,value){return providers.push([name,"value",value]),this},this.type=function(name,type){return providers.push([name,"type",type]),this},this.forEach=function(iterator){providers.forEach(iterator)}};module.exports=Module},{}],77:[function(_dereq_,module,exports){function parse(html,doc){if("string"!=typeof html)throw new TypeError("String expected");doc||(doc=document);var m=/<([\w:]+)/.exec(html);if(!m)return doc.createTextNode(html);html=html.replace(/^\s+|\s+$/g,"");var tag=m[1];if("body"==tag){var el=doc.createElement("html");return el.innerHTML=html,el.removeChild(el.lastChild)}var wrap=map[tag]||map._default,depth=wrap[0],prefix=wrap[1],suffix=wrap[2],el=doc.createElement("div");for(el.innerHTML=prefix+html+suffix;depth--;)el=el.lastChild;if(el.firstChild==el.lastChild)return el.removeChild(el.firstChild);for(var fragment=doc.createDocumentFragment();el.firstChild;)fragment.appendChild(el.removeChild(el.firstChild));return fragment}module.exports=parse;var bugTestDiv,innerHTMLBug=!1;"undefined"!=typeof document&&(bugTestDiv=document.createElement("div"),bugTestDiv.innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',innerHTMLBug=!bugTestDiv.getElementsByTagName("link").length,bugTestDiv=void 0);var map={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:innerHTMLBug?[1,"X<div>","</div>"]:[0,"",""]};map.td=map.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],map.option=map.optgroup=[1,'<select multiple="multiple">',"</select>"],map.thead=map.tbody=map.colgroup=map.caption=map.tfoot=[1,"<table>","</table>"],map.polyline=map.ellipse=map.polygon=map.circle=map.text=map.line=map.path=map.rect=map.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"]},{}],78:[function(_dereq_,module,exports){function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(arg){return"function"==typeof arg}function isNumber(arg){return"number"==typeof arg}function isObject(arg){return"object"==typeof arg&&null!==arg}function isUndefined(arg){return void 0===arg}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this},EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(this._events||(this._events={}),"error"===type&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if((er=arguments[1])instanceof Error)throw er;var err=new Error('Uncaught, unspecified "error" event. ('+er+")");throw err.context=er,err}if(handler=this._events[type],isUndefined(handler))return!1;if(isFunction(handler))switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:args=Array.prototype.slice.call(arguments,1),handler.apply(this,args)}else if(isObject(handler))for(args=Array.prototype.slice.call(arguments,1),listeners=handler.slice(),len=listeners.length,i=0;i<len;i++)listeners[i].apply(this,args);return!0},EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener),this._events[type]?isObject(this._events[type])?this._events[type].push(listener):this._events[type]=[this._events[type],listener]:this._events[type]=listener,isObject(this._events[type])&&!this._events[type].warned&&(m=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners)&&m>0&&this._events[type].length>m&&(this._events[type].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length),"function"==typeof console.trace&&console.trace()),this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(type,listener){function g(){this.removeListener(type,g),fired||(fired=!0,listener.apply(this,arguments))}if(!isFunction(listener))throw TypeError("listener must be a function");var fired=!1;return g.listener=listener,this.on(type,g),this},EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;if(list=this._events[type],length=list.length,position=-1,list===listener||isFunction(list.listener)&&list.listener===listener)delete this._events[type],this._events.removeListener&&this.emit("removeListener",type,listener);else if(isObject(list)){for(i=length;i-- >0;)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(position<0)return this;1===list.length?(list.length=0,delete this._events[type]):list.splice(position,1),this._events.removeListener&&this.emit("removeListener",type,listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[type]&&delete this._events[type],this;if(0===arguments.length){for(key in this._events)"removeListener"!==key&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events={},this}if(listeners=this._events[type],isFunction(listeners))this.removeListener(type,listeners);else if(listeners)for(;listeners.length;)this.removeListener(type,listeners[listeners.length-1]);return delete this._events[type],this},EventEmitter.prototype.listeners=function(type){return this._events&&this._events[type]?isFunction(this._events[type])?[this._events[type]]:this._events[type].slice():[]},EventEmitter.prototype.listenerCount=function(type){if(this._events){var evlistener=this._events[type];if(isFunction(evlistener))return 1;if(evlistener)return evlistener.length}return 0},EventEmitter.listenerCount=function(emitter,type){return emitter.listenerCount(type)}},{}],79:[function(_dereq_,module,exports){var hat=module.exports=function(bits,base){if(base||(base=16),void 0===bits&&(bits=128),bits<=0)return"0";for(var digits=Math.log(Math.pow(2,bits))/Math.log(base),i=2;digits===1/0;i*=2)digits=Math.log(Math.pow(2,bits/i))/Math.log(base)*i;for(var rem=digits-Math.floor(digits),res="",i=0;i<Math.floor(digits);i++){var x=Math.floor(Math.random()*base).toString(base);res=x+res}if(rem){var b=Math.pow(base,rem),x=Math.floor(Math.random()*b).toString(base);res=x+res}var parsed=parseInt(res,base);return parsed!==1/0&&parsed>=Math.pow(2,bits)?hat(bits,base):res};hat.rack=function(bits,base,expandBy){var fn=function(data){var iters=0;do{if(iters++>10){if(!expandBy)throw new Error("too many ID collisions, use more bits");bits+=expandBy}var id=hat(bits,base)}while(Object.hasOwnProperty.call(hats,id));return hats[id]=data,id},hats=fn.hats={};return fn.get=function(id){return fn.hats[id]},fn.set=function(id,value){return fn.hats[id]=value,fn},fn.bits=bits||128,fn.base=base||16,fn}},{}],80:[function(_dereq_,module,exports){"use strict";function Ids(seed){if(!(this instanceof Ids))return new Ids(seed);seed=seed||[128,36,1],this._seed=seed.length?hat.rack(seed[0],seed[1],seed[2]):seed}var hat=_dereq_(79);module.exports=Ids,Ids.prototype.next=function(element){return this._seed(element||!0)},Ids.prototype.nextPrefixed=function(prefix,element){var id;do{id=prefix+this.next(!0)}while(this.assigned(id));return this.claim(id,element),id},Ids.prototype.claim=function(id,element){this._seed.set(id,element||!0)},Ids.prototype.assigned=function(id){return this._seed.get(id)||!1},Ids.prototype.unclaim=function(id){delete this._seed.hats[id]},Ids.prototype.clear=function(){var id,hats=this._seed.hats;for(id in hats)this.unclaim(id)}},{79:79}],81:[function(_dereq_,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:1/0*(s?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias),value*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},{}],82:[function(_dereq_,module,exports){"function"==typeof Object.create?module.exports=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},{}],83:[function(_dereq_,module,exports){function isBuffer(obj){return!!obj.constructor&&"function"==typeof obj.constructor.isBuffer&&obj.constructor.isBuffer(obj)}function isSlowBuffer(obj){return"function"==typeof obj.readFloatLE&&"function"==typeof obj.slice&&isBuffer(obj.slice(0,0))}module.exports=function(obj){return null!=obj&&(isBuffer(obj)||isSlowBuffer(obj)||!!obj._isBuffer)}},{}],84:[function(_dereq_,module,exports){var toString={}.toString;module.exports=Array.isArray||function(arr){return"[object Array]"==toString.call(arr)}},{}],85:[function(_dereq_,module,exports){function last(array){var length=array?array.length:0;return length?array[length-1]:void 0}module.exports=last},{}],86:[function(_dereq_,module,exports){function lodash(value){if(isObjectLike(value)&&!isArray(value)&&!(value instanceof LazyWrapper)){if(value instanceof LodashWrapper)return value;if(hasOwnProperty.call(value,"__chain__")&&hasOwnProperty.call(value,"__wrapped__"))return wrapperClone(value)}return new LodashWrapper(value)}var LazyWrapper=_dereq_(100),LodashWrapper=_dereq_(101),baseLodash=_dereq_(132),isArray=_dereq_(193),isObjectLike=_dereq_(178),wrapperClone=_dereq_(191),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;lodash.prototype=baseLodash.prototype,module.exports=lodash},{100:100,101:101,132:132,178:178,191:191,193:193}],87:[function(_dereq_,module,exports){function every(collection,predicate,thisArg){var func=isArray(collection)?arrayEvery:baseEvery;return thisArg&&isIterateeCall(collection,predicate,thisArg)&&(predicate=void 0),"function"==typeof predicate&&void 0===thisArg||(predicate=baseCallback(predicate,thisArg,3)),func(collection,predicate)}var arrayEvery=_dereq_(105),baseCallback=_dereq_(113),baseEvery=_dereq_(119),isArray=_dereq_(193),isIterateeCall=_dereq_(174);module.exports=every},{105:105,113:113,119:119,174:174,193:193}],88:[function(_dereq_,module,exports){function filter(collection,predicate,thisArg){var func=isArray(collection)?arrayFilter:baseFilter;return predicate=baseCallback(predicate,thisArg,3),func(collection,predicate)}var arrayFilter=_dereq_(106),baseCallback=_dereq_(113),baseFilter=_dereq_(120),isArray=_dereq_(193);module.exports=filter},{106:106,113:113,120:120,193:193}],89:[function(_dereq_,module,exports){var baseEach=_dereq_(118),createFind=_dereq_(157),find=createFind(baseEach);module.exports=find},{118:118,157:157}],90:[function(_dereq_,module,exports){var arrayEach=_dereq_(104),baseEach=_dereq_(118),createForEach=_dereq_(158),forEach=createForEach(arrayEach,baseEach);module.exports=forEach},{104:104,118:118,158:158}],91:[function(_dereq_,module,exports){var createAggregator=_dereq_(150),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,groupBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?result[key].push(value):result[key]=[value]});module.exports=groupBy},{150:150}],
92:[function(_dereq_,module,exports){function map(collection,iteratee,thisArg){var func=isArray(collection)?arrayMap:baseMap;return iteratee=baseCallback(iteratee,thisArg,3),func(collection,iteratee)}var arrayMap=_dereq_(107),baseCallback=_dereq_(113),baseMap=_dereq_(133),isArray=_dereq_(193);module.exports=map},{107:107,113:113,133:133,193:193}],93:[function(_dereq_,module,exports){var arrayReduce=_dereq_(109),baseEach=_dereq_(118),createReduce=_dereq_(161),reduce=createReduce(arrayReduce,baseEach);module.exports=reduce},{109:109,118:118,161:161}],94:[function(_dereq_,module,exports){function some(collection,predicate,thisArg){var func=isArray(collection)?arraySome:baseSome;return thisArg&&isIterateeCall(collection,predicate,thisArg)&&(predicate=void 0),"function"==typeof predicate&&void 0===thisArg||(predicate=baseCallback(predicate,thisArg,3)),func(collection,predicate)}var arraySome=_dereq_(110),baseCallback=_dereq_(113),baseSome=_dereq_(143),isArray=_dereq_(193),isIterateeCall=_dereq_(174);module.exports=some},{110:110,113:113,143:143,174:174,193:193}],95:[function(_dereq_,module,exports){var getNative=_dereq_(170),nativeNow=getNative(Date,"now"),now=nativeNow||function(){return(new Date).getTime()};module.exports=now},{170:170}],96:[function(_dereq_,module,exports){var createWrapper=_dereq_(162),replaceHolders=_dereq_(186),restParam=_dereq_(99),bind=restParam(function(func,thisArg,partials){var bitmask=1;if(partials.length){var holders=replaceHolders(partials,bind.placeholder);bitmask|=32}return createWrapper(func,bitmask,thisArg,partials,holders)});bind.placeholder={},module.exports=bind},{162:162,186:186,99:99}],97:[function(_dereq_,module,exports){function debounce(func,wait,options){function cancel(){timeoutId&&clearTimeout(timeoutId),maxTimeoutId&&clearTimeout(maxTimeoutId),lastCalled=0,maxTimeoutId=timeoutId=trailingCall=void 0}function complete(isCalled,id){id&&clearTimeout(id),maxTimeoutId=timeoutId=trailingCall=void 0,isCalled&&(lastCalled=now(),result=func.apply(thisArg,args),timeoutId||maxTimeoutId||(args=thisArg=void 0))}function delayed(){var remaining=wait-(now()-stamp);remaining<=0||remaining>wait?complete(trailingCall,maxTimeoutId):timeoutId=setTimeout(delayed,remaining)}function maxDelayed(){complete(trailing,timeoutId)}function debounced(){if(args=arguments,stamp=now(),thisArg=this,trailingCall=trailing&&(timeoutId||!leading),!1===maxWait)var leadingCall=leading&&!timeoutId;else{maxTimeoutId||leading||(lastCalled=stamp);var remaining=maxWait-(stamp-lastCalled),isCalled=remaining<=0||remaining>maxWait;isCalled?(maxTimeoutId&&(maxTimeoutId=clearTimeout(maxTimeoutId)),lastCalled=stamp,result=func.apply(thisArg,args)):maxTimeoutId||(maxTimeoutId=setTimeout(maxDelayed,remaining))}return isCalled&&timeoutId?timeoutId=clearTimeout(timeoutId):timeoutId||wait===maxWait||(timeoutId=setTimeout(delayed,wait)),leadingCall&&(isCalled=!0,result=func.apply(thisArg,args)),!isCalled||timeoutId||maxTimeoutId||(args=thisArg=void 0),result}var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,maxWait=!1,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);if(wait=wait<0?0:+wait||0,!0===options){var leading=!0;trailing=!1}else isObject(options)&&(leading=!!options.leading,maxWait="maxWait"in options&&nativeMax(+options.maxWait||0,wait),trailing="trailing"in options?!!options.trailing:trailing);return debounced.cancel=cancel,debounced}var isObject=_dereq_(197),now=_dereq_(95),FUNC_ERROR_TEXT="Expected a function",nativeMax=Math.max;module.exports=debounce},{197:197,95:95}],98:[function(_dereq_,module,exports){var baseDelay=_dereq_(116),restParam=_dereq_(99),defer=restParam(function(func,args){return baseDelay(func,1,args)});module.exports=defer},{116:116,99:99}],99:[function(_dereq_,module,exports){function restParam(func,start){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return start=nativeMax(void 0===start?func.length-1:+start||0,0),function(){for(var args=arguments,index=-1,length=nativeMax(args.length-start,0),rest=Array(length);++index<length;)rest[index]=args[start+index];switch(start){case 0:return func.call(this,rest);case 1:return func.call(this,args[0],rest);case 2:return func.call(this,args[0],args[1],rest)}var otherArgs=Array(start+1);for(index=-1;++index<start;)otherArgs[index]=args[index];return otherArgs[start]=rest,func.apply(this,otherArgs)}}var FUNC_ERROR_TEXT="Expected a function",nativeMax=Math.max;module.exports=restParam},{}],100:[function(_dereq_,module,exports){function LazyWrapper(value){this.__wrapped__=value,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=POSITIVE_INFINITY,this.__views__=[]}var baseCreate=_dereq_(115),baseLodash=_dereq_(132),POSITIVE_INFINITY=Number.POSITIVE_INFINITY;LazyWrapper.prototype=baseCreate(baseLodash.prototype),LazyWrapper.prototype.constructor=LazyWrapper,module.exports=LazyWrapper},{115:115,132:132}],101:[function(_dereq_,module,exports){function LodashWrapper(value,chainAll,actions){this.__wrapped__=value,this.__actions__=actions||[],this.__chain__=!!chainAll}var baseCreate=_dereq_(115),baseLodash=_dereq_(132);LodashWrapper.prototype=baseCreate(baseLodash.prototype),LodashWrapper.prototype.constructor=LodashWrapper,module.exports=LodashWrapper},{115:115,132:132}],102:[function(_dereq_,module,exports){(function(global){function SetCache(values){var length=values?values.length:0;for(this.data={hash:nativeCreate(null),set:new Set};length--;)this.push(values[length])}var cachePush=_dereq_(147),getNative=_dereq_(170),Set=getNative(global,"Set"),nativeCreate=getNative(Object,"create");SetCache.prototype.push=cachePush,module.exports=SetCache}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{147:147,170:170}],103:[function(_dereq_,module,exports){function arrayCopy(source,array){var index=-1,length=source.length;for(array||(array=Array(length));++index<length;)array[index]=source[index];return array}module.exports=arrayCopy},{}],104:[function(_dereq_,module,exports){function arrayEach(array,iteratee){for(var index=-1,length=array.length;++index<length&&!1!==iteratee(array[index],index,array););return array}module.exports=arrayEach},{}],105:[function(_dereq_,module,exports){function arrayEvery(array,predicate){for(var index=-1,length=array.length;++index<length;)if(!predicate(array[index],index,array))return!1;return!0}module.exports=arrayEvery},{}],106:[function(_dereq_,module,exports){function arrayFilter(array,predicate){for(var index=-1,length=array.length,resIndex=-1,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[++resIndex]=value)}return result}module.exports=arrayFilter},{}],107:[function(_dereq_,module,exports){function arrayMap(array,iteratee){for(var index=-1,length=array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}module.exports=arrayMap},{}],108:[function(_dereq_,module,exports){function arrayPush(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}module.exports=arrayPush},{}],109:[function(_dereq_,module,exports){function arrayReduce(array,iteratee,accumulator,initFromArray){var index=-1,length=array.length;for(initFromArray&&length&&(accumulator=array[++index]);++index<length;)accumulator=iteratee(accumulator,array[index],index,array);return accumulator}module.exports=arrayReduce},{}],110:[function(_dereq_,module,exports){function arraySome(array,predicate){for(var index=-1,length=array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1}module.exports=arraySome},{}],111:[function(_dereq_,module,exports){function assignWith(object,source,customizer){for(var index=-1,props=keys(source),length=props.length;++index<length;){var key=props[index],value=object[key],result=customizer(value,source[key],key,object,source);(result===result?result===value:value!==value)&&(void 0!==value||key in object)||(object[key]=result)}return object}var keys=_dereq_(203);module.exports=assignWith},{203:203}],112:[function(_dereq_,module,exports){function baseAssign(object,source){return null==source?object:baseCopy(source,keys(source),object)}var baseCopy=_dereq_(114),keys=_dereq_(203);module.exports=baseAssign},{114:114,203:203}],113:[function(_dereq_,module,exports){function baseCallback(func,thisArg,argCount){var type=typeof func;return"function"==type?void 0===thisArg?func:bindCallback(func,thisArg,argCount):null==func?identity:"object"==type?baseMatches(func):void 0===thisArg?property(func):baseMatchesProperty(func,thisArg)}var baseMatches=_dereq_(134),baseMatchesProperty=_dereq_(135),bindCallback=_dereq_(145),identity=_dereq_(209),property=_dereq_(211);module.exports=baseCallback},{134:134,135:135,145:145,209:209,211:211}],114:[function(_dereq_,module,exports){function baseCopy(source,props,object){object||(object={});for(var index=-1,length=props.length;++index<length;){var key=props[index];object[key]=source[key]}return object}module.exports=baseCopy},{}],115:[function(_dereq_,module,exports){var isObject=_dereq_(197),baseCreate=function(){function object(){}return function(prototype){if(isObject(prototype)){object.prototype=prototype;var result=new object;object.prototype=void 0}return result||{}}}();module.exports=baseCreate},{197:197}],116:[function(_dereq_,module,exports){function baseDelay(func,wait,args){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return setTimeout(function(){func.apply(void 0,args)},wait)}var FUNC_ERROR_TEXT="Expected a function";module.exports=baseDelay},{}],117:[function(_dereq_,module,exports){function baseDifference(array,values){var length=array?array.length:0,result=[];if(!length)return result;var index=-1,indexOf=baseIndexOf,isCommon=!0,cache=isCommon&&values.length>=LARGE_ARRAY_SIZE?createCache(values):null,valuesLength=values.length;cache&&(indexOf=cacheIndexOf,isCommon=!1,values=cache);outer:for(;++index<length;){var value=array[index];if(isCommon&&value===value){for(var valuesIndex=valuesLength;valuesIndex--;)if(values[valuesIndex]===value)continue outer;result.push(value)}else indexOf(values,value,0)<0&&result.push(value)}return result}var baseIndexOf=_dereq_(128),cacheIndexOf=_dereq_(146),createCache=_dereq_(155),LARGE_ARRAY_SIZE=200;module.exports=baseDifference},{128:128,146:146,155:155}],118:[function(_dereq_,module,exports){var baseForOwn=_dereq_(126),createBaseEach=_dereq_(152),baseEach=createBaseEach(baseForOwn);module.exports=baseEach},{126:126,152:152}],119:[function(_dereq_,module,exports){function baseEvery(collection,predicate){var result=!0;return baseEach(collection,function(value,index,collection){return result=!!predicate(value,index,collection)}),result}var baseEach=_dereq_(118);module.exports=baseEvery},{118:118}],120:[function(_dereq_,module,exports){function baseFilter(collection,predicate){var result=[];return baseEach(collection,function(value,index,collection){predicate(value,index,collection)&&result.push(value)}),result}var baseEach=_dereq_(118);module.exports=baseFilter},{118:118}],121:[function(_dereq_,module,exports){function baseFind(collection,predicate,eachFunc,retKey){var result;return eachFunc(collection,function(value,key,collection){if(predicate(value,key,collection))return result=retKey?key:value,!1}),result}module.exports=baseFind},{}],122:[function(_dereq_,module,exports){function baseFindIndex(array,predicate,fromRight){for(var length=array.length,index=fromRight?length:-1;fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1}module.exports=baseFindIndex},{}],123:[function(_dereq_,module,exports){function baseFlatten(array,isDeep,isStrict,result){result||(result=[]);for(var index=-1,length=array.length;++index<length;){var value=array[index];isObjectLike(value)&&isArrayLike(value)&&(isStrict||isArray(value)||isArguments(value))?isDeep?baseFlatten(value,isDeep,isStrict,result):arrayPush(result,value):isStrict||(result[result.length]=value)}return result}var arrayPush=_dereq_(108),isArguments=_dereq_(192),isArray=_dereq_(193),isArrayLike=_dereq_(172),isObjectLike=_dereq_(178);module.exports=baseFlatten},{108:108,172:172,178:178,192:192,193:193}],124:[function(_dereq_,module,exports){var createBaseFor=_dereq_(153),baseFor=createBaseFor();module.exports=baseFor},{153:153}],125:[function(_dereq_,module,exports){function baseForIn(object,iteratee){return baseFor(object,iteratee,keysIn)}var baseFor=_dereq_(124),keysIn=_dereq_(204);module.exports=baseForIn},{124:124,204:204}],126:[function(_dereq_,module,exports){function baseForOwn(object,iteratee){return baseFor(object,iteratee,keys)}var baseFor=_dereq_(124),keys=_dereq_(203);module.exports=baseForOwn},{124:124,203:203}],127:[function(_dereq_,module,exports){function baseGet(object,path,pathKey){if(null!=object){void 0!==pathKey&&pathKey in toObject(object)&&(path=[pathKey]);for(var index=0,length=path.length;null!=object&&index<length;)object=object[path[index++]];return index&&index==length?object:void 0}}var toObject=_dereq_(189);module.exports=baseGet},{189:189}],128:[function(_dereq_,module,exports){function baseIndexOf(array,value,fromIndex){if(value!==value)return indexOfNaN(array,fromIndex);for(var index=fromIndex-1,length=array.length;++index<length;)if(array[index]===value)return index;return-1}var indexOfNaN=_dereq_(171);module.exports=baseIndexOf},{171:171}],129:[function(_dereq_,module,exports){function baseIsEqual(value,other,customizer,isLoose,stackA,stackB){return value===other||(null==value||null==other||!isObject(value)&&!isObjectLike(other)?value!==value&&other!==other:baseIsEqualDeep(value,other,baseIsEqual,customizer,isLoose,stackA,stackB))}var baseIsEqualDeep=_dereq_(130),isObject=_dereq_(197),isObjectLike=_dereq_(178);module.exports=baseIsEqual},{130:130,178:178,197:197}],130:[function(_dereq_,module,exports){function baseIsEqualDeep(object,other,equalFunc,customizer,isLoose,stackA,stackB){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=arrayTag,othTag=arrayTag;objIsArr||(objTag=objToString.call(object),objTag==argsTag?objTag=objectTag:objTag!=objectTag&&(objIsArr=isTypedArray(object))),othIsArr||(othTag=objToString.call(other),othTag==argsTag?othTag=objectTag:othTag!=objectTag&&(othIsArr=isTypedArray(other)));var objIsObj=objTag==objectTag,othIsObj=othTag==objectTag,isSameTag=objTag==othTag;if(isSameTag&&!objIsArr&&!objIsObj)return equalByTag(object,other,objTag);if(!isLoose){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped)return equalFunc(objIsWrapped?object.value():object,othIsWrapped?other.value():other,customizer,isLoose,stackA,stackB)}if(!isSameTag)return!1;stackA||(stackA=[]),stackB||(stackB=[]);for(var length=stackA.length;length--;)if(stackA[length]==object)return stackB[length]==other;stackA.push(object),stackB.push(other);var result=(objIsArr?equalArrays:equalObjects)(object,other,equalFunc,customizer,isLoose,stackA,stackB);return stackA.pop(),stackB.pop(),result}var equalArrays=_dereq_(163),equalByTag=_dereq_(164),equalObjects=_dereq_(165),isArray=_dereq_(193),isTypedArray=_dereq_(200),argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,objToString=objectProto.toString;module.exports=baseIsEqualDeep},{163:163,164:164,165:165,193:193,200:200}],131:[function(_dereq_,module,exports){function baseIsMatch(object,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=toObject(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){data=matchData[index];var key=data[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(void 0===objValue&&!(key in object))return!1}else{var result=customizer?customizer(objValue,srcValue,key):void 0;if(!(void 0===result?baseIsEqual(srcValue,objValue,customizer,!0):result))return!1}}return!0}var baseIsEqual=_dereq_(129),toObject=_dereq_(189);module.exports=baseIsMatch},{129:129,189:189}],132:[function(_dereq_,module,exports){function baseLodash(){}module.exports=baseLodash},{}],133:[function(_dereq_,module,exports){function baseMap(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value,key,collection){result[++index]=iteratee(value,key,collection)}),result}var baseEach=_dereq_(118),isArrayLike=_dereq_(172);module.exports=baseMap},{118:118,172:172}],134:[function(_dereq_,module,exports){function baseMatches(source){var matchData=getMatchData(source);if(1==matchData.length&&matchData[0][2]){var key=matchData[0][0],value=matchData[0][1];return function(object){return null!=object&&(object[key]===value&&(void 0!==value||key in toObject(object)))}}return function(object){return baseIsMatch(object,matchData)}}var baseIsMatch=_dereq_(131),getMatchData=_dereq_(169),toObject=_dereq_(189);module.exports=baseMatches},{131:131,169:169,189:189}],135:[function(_dereq_,module,exports){function baseMatchesProperty(path,srcValue){var isArr=isArray(path),isCommon=isKey(path)&&isStrictComparable(srcValue),pathKey=path+"";return path=toPath(path),function(object){if(null==object)return!1;var key=pathKey;if(object=toObject(object),(isArr||!isCommon)&&!(key in object)){if(null==(object=1==path.length?object:baseGet(object,baseSlice(path,0,-1))))return!1;key=last(path),object=toObject(object)}return object[key]===srcValue?void 0!==srcValue||key in object:baseIsEqual(srcValue,object[key],void 0,!0)}}var baseGet=_dereq_(127),baseIsEqual=_dereq_(129),baseSlice=_dereq_(142),isArray=_dereq_(193),isKey=_dereq_(175),isStrictComparable=_dereq_(179),last=_dereq_(85),toObject=_dereq_(189),toPath=_dereq_(190);module.exports=baseMatchesProperty},{127:127,129:129,142:142,175:175,179:179,189:189,190:190,193:193,85:85}],136:[function(_dereq_,module,exports){function baseMerge(object,source,customizer,stackA,stackB){if(!isObject(object))return object;var isSrcArr=isArrayLike(source)&&(isArray(source)||isTypedArray(source)),props=isSrcArr?void 0:keys(source);return arrayEach(props||source,function(srcValue,key){if(props&&(key=srcValue,srcValue=source[key]),isObjectLike(srcValue))stackA||(stackA=[]),stackB||(stackB=[]),baseMergeDeep(object,source,key,baseMerge,customizer,stackA,stackB);else{var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):void 0,isCommon=void 0===result;isCommon&&(result=srcValue),void 0===result&&(!isSrcArr||key in object)||!isCommon&&(result===result?result===value:value!==value)||(object[key]=result)}}),object}var arrayEach=_dereq_(104),baseMergeDeep=_dereq_(137),isArray=_dereq_(193),isArrayLike=_dereq_(172),isObject=_dereq_(197),isObjectLike=_dereq_(178),isTypedArray=_dereq_(200),keys=_dereq_(203);module.exports=baseMerge},{104:104,137:137,172:172,178:178,193:193,197:197,200:200,203:203}],137:[function(_dereq_,module,exports){function baseMergeDeep(object,source,key,mergeFunc,customizer,stackA,stackB){for(var length=stackA.length,srcValue=source[key];length--;)if(stackA[length]==srcValue)return void(object[key]=stackB[length]);var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):void 0,isCommon=void 0===result;isCommon&&(result=srcValue,isArrayLike(srcValue)&&(isArray(srcValue)||isTypedArray(srcValue))?result=isArray(value)?value:isArrayLike(value)?arrayCopy(value):[]:isPlainObject(srcValue)||isArguments(srcValue)?result=isArguments(value)?toPlainObject(value):isPlainObject(value)?value:{}:isCommon=!1),stackA.push(srcValue),stackB.push(result),isCommon?object[key]=mergeFunc(result,srcValue,customizer,stackA,stackB):(result===result?result!==value:value===value)&&(object[key]=result)}var arrayCopy=_dereq_(103),isArguments=_dereq_(192),isArray=_dereq_(193),isArrayLike=_dereq_(172),isPlainObject=_dereq_(198),isTypedArray=_dereq_(200),toPlainObject=_dereq_(201);module.exports=baseMergeDeep},{103:103,172:172,192:192,193:193,198:198,200:200,201:201}],138:[function(_dereq_,module,exports){function baseProperty(key){return function(object){return null==object?void 0:object[key]}}module.exports=baseProperty},{}],139:[function(_dereq_,module,exports){function basePropertyDeep(path){var pathKey=path+"";return path=toPath(path),function(object){return baseGet(object,path,pathKey)}}var baseGet=_dereq_(127),toPath=_dereq_(190);module.exports=basePropertyDeep},{127:127,190:190}],140:[function(_dereq_,module,exports){function baseReduce(collection,iteratee,accumulator,initFromCollection,eachFunc){return eachFunc(collection,function(value,index,collection){accumulator=initFromCollection?(initFromCollection=!1,value):iteratee(accumulator,value,index,collection)}),accumulator}module.exports=baseReduce},{}],141:[function(_dereq_,module,exports){var identity=_dereq_(209),metaMap=_dereq_(181),baseSetData=metaMap?function(func,data){return metaMap.set(func,data),func}:identity;module.exports=baseSetData},{181:181,209:209}],142:[function(_dereq_,module,exports){function baseSlice(array,start,end){var index=-1,length=array.length;start=null==start?0:+start||0,start<0&&(start=-start>length?0:length+start),end=void 0===end||end>length?length:+end||0,end<0&&(end+=length),length=start>end?0:end-start>>>0,start>>>=0;for(var result=Array(length);++index<length;)result[index]=array[index+start];return result}module.exports=baseSlice},{}],143:[function(_dereq_,module,exports){function baseSome(collection,predicate){var result;return baseEach(collection,function(value,index,collection){return!(result=predicate(value,index,collection))}),!!result}var baseEach=_dereq_(118);module.exports=baseSome},{118:118}],144:[function(_dereq_,module,exports){function baseToString(value){return null==value?"":value+""}module.exports=baseToString},{}],145:[function(_dereq_,module,exports){function bindCallback(func,thisArg,argCount){if("function"!=typeof func)return identity;if(void 0===thisArg)return func;switch(argCount){case 1:return function(value){return func.call(thisArg,value)};case 3:return function(value,index,collection){return func.call(thisArg,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection)};case 5:return function(value,other,key,object,source){return func.call(thisArg,value,other,key,object,source)}}return function(){return func.apply(thisArg,arguments)}}var identity=_dereq_(209);module.exports=bindCallback},{209:209}],146:[function(_dereq_,module,exports){function cacheIndexOf(cache,value){var data=cache.data;return("string"==typeof value||isObject(value)?data.set.has(value):data.hash[value])?0:-1}var isObject=_dereq_(197);module.exports=cacheIndexOf},{197:197}],147:[function(_dereq_,module,exports){function cachePush(value){var data=this.data;"string"==typeof value||isObject(value)?data.set.add(value):data.hash[value]=!0}var isObject=_dereq_(197);module.exports=cachePush},{197:197}],148:[function(_dereq_,module,exports){function composeArgs(args,partials,holders){for(var holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length-holdersLength,0),leftIndex=-1,leftLength=partials.length,result=Array(leftLength+argsLength);++leftIndex<leftLength;)result[leftIndex]=partials[leftIndex];for(;++argsIndex<holdersLength;)result[holders[argsIndex]]=args[argsIndex];for(;argsLength--;)result[leftIndex++]=args[argsIndex++];return result}var nativeMax=Math.max;module.exports=composeArgs},{}],149:[function(_dereq_,module,exports){function composeArgsRight(args,partials,holders){for(var holdersIndex=-1,holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length-holdersLength,0),rightIndex=-1,rightLength=partials.length,result=Array(argsLength+rightLength);++argsIndex<argsLength;)result[argsIndex]=args[argsIndex];for(var offset=argsIndex;++rightIndex<rightLength;)result[offset+rightIndex]=partials[rightIndex];for(;++holdersIndex<holdersLength;)result[offset+holders[holdersIndex]]=args[argsIndex++];return result}var nativeMax=Math.max;module.exports=composeArgsRight},{}],150:[function(_dereq_,module,exports){function createAggregator(setter,initializer){return function(collection,iteratee,thisArg){var result=initializer?initializer():{};if(iteratee=baseCallback(iteratee,thisArg,3),isArray(collection))for(var index=-1,length=collection.length;++index<length;){var value=collection[index];setter(result,value,iteratee(value,index,collection),collection)}else baseEach(collection,function(value,key,collection){setter(result,value,iteratee(value,key,collection),collection)});return result}}var baseCallback=_dereq_(113),baseEach=_dereq_(118),isArray=_dereq_(193);module.exports=createAggregator},{113:113,118:118,193:193}],151:[function(_dereq_,module,exports){function createAssigner(assigner){return restParam(function(object,sources){var index=-1,length=null==object?0:sources.length,customizer=length>2?sources[length-2]:void 0,guard=length>2?sources[2]:void 0,thisArg=length>1?sources[length-1]:void 0;for("function"==typeof customizer?(customizer=bindCallback(customizer,thisArg,5),length-=2):(customizer="function"==typeof thisArg?thisArg:void 0,length-=customizer?1:0),guard&&isIterateeCall(sources[0],sources[1],guard)&&(customizer=length<3?void 0:customizer,length=1);++index<length;){var source=sources[index];source&&assigner(object,source,customizer)}return object})}var bindCallback=_dereq_(145),isIterateeCall=_dereq_(174),restParam=_dereq_(99);module.exports=createAssigner},{145:145,174:174,99:99}],152:[function(_dereq_,module,exports){function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){var length=collection?getLength(collection):0;if(!isLength(length))return eachFunc(collection,iteratee);for(var index=fromRight?length:-1,iterable=toObject(collection);(fromRight?index--:++index<length)&&!1!==iteratee(iterable[index],index,iterable););return collection}}var getLength=_dereq_(168),isLength=_dereq_(177),toObject=_dereq_(189);module.exports=createBaseEach},{168:168,177:177,189:189}],153:[function(_dereq_,module,exports){function createBaseFor(fromRight){return function(object,iteratee,keysFunc){for(var iterable=toObject(object),props=keysFunc(object),length=props.length,index=fromRight?length:-1;fromRight?index--:++index<length;){var key=props[index];if(!1===iteratee(iterable[key],key,iterable))break}return object}}var toObject=_dereq_(189);module.exports=createBaseFor},{189:189}],154:[function(_dereq_,module,exports){(function(global){function createBindWrapper(func,thisArg){function wrapper(){return(this&&this!==global&&this instanceof wrapper?Ctor:func).apply(thisArg,arguments)}var Ctor=createCtorWrapper(func);return wrapper}var createCtorWrapper=_dereq_(156);module.exports=createBindWrapper}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{156:156}],155:[function(_dereq_,module,exports){(function(global){function createCache(values){return nativeCreate&&Set?new SetCache(values):null}var SetCache=_dereq_(102),getNative=_dereq_(170),Set=getNative(global,"Set"),nativeCreate=getNative(Object,"create");module.exports=createCache}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{102:102,170:170}],156:[function(_dereq_,module,exports){function createCtorWrapper(Ctor){return function(){var args=arguments;switch(args.length){case 0:return new Ctor;case 1:return new Ctor(args[0]);case 2:return new Ctor(args[0],args[1]);case 3:return new Ctor(args[0],args[1],args[2]);case 4:return new Ctor(args[0],args[1],args[2],args[3]);case 5:return new Ctor(args[0],args[1],args[2],args[3],args[4]);case 6:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5],args[6])}var thisBinding=baseCreate(Ctor.prototype),result=Ctor.apply(thisBinding,args);return isObject(result)?result:thisBinding}}var baseCreate=_dereq_(115),isObject=_dereq_(197);module.exports=createCtorWrapper},{115:115,197:197}],157:[function(_dereq_,module,exports){function createFind(eachFunc,fromRight){return function(collection,predicate,thisArg){if(predicate=baseCallback(predicate,thisArg,3),isArray(collection)){var index=baseFindIndex(collection,predicate,fromRight);return index>-1?collection[index]:void 0}return baseFind(collection,predicate,eachFunc)}}var baseCallback=_dereq_(113),baseFind=_dereq_(121),baseFindIndex=_dereq_(122),isArray=_dereq_(193);module.exports=createFind},{113:113,121:121,122:122,193:193}],158:[function(_dereq_,module,exports){function createForEach(arrayFunc,eachFunc){return function(collection,iteratee,thisArg){return"function"==typeof iteratee&&void 0===thisArg&&isArray(collection)?arrayFunc(collection,iteratee):eachFunc(collection,bindCallback(iteratee,thisArg,3))}}var bindCallback=_dereq_(145),isArray=_dereq_(193);module.exports=createForEach},{145:145,193:193}],159:[function(_dereq_,module,exports){(function(global){function createHybridWrapper(func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity){function wrapper(){for(var length=arguments.length,index=length,args=Array(length);index--;)args[index]=arguments[index];if(partials&&(args=composeArgs(args,partials,holders)),partialsRight&&(args=composeArgsRight(args,partialsRight,holdersRight)),isCurry||isCurryRight){var placeholder=wrapper.placeholder,argsHolders=replaceHolders(args,placeholder);if((length-=argsHolders.length)<arity){var newArgPos=argPos?arrayCopy(argPos):void 0,newArity=nativeMax(arity-length,0),newsHolders=isCurry?argsHolders:void 0,newHoldersRight=isCurry?void 0:argsHolders,newPartials=isCurry?args:void 0,newPartialsRight=isCurry?void 0:args;bitmask|=isCurry?PARTIAL_FLAG:PARTIAL_RIGHT_FLAG,bitmask&=~(isCurry?PARTIAL_RIGHT_FLAG:PARTIAL_FLAG),isCurryBound||(bitmask&=~(BIND_FLAG|BIND_KEY_FLAG));var newData=[func,bitmask,thisArg,newPartials,newsHolders,newPartialsRight,newHoldersRight,newArgPos,ary,newArity],result=createHybridWrapper.apply(void 0,newData);return isLaziable(func)&&setData(result,newData),result.placeholder=placeholder,result}}var thisBinding=isBind?thisArg:this,fn=isBindKey?thisBinding[func]:func;return argPos&&(args=reorder(args,argPos)),isAry&&ary<args.length&&(args.length=ary),this&&this!==global&&this instanceof wrapper&&(fn=Ctor||createCtorWrapper(func)),fn.apply(thisBinding,args)}var isAry=bitmask&ARY_FLAG,isBind=bitmask&BIND_FLAG,isBindKey=bitmask&BIND_KEY_FLAG,isCurry=bitmask&CURRY_FLAG,isCurryBound=bitmask&CURRY_BOUND_FLAG,isCurryRight=bitmask&CURRY_RIGHT_FLAG,Ctor=isBindKey?void 0:createCtorWrapper(func);return wrapper}var arrayCopy=_dereq_(103),composeArgs=_dereq_(148),composeArgsRight=_dereq_(149),createCtorWrapper=_dereq_(156),isLaziable=_dereq_(176),reorder=_dereq_(185),replaceHolders=_dereq_(186),setData=_dereq_(187),BIND_FLAG=1,BIND_KEY_FLAG=2,CURRY_BOUND_FLAG=4,CURRY_FLAG=8,CURRY_RIGHT_FLAG=16,PARTIAL_FLAG=32,PARTIAL_RIGHT_FLAG=64,ARY_FLAG=128,nativeMax=Math.max;module.exports=createHybridWrapper}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{103:103,148:148,149:149,156:156,176:176,185:185,186:186,187:187}],160:[function(_dereq_,module,exports){(function(global){function createPartialWrapper(func,bitmask,thisArg,partials){function wrapper(){for(var argsIndex=-1,argsLength=arguments.length,leftIndex=-1,leftLength=partials.length,args=Array(leftLength+argsLength);++leftIndex<leftLength;)args[leftIndex]=partials[leftIndex];for(;argsLength--;)args[leftIndex++]=arguments[++argsIndex]
;return(this&&this!==global&&this instanceof wrapper?Ctor:func).apply(isBind?thisArg:this,args)}var isBind=bitmask&BIND_FLAG,Ctor=createCtorWrapper(func);return wrapper}var createCtorWrapper=_dereq_(156),BIND_FLAG=1;module.exports=createPartialWrapper}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{156:156}],161:[function(_dereq_,module,exports){function createReduce(arrayFunc,eachFunc){return function(collection,iteratee,accumulator,thisArg){var initFromArray=arguments.length<3;return"function"==typeof iteratee&&void 0===thisArg&&isArray(collection)?arrayFunc(collection,iteratee,accumulator,initFromArray):baseReduce(collection,baseCallback(iteratee,thisArg,4),accumulator,initFromArray,eachFunc)}}var baseCallback=_dereq_(113),baseReduce=_dereq_(140),isArray=_dereq_(193);module.exports=createReduce},{113:113,140:140,193:193}],162:[function(_dereq_,module,exports){function createWrapper(func,bitmask,thisArg,partials,holders,argPos,ary,arity){var isBindKey=bitmask&BIND_KEY_FLAG;if(!isBindKey&&"function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);var length=partials?partials.length:0;if(length||(bitmask&=~(PARTIAL_FLAG|PARTIAL_RIGHT_FLAG),partials=holders=void 0),length-=holders?holders.length:0,bitmask&PARTIAL_RIGHT_FLAG){var partialsRight=partials,holdersRight=holders;partials=holders=void 0}var data=isBindKey?void 0:getData(func),newData=[func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity];if(data&&(mergeData(newData,data),bitmask=newData[1],arity=newData[9]),newData[9]=null==arity?isBindKey?0:func.length:nativeMax(arity-length,0)||0,bitmask==BIND_FLAG)var result=createBindWrapper(newData[0],newData[2]);else result=bitmask!=PARTIAL_FLAG&&bitmask!=(BIND_FLAG|PARTIAL_FLAG)||newData[4].length?createHybridWrapper.apply(void 0,newData):createPartialWrapper.apply(void 0,newData);return(data?baseSetData:setData)(result,newData)}var baseSetData=_dereq_(141),createBindWrapper=_dereq_(154),createHybridWrapper=_dereq_(159),createPartialWrapper=_dereq_(160),getData=_dereq_(166),mergeData=_dereq_(180),setData=_dereq_(187),BIND_FLAG=1,BIND_KEY_FLAG=2,PARTIAL_FLAG=32,PARTIAL_RIGHT_FLAG=64,FUNC_ERROR_TEXT="Expected a function",nativeMax=Math.max;module.exports=createWrapper},{141:141,154:154,159:159,160:160,166:166,180:180,187:187}],163:[function(_dereq_,module,exports){function equalArrays(array,other,equalFunc,customizer,isLoose,stackA,stackB){var index=-1,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isLoose&&othLength>arrLength))return!1;for(;++index<arrLength;){var arrValue=array[index],othValue=other[index],result=customizer?customizer(isLoose?othValue:arrValue,isLoose?arrValue:othValue,index):void 0;if(void 0!==result){if(result)continue;return!1}if(isLoose){if(!arraySome(other,function(othValue){return arrValue===othValue||equalFunc(arrValue,othValue,customizer,isLoose,stackA,stackB)}))return!1}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,customizer,isLoose,stackA,stackB))return!1}return!0}var arraySome=_dereq_(110);module.exports=equalArrays},{110:110}],164:[function(_dereq_,module,exports){function equalByTag(object,other,tag){switch(tag){case boolTag:case dateTag:return+object==+other;case errorTag:return object.name==other.name&&object.message==other.message;case numberTag:return object!=+object?other!=+other:object==+other;case regexpTag:case stringTag:return object==other+""}return!1}var boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",numberTag="[object Number]",regexpTag="[object RegExp]",stringTag="[object String]";module.exports=equalByTag},{}],165:[function(_dereq_,module,exports){function equalObjects(object,other,equalFunc,customizer,isLoose,stackA,stackB){var objProps=keys(object),objLength=objProps.length;if(objLength!=keys(other).length&&!isLoose)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isLoose?key in other:hasOwnProperty.call(other,key)))return!1}for(var skipCtor=isLoose;++index<objLength;){key=objProps[index];var objValue=object[key],othValue=other[key],result=customizer?customizer(isLoose?othValue:objValue,isLoose?objValue:othValue,key):void 0;if(!(void 0===result?equalFunc(objValue,othValue,customizer,isLoose,stackA,stackB):result))return!1;skipCtor||(skipCtor="constructor"==key)}if(!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;if(objCtor!=othCtor&&"constructor"in object&&"constructor"in other&&!("function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor))return!1}return!0}var keys=_dereq_(203),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;module.exports=equalObjects},{203:203}],166:[function(_dereq_,module,exports){var metaMap=_dereq_(181),noop=_dereq_(210),getData=metaMap?function(func){return metaMap.get(func)}:noop;module.exports=getData},{181:181,210:210}],167:[function(_dereq_,module,exports){function getFuncName(func){for(var result=func.name+"",array=realNames[result],length=array?array.length:0;length--;){var data=array[length],otherFunc=data.func;if(null==otherFunc||otherFunc==func)return data.name}return result}var realNames=_dereq_(184);module.exports=getFuncName},{184:184}],168:[function(_dereq_,module,exports){var baseProperty=_dereq_(138),getLength=baseProperty("length");module.exports=getLength},{138:138}],169:[function(_dereq_,module,exports){function getMatchData(object){for(var result=pairs(object),length=result.length;length--;)result[length][2]=isStrictComparable(result[length][1]);return result}var isStrictComparable=_dereq_(179),pairs=_dereq_(207);module.exports=getMatchData},{179:179,207:207}],170:[function(_dereq_,module,exports){function getNative(object,key){var value=null==object?void 0:object[key];return isNative(value)?value:void 0}var isNative=_dereq_(195);module.exports=getNative},{195:195}],171:[function(_dereq_,module,exports){function indexOfNaN(array,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?0:-1);fromRight?index--:++index<length;){var other=array[index];if(other!==other)return index}return-1}module.exports=indexOfNaN},{}],172:[function(_dereq_,module,exports){function isArrayLike(value){return null!=value&&isLength(getLength(value))}var getLength=_dereq_(168),isLength=_dereq_(177);module.exports=isArrayLike},{168:168,177:177}],173:[function(_dereq_,module,exports){function isIndex(value,length){return value="number"==typeof value||reIsUint.test(value)?+value:-1,length=null==length?MAX_SAFE_INTEGER:length,value>-1&&value%1==0&&value<length}var reIsUint=/^\d+$/,MAX_SAFE_INTEGER=9007199254740991;module.exports=isIndex},{}],174:[function(_dereq_,module,exports){function isIterateeCall(value,index,object){if(!isObject(object))return!1;var type=typeof index;if("number"==type?isArrayLike(object)&&isIndex(index,object.length):"string"==type&&index in object){var other=object[index];return value===value?value===other:other!==other}return!1}var isArrayLike=_dereq_(172),isIndex=_dereq_(173),isObject=_dereq_(197);module.exports=isIterateeCall},{172:172,173:173,197:197}],175:[function(_dereq_,module,exports){function isKey(value,object){var type=typeof value;return!!("string"==type&&reIsPlainProp.test(value)||"number"==type)||!isArray(value)&&(!reIsDeepProp.test(value)||null!=object&&value in toObject(object))}var isArray=_dereq_(193),toObject=_dereq_(189),reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;module.exports=isKey},{189:189,193:193}],176:[function(_dereq_,module,exports){function isLaziable(func){var funcName=getFuncName(func),other=lodash[funcName];if("function"!=typeof other||!(funcName in LazyWrapper.prototype))return!1;if(func===other)return!0;var data=getData(other);return!!data&&func===data[0]}var LazyWrapper=_dereq_(100),getData=_dereq_(166),getFuncName=_dereq_(167),lodash=_dereq_(86);module.exports=isLaziable},{100:100,166:166,167:167,86:86}],177:[function(_dereq_,module,exports){function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER}var MAX_SAFE_INTEGER=9007199254740991;module.exports=isLength},{}],178:[function(_dereq_,module,exports){function isObjectLike(value){return!!value&&"object"==typeof value}module.exports=isObjectLike},{}],179:[function(_dereq_,module,exports){function isStrictComparable(value){return value===value&&!isObject(value)}var isObject=_dereq_(197);module.exports=isStrictComparable},{197:197}],180:[function(_dereq_,module,exports){function mergeData(data,source){var bitmask=data[1],srcBitmask=source[1],newBitmask=bitmask|srcBitmask,isCommon=newBitmask<ARY_FLAG,isCombo=srcBitmask==ARY_FLAG&&bitmask==CURRY_FLAG||srcBitmask==ARY_FLAG&&bitmask==REARG_FLAG&&data[7].length<=source[8]||srcBitmask==(ARY_FLAG|REARG_FLAG)&&bitmask==CURRY_FLAG;if(!isCommon&&!isCombo)return data;srcBitmask&BIND_FLAG&&(data[2]=source[2],newBitmask|=bitmask&BIND_FLAG?0:CURRY_BOUND_FLAG);var value=source[3];if(value){var partials=data[3];data[3]=partials?composeArgs(partials,value,source[4]):arrayCopy(value),data[4]=partials?replaceHolders(data[3],PLACEHOLDER):arrayCopy(source[4])}return value=source[5],value&&(partials=data[5],data[5]=partials?composeArgsRight(partials,value,source[6]):arrayCopy(value),data[6]=partials?replaceHolders(data[5],PLACEHOLDER):arrayCopy(source[6])),value=source[7],value&&(data[7]=arrayCopy(value)),srcBitmask&ARY_FLAG&&(data[8]=null==data[8]?source[8]:nativeMin(data[8],source[8])),null==data[9]&&(data[9]=source[9]),data[0]=source[0],data[1]=newBitmask,data}var arrayCopy=_dereq_(103),composeArgs=_dereq_(148),composeArgsRight=_dereq_(149),replaceHolders=_dereq_(186),BIND_FLAG=1,CURRY_BOUND_FLAG=4,CURRY_FLAG=8,ARY_FLAG=128,REARG_FLAG=256,PLACEHOLDER="__lodash_placeholder__",nativeMin=Math.min;module.exports=mergeData},{103:103,148:148,149:149,186:186}],181:[function(_dereq_,module,exports){(function(global){var getNative=_dereq_(170),WeakMap=getNative(global,"WeakMap"),metaMap=WeakMap&&new WeakMap;module.exports=metaMap}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{170:170}],182:[function(_dereq_,module,exports){function pickByArray(object,props){object=toObject(object);for(var index=-1,length=props.length,result={};++index<length;){var key=props[index];key in object&&(result[key]=object[key])}return result}var toObject=_dereq_(189);module.exports=pickByArray},{189:189}],183:[function(_dereq_,module,exports){function pickByCallback(object,predicate){var result={};return baseForIn(object,function(value,key,object){predicate(value,key,object)&&(result[key]=value)}),result}var baseForIn=_dereq_(125);module.exports=pickByCallback},{125:125}],184:[function(_dereq_,module,exports){var realNames={};module.exports=realNames},{}],185:[function(_dereq_,module,exports){function reorder(array,indexes){for(var arrLength=array.length,length=nativeMin(indexes.length,arrLength),oldArray=arrayCopy(array);length--;){var index=indexes[length];array[length]=isIndex(index,arrLength)?oldArray[index]:void 0}return array}var arrayCopy=_dereq_(103),isIndex=_dereq_(173),nativeMin=Math.min;module.exports=reorder},{103:103,173:173}],186:[function(_dereq_,module,exports){function replaceHolders(array,placeholder){for(var index=-1,length=array.length,resIndex=-1,result=[];++index<length;)array[index]===placeholder&&(array[index]=PLACEHOLDER,result[++resIndex]=index);return result}var PLACEHOLDER="__lodash_placeholder__";module.exports=replaceHolders},{}],187:[function(_dereq_,module,exports){var baseSetData=_dereq_(141),now=_dereq_(95),setData=function(){var count=0,lastCalled=0;return function(key,value){var stamp=now(),remaining=16-(stamp-lastCalled);if(lastCalled=stamp,remaining>0){if(++count>=150)return key}else count=0;return baseSetData(key,value)}}();module.exports=setData},{141:141,95:95}],188:[function(_dereq_,module,exports){function shimKeys(object){for(var props=keysIn(object),propsLength=props.length,length=propsLength&&object.length,allowIndexes=!!length&&isLength(length)&&(isArray(object)||isArguments(object)),index=-1,result=[];++index<propsLength;){var key=props[index];(allowIndexes&&isIndex(key,length)||hasOwnProperty.call(object,key))&&result.push(key)}return result}var isArguments=_dereq_(192),isArray=_dereq_(193),isIndex=_dereq_(173),isLength=_dereq_(177),keysIn=_dereq_(204),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;module.exports=shimKeys},{173:173,177:177,192:192,193:193,204:204}],189:[function(_dereq_,module,exports){function toObject(value){return isObject(value)?value:Object(value)}var isObject=_dereq_(197);module.exports=toObject},{197:197}],190:[function(_dereq_,module,exports){function toPath(value){if(isArray(value))return value;var result=[];return baseToString(value).replace(rePropName,function(match,number,quote,string){result.push(quote?string.replace(reEscapeChar,"$1"):number||match)}),result}var baseToString=_dereq_(144),isArray=_dereq_(193),rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,reEscapeChar=/\\(\\)?/g;module.exports=toPath},{144:144,193:193}],191:[function(_dereq_,module,exports){function wrapperClone(wrapper){return wrapper instanceof LazyWrapper?wrapper.clone():new LodashWrapper(wrapper.__wrapped__,wrapper.__chain__,arrayCopy(wrapper.__actions__))}var LazyWrapper=_dereq_(100),LodashWrapper=_dereq_(101),arrayCopy=_dereq_(103);module.exports=wrapperClone},{100:100,101:101,103:103}],192:[function(_dereq_,module,exports){function isArguments(value){return isObjectLike(value)&&isArrayLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")}var isArrayLike=_dereq_(172),isObjectLike=_dereq_(178),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,propertyIsEnumerable=objectProto.propertyIsEnumerable;module.exports=isArguments},{172:172,178:178}],193:[function(_dereq_,module,exports){var getNative=_dereq_(170),isLength=_dereq_(177),isObjectLike=_dereq_(178),objectProto=Object.prototype,objToString=objectProto.toString,nativeIsArray=getNative(Array,"isArray"),isArray=nativeIsArray||function(value){return isObjectLike(value)&&isLength(value.length)&&"[object Array]"==objToString.call(value)};module.exports=isArray},{170:170,177:177,178:178}],194:[function(_dereq_,module,exports){function isFunction(value){return isObject(value)&&objToString.call(value)==funcTag}var isObject=_dereq_(197),funcTag="[object Function]",objectProto=Object.prototype,objToString=objectProto.toString;module.exports=isFunction},{197:197}],195:[function(_dereq_,module,exports){function isNative(value){return null!=value&&(isFunction(value)?reIsNative.test(fnToString.call(value)):isObjectLike(value)&&reIsHostCtor.test(value))}var isFunction=_dereq_(194),isObjectLike=_dereq_(178),reIsHostCtor=/^\[object .+?Constructor\]$/,objectProto=Object.prototype,fnToString=Function.prototype.toString,hasOwnProperty=objectProto.hasOwnProperty,reIsNative=RegExp("^"+fnToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");module.exports=isNative},{178:178,194:194}],196:[function(_dereq_,module,exports){function isNumber(value){return"number"==typeof value||isObjectLike(value)&&objToString.call(value)==numberTag}var isObjectLike=_dereq_(178),numberTag="[object Number]",objectProto=Object.prototype,objToString=objectProto.toString;module.exports=isNumber},{178:178}],197:[function(_dereq_,module,exports){function isObject(value){var type=typeof value;return!!value&&("object"==type||"function"==type)}module.exports=isObject},{}],198:[function(_dereq_,module,exports){function isPlainObject(value){var Ctor;if(!isObjectLike(value)||objToString.call(value)!=objectTag||isArguments(value)||!hasOwnProperty.call(value,"constructor")&&"function"==typeof(Ctor=value.constructor)&&!(Ctor instanceof Ctor))return!1;var result;return baseForIn(value,function(subValue,key){result=key}),void 0===result||hasOwnProperty.call(value,result)}var baseForIn=_dereq_(125),isArguments=_dereq_(192),isObjectLike=_dereq_(178),objectTag="[object Object]",objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,objToString=objectProto.toString;module.exports=isPlainObject},{125:125,178:178,192:192}],199:[function(_dereq_,module,exports){function isString(value){return"string"==typeof value||isObjectLike(value)&&objToString.call(value)==stringTag}var isObjectLike=_dereq_(178),stringTag="[object String]",objectProto=Object.prototype,objToString=objectProto.toString;module.exports=isString},{178:178}],200:[function(_dereq_,module,exports){function isTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[objToString.call(value)]}var isLength=_dereq_(177),isObjectLike=_dereq_(178),typedArrayTags={};typedArrayTags["[object Float32Array]"]=typedArrayTags["[object Float64Array]"]=typedArrayTags["[object Int8Array]"]=typedArrayTags["[object Int16Array]"]=typedArrayTags["[object Int32Array]"]=typedArrayTags["[object Uint8Array]"]=typedArrayTags["[object Uint8ClampedArray]"]=typedArrayTags["[object Uint16Array]"]=typedArrayTags["[object Uint32Array]"]=!0,typedArrayTags["[object Arguments]"]=typedArrayTags["[object Array]"]=typedArrayTags["[object ArrayBuffer]"]=typedArrayTags["[object Boolean]"]=typedArrayTags["[object Date]"]=typedArrayTags["[object Error]"]=typedArrayTags["[object Function]"]=typedArrayTags["[object Map]"]=typedArrayTags["[object Number]"]=typedArrayTags["[object Object]"]=typedArrayTags["[object RegExp]"]=typedArrayTags["[object Set]"]=typedArrayTags["[object String]"]=typedArrayTags["[object WeakMap]"]=!1;var objectProto=Object.prototype,objToString=objectProto.toString;module.exports=isTypedArray},{177:177,178:178}],201:[function(_dereq_,module,exports){function toPlainObject(value){return baseCopy(value,keysIn(value))}var baseCopy=_dereq_(114),keysIn=_dereq_(204);module.exports=toPlainObject},{114:114,204:204}],202:[function(_dereq_,module,exports){var assignWith=_dereq_(111),baseAssign=_dereq_(112),createAssigner=_dereq_(151),assign=createAssigner(function(object,source,customizer){return customizer?assignWith(object,source,customizer):baseAssign(object,source)});module.exports=assign},{111:111,112:112,151:151}],203:[function(_dereq_,module,exports){var getNative=_dereq_(170),isArrayLike=_dereq_(172),isObject=_dereq_(197),shimKeys=_dereq_(188),nativeKeys=getNative(Object,"keys"),keys=nativeKeys?function(object){var Ctor=null==object?void 0:object.constructor;return"function"==typeof Ctor&&Ctor.prototype===object||"function"!=typeof object&&isArrayLike(object)?shimKeys(object):isObject(object)?nativeKeys(object):[]}:shimKeys;module.exports=keys},{170:170,172:172,188:188,197:197}],204:[function(_dereq_,module,exports){function keysIn(object){if(null==object)return[];isObject(object)||(object=Object(object));var length=object.length;length=length&&isLength(length)&&(isArray(object)||isArguments(object))&&length||0;for(var Ctor=object.constructor,index=-1,isProto="function"==typeof Ctor&&Ctor.prototype===object,result=Array(length),skipIndexes=length>0;++index<length;)result[index]=index+"";for(var key in object)skipIndexes&&isIndex(key,length)||"constructor"==key&&(isProto||!hasOwnProperty.call(object,key))||result.push(key);return result}var isArguments=_dereq_(192),isArray=_dereq_(193),isIndex=_dereq_(173),isLength=_dereq_(177),isObject=_dereq_(197),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;module.exports=keysIn},{173:173,177:177,192:192,193:193,197:197}],205:[function(_dereq_,module,exports){var baseMerge=_dereq_(136),createAssigner=_dereq_(151),merge=createAssigner(baseMerge);module.exports=merge},{136:136,151:151}],206:[function(_dereq_,module,exports){var arrayMap=_dereq_(107),baseDifference=_dereq_(117),baseFlatten=_dereq_(123),bindCallback=_dereq_(145),keysIn=_dereq_(204),pickByArray=_dereq_(182),pickByCallback=_dereq_(183),restParam=_dereq_(99),omit=restParam(function(object,props){if(null==object)return{};if("function"!=typeof props[0]){var props=arrayMap(baseFlatten(props),String);return pickByArray(object,baseDifference(keysIn(object),props))}var predicate=bindCallback(props[0],props[1],3);return pickByCallback(object,function(value,key,object){return!predicate(value,key,object)})});module.exports=omit},{107:107,117:117,123:123,145:145,182:182,183:183,204:204,99:99}],207:[function(_dereq_,module,exports){function pairs(object){object=toObject(object);for(var index=-1,props=keys(object),length=props.length,result=Array(length);++index<length;){var key=props[index];result[index]=[key,object[key]]}return result}var keys=_dereq_(203),toObject=_dereq_(189);module.exports=pairs},{189:189,203:203}],208:[function(_dereq_,module,exports){var baseFlatten=_dereq_(123),bindCallback=_dereq_(145),pickByArray=_dereq_(182),pickByCallback=_dereq_(183),restParam=_dereq_(99),pick=restParam(function(object,props){return null==object?{}:"function"==typeof props[0]?pickByCallback(object,bindCallback(props[0],props[1],3)):pickByArray(object,baseFlatten(props))});module.exports=pick},{123:123,145:145,182:182,183:183,99:99}],209:[function(_dereq_,module,exports){function identity(value){return value}module.exports=identity},{}],210:[function(_dereq_,module,exports){function noop(){}module.exports=noop},{}],211:[function(_dereq_,module,exports){function property(path){return isKey(path)?baseProperty(path):basePropertyDeep(path)}var baseProperty=_dereq_(138),basePropertyDeep=_dereq_(139),isKey=_dereq_(175);module.exports=property},{138:138,139:139,175:175}],212:[function(_dereq_,module,exports){module.exports=function(el,name,val){return 2==arguments.length?el.getAttribute(name):null===val?el.removeAttribute(name):(el.setAttribute(name,val),el)}},{}],213:[function(_dereq_,module,exports){module.exports=_dereq_(29)},{29:29}],214:[function(_dereq_,module,exports){module.exports=function(el){for(var c;el.childNodes.length;)c=el.childNodes[0],el.removeChild(c);return el}},{}],215:[function(_dereq_,module,exports){module.exports=_dereq_(30)},{30:30}],216:[function(_dereq_,module,exports){module.exports=_dereq_(77)},{77:77}],217:[function(_dereq_,module,exports){module.exports=_dereq_(33)},{33:33}],218:[function(_dereq_,module,exports){module.exports=_dereq_(36)},{36:36}],219:[function(_dereq_,module,exports){module.exports=function(el){el.parentNode&&el.parentNode.removeChild(el)}},{}],220:[function(_dereq_,module,exports){"use strict";function capitalize(string){return string.charAt(0).toUpperCase()+string.slice(1)}function lower(string){return string.charAt(0).toLowerCase()+string.slice(1)}function hasLowerCaseAlias(pkg){return pkg.xml&&"lowerCase"===pkg.xml.tagAlias}function serializeFormat(element){return element.xml&&element.xml.serialize}module.exports.aliasToName=function(alias,pkg){return hasLowerCaseAlias(pkg)?capitalize(alias):alias},module.exports.nameToAlias=function(name,pkg){return hasLowerCaseAlias(pkg)?lower(name):name},module.exports.DEFAULT_NS_MAP={xsi:"http://www.w3.org/2001/XMLSchema-instance"};var XSI_TYPE=module.exports.XSI_TYPE="xsi:type";module.exports.serializeAsType=function(element){return serializeFormat(element)===XSI_TYPE},module.exports.serializeAsProperty=function(element){return"property"===serializeFormat(element)}},{}],221:[function(_dereq_,module,exports){"use strict";function parseNodeAttributes(node){var nodeAttrs=node.attributes;return reduce(nodeAttrs,function(result,v,k){var name,ns;return v.local?(ns=parseNameNs(v.name,v.prefix),name=ns.name):name=v.prefix,result[name]=v.value,result},{})}function normalizeType(node,attr,model){var typePrefix,nameNs=parseNameNs(attr.value),uri=node.ns[nameNs.prefix||""],localName=nameNs.localName,pkg=uri&&model.getPackage(uri);pkg&&(typePrefix=pkg.xml&&pkg.xml.typePrefix,typePrefix&&0===localName.indexOf(typePrefix)&&(localName=localName.slice(typePrefix.length)),attr.value=pkg.prefix+":"+localName)}function normalizeNamespaces(node,model,defaultNsUri){var uri,prefix;if(uri=node.uri||defaultNsUri){var pkg=model.getPackage(uri);prefix=pkg?pkg.prefix:node.prefix,node.prefix=prefix,node.uri=uri}forEach(node.attributes,function(attr){attr.uri===XSI_URI&&"type"===attr.local&&normalizeType(node,attr,model),normalizeNamespaces(attr,model,null)})}function error(message){return new Error(message)}function getModdleDescriptor(element){return element.$descriptor}function Context(options){assign(this,options),this.elementsById={},this.references=[],this.warnings=[],this.addReference=function(reference){this.references.push(reference)},this.addElement=function(element){if(!element)throw error("expected element");var id,elementsById=this.elementsById,descriptor=getModdleDescriptor(element),idProperty=descriptor.idProperty;if(idProperty&&(id=element.get(idProperty.name))){if(elementsById[id])throw error("duplicate ID <"+id+">");elementsById[id]=element}},this.addWarning=function(warning){this.warnings.push(warning)}}function BaseHandler(){}function NoopHandler(){}function BodyHandler(){}function ReferenceHandler(property,context){this.property=property,this.context=context}function ValueHandler(propertyDesc,element){this.element=element,this.propertyDesc=propertyDesc}function BaseElementHandler(){}function ElementHandler(model,type,context){this.model=model,this.type=model.getType(type),this.context=context}function GenericElementHandler(model,type,context){this.model=model,this.context=context}function XMLReader(options){options instanceof Moddle&&(options={model:options}),assign(this,{lax:!1},options)}var reduce=_dereq_(93),forEach=_dereq_(90),find=_dereq_(89),assign=_dereq_(202),defer=_dereq_(98),Stack=_dereq_(254),SaxParser=_dereq_(251).parser,Moddle=_dereq_(223),parseNameNs=_dereq_(228).parseName,Types=_dereq_(231),coerceType=Types.coerceType,isSimpleType=Types.isSimple,common=_dereq_(220),XSI_TYPE=common.XSI_TYPE,XSI_URI=common.DEFAULT_NS_MAP.xsi,serializeAsType=common.serializeAsType,aliasToName=common.aliasToName;BaseHandler.prototype.handleEnd=function(){},BaseHandler.prototype.handleText=function(){},BaseHandler.prototype.handleNode=function(){},NoopHandler.prototype=Object.create(BaseHandler.prototype),NoopHandler.prototype.handleNode=function(){return this},BodyHandler.prototype=Object.create(BaseHandler.prototype),BodyHandler.prototype.handleText=function(text){this.body=(this.body||"")+text},ReferenceHandler.prototype=Object.create(BodyHandler.prototype),ReferenceHandler.prototype.handleNode=function(node){if(this.element)throw error("expected no sub nodes");return this.element=this.createReference(node),this},ReferenceHandler.prototype.handleEnd=function(){this.element.id=this.body},ReferenceHandler.prototype.createReference=function(node){return{property:this.property.ns.name,id:""}},ValueHandler.prototype=Object.create(BodyHandler.prototype),ValueHandler.prototype.handleEnd=function(){var value=this.body||"",element=this.element,propertyDesc=this.propertyDesc;value=coerceType(propertyDesc.type,value),propertyDesc.isMany?element.get(propertyDesc.name).push(value):element.set(propertyDesc.name,value)},BaseElementHandler.prototype=Object.create(BodyHandler.prototype),BaseElementHandler.prototype.handleNode=function(node){var parser=this,element=this.element;return element?parser=this.handleChild(node):(element=this.element=this.createElement(node),this.context.addElement(element)),parser},ElementHandler.prototype=Object.create(BaseElementHandler.prototype),ElementHandler.prototype.addReference=function(reference){this.context.addReference(reference)},ElementHandler.prototype.handleEnd=function(){var value=this.body,element=this.element,descriptor=getModdleDescriptor(element),bodyProperty=descriptor.bodyProperty;bodyProperty&&void 0!==value&&(value=coerceType(bodyProperty.type,value),element.set(bodyProperty.name,value))},ElementHandler.prototype.createElement=function(node){var attributes=parseNodeAttributes(node),Type=this.type,descriptor=getModdleDescriptor(Type),context=this.context,instance=new Type({});return forEach(attributes,function(value,name){var values,prop=descriptor.propertiesByName[name];prop&&prop.isReference?prop.isMany?(values=value.split(" "),forEach(values,function(v){context.addReference({element:instance,property:prop.ns.name,id:v})})):context.addReference({element:instance,property:prop.ns.name,id:value}):(prop&&(value=coerceType(prop.type,value)),instance.set(name,value))}),instance},ElementHandler.prototype.getPropertyForNode=function(node){var elementTypeName,elementType,typeAnnotation,nameNs=parseNameNs(node.local,node.prefix),type=this.type,model=this.model,descriptor=getModdleDescriptor(type),propertyName=nameNs.name,property=descriptor.propertiesByName[propertyName];if(property)return serializeAsType(property)&&(typeAnnotation=node.attributes[XSI_TYPE])?(elementTypeName=typeAnnotation.value,elementType=model.getType(elementTypeName),assign({},property,{effectiveType:getModdleDescriptor(elementType).name})):property;if(model.getPackage(nameNs.prefix)){if(elementTypeName=nameNs.prefix+":"+aliasToName(nameNs.localName,descriptor.$pkg),elementType=model.getType(elementTypeName),property=find(descriptor.properties,function(p){return!p.isVirtual&&!p.isReference&&!p.isAttribute&&elementType.hasType(p.type)}))return assign({},property,{effectiveType:getModdleDescriptor(elementType).name})}else if(property=find(descriptor.properties,function(p){return!p.isReference&&!p.isAttribute&&"Element"===p.type}))return property;throw error("unrecognized element <"+nameNs.name+">")},ElementHandler.prototype.toString=function(){return"ElementDescriptor["+getModdleDescriptor(this.type).name+"]"},ElementHandler.prototype.valueHandler=function(propertyDesc,element){return new ValueHandler(propertyDesc,element)},ElementHandler.prototype.referenceHandler=function(propertyDesc){return new ReferenceHandler(propertyDesc,this.context)},ElementHandler.prototype.handler=function(type){return"Element"===type?new GenericElementHandler(this.model,type,this.context):new ElementHandler(this.model,type,this.context)},ElementHandler.prototype.handleChild=function(node){var propertyDesc,type,element,childHandler;if(propertyDesc=this.getPropertyForNode(node),element=this.element,type=propertyDesc.effectiveType||propertyDesc.type,isSimpleType(type))return this.valueHandler(propertyDesc,element);childHandler=propertyDesc.isReference?this.referenceHandler(propertyDesc).handleNode(node):this.handler(type).handleNode(node);var newElement=childHandler.element;return void 0!==newElement&&(propertyDesc.isMany?element.get(propertyDesc.name).push(newElement):element.set(propertyDesc.name,newElement),propertyDesc.isReference?(assign(newElement,{element:element}),this.context.addReference(newElement)):newElement.$parent=element),childHandler},GenericElementHandler.prototype=Object.create(BaseElementHandler.prototype),GenericElementHandler.prototype.createElement=function(node){var name=node.name,prefix=node.prefix,uri=node.ns[prefix],attributes=node.attributes;return this.model.createAny(name,uri,attributes)},GenericElementHandler.prototype.handleChild=function(node){var children,handler=new GenericElementHandler(this.model,"Element",this.context).handleNode(node),element=this.element,newElement=handler.element;return void 0!==newElement&&(children=element.$children=element.$children||[],children.push(newElement),newElement.$parent=element),handler},GenericElementHandler.prototype.handleText=function(text){this.body=this.body||""+text},GenericElementHandler.prototype.handleEnd=function(){this.body&&(this.element.$body=this.body)},XMLReader.prototype.fromXML=function(xml,options,done){function resolveReferences(){var i,r,elementsById=context.elementsById,references=context.references;for(i=0;r=references[i];i++){
var element=r.element,reference=elementsById[r.id],property=getModdleDescriptor(element).propertiesByName[r.property];if(reference||context.addWarning({message:"unresolved reference <"+r.id+">",element:r.element,property:r.property,value:r.id}),property.isMany){var collection=element.get(property.name),idx=collection.indexOf(r);-1===idx&&(idx=collection.length),reference?collection[idx]=reference:collection.splice(idx,1)}else element.set(property.name,reference)}}function handleClose(tagName){stack.pop().handleEnd()}function handleOpen(node){var handler=stack.peek();normalizeNamespaces(node,model);try{stack.push(handler.handleNode(node))}catch(e){var line=this.line,column=this.column,message="unparsable content <"+node.name+"> detected\n\tline: "+line+"\n\tcolumn: "+column+"\n\tnested error: "+e.message;if(!lax)throw console.error("could not parse document"),console.error(e),error(message);context.addWarning({message:message,error:e}),console.warn("could not parse node"),console.warn(e),stack.push(new NoopHandler)}}function handleText(text){stack.peek().handleText(text)}var rootHandler=options.rootHandler;options instanceof ElementHandler?(rootHandler=options,options={}):"string"==typeof options?(rootHandler=this.handler(options),options={}):"string"==typeof rootHandler&&(rootHandler=this.handler(rootHandler));var model=this.model,lax=this.lax,context=new Context(assign({},options,{rootHandler:rootHandler})),parser=new SaxParser(!0,{xmlns:!0,trim:!0}),stack=new Stack;rootHandler.context=context,stack.push(rootHandler),parser.onopentag=handleOpen,parser.oncdata=parser.ontext=handleText,parser.onclosetag=handleClose,parser.onend=resolveReferences,defer(function(){var error;try{parser.write(xml).close()}catch(e){error=e}done(error,error?void 0:rootHandler.element,context)})},XMLReader.prototype.handler=function(name){return new ElementHandler(this.model,name)},module.exports=XMLReader,module.exports.ElementHandler=ElementHandler},{202:202,220:220,223:223,228:228,231:231,251:251,254:254,89:89,90:90,93:93,98:98}],222:[function(_dereq_,module,exports){"use strict";function inherits(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}function nsName(ns){return isString(ns)?ns:(ns.prefix?ns.prefix+":":"")+ns.localName}function getNsAttrs(namespaces){function isUsed(ns){return namespaces.used[ns.uri]}function toAttr(ns){return{name:"xmlns"+(ns.prefix?":"+ns.prefix:""),value:ns.uri}}var allNs=[].concat(namespaces.wellknown,namespaces.custom);return map(filter(allNs,isUsed),toAttr)}function getElementNs(ns,descriptor){return descriptor.isGeneric?descriptor.name:assign({localName:nameToAlias(descriptor.ns.localName,descriptor.$pkg)},ns)}function getPropertyNs(ns,descriptor){return assign({localName:descriptor.ns.localName},ns)}function getSerializableProperties(element){var descriptor=element.$descriptor;return filter(descriptor.properties,function(p){var name=p.name;if(p.isVirtual)return!1;if(!element.hasOwnProperty(name))return!1;var value=element[name];return value!==p.default&&(null!==value&&(!p.isMany||value.length))})}function escapeAttr(str){return str=isString(str)?str:""+str,str.replace(ESCAPE_CHARS,function(str){return"&#"+ESCAPE_MAP[str]+";"})}function filterAttributes(props){return filter(props,function(p){return p.isAttr})}function filterContained(props){return filter(props,function(p){return!p.isAttr})}function ReferenceSerializer(parent,ns){this.ns=ns}function BodySerializer(){}function ValueSerializer(ns){this.ns=ns}function ElementSerializer(parent,ns){this.body=[],this.attrs=[],this.parent=parent,this.ns=ns}function TypeSerializer(parent,ns){ElementSerializer.call(this,parent,ns)}function SavingWriter(){this.value="",this.write=function(str){this.value+=str}}function FormatingWriter(out,format){var indent=[""];this.append=function(str){return out.write(str),this},this.appendNewLine=function(){return format&&out.write("\n"),this},this.appendIndent=function(){return format&&out.write(indent.join("  ")),this},this.indent=function(){return indent.push(""),this},this.unindent=function(){return indent.pop(),this}}function XMLWriter(options){function toXML(tree,writer){var internalWriter=writer||new SavingWriter,formatingWriter=new FormatingWriter(internalWriter,options.format);if(options.preamble&&formatingWriter.append(XML_PREAMBLE),(new ElementSerializer).build(tree).serializeTo(formatingWriter),!writer)return internalWriter.value}return options=assign({format:!1,preamble:!0},options||{}),{toXML:toXML}}var map=_dereq_(92),forEach=_dereq_(90),isString=_dereq_(199),filter=_dereq_(88),assign=_dereq_(202),Types=_dereq_(231),parseNameNs=_dereq_(228).parseName,common=_dereq_(220),nameToAlias=common.nameToAlias,serializeAsType=common.serializeAsType,serializeAsProperty=common.serializeAsProperty,XML_PREAMBLE='<?xml version="1.0" encoding="UTF-8"?>\n',ESCAPE_CHARS=/(<|>|'|"|&|\n\r|\n)/g,DEFAULT_NS_MAP=common.DEFAULT_NS_MAP,XSI_TYPE=common.XSI_TYPE,ESCAPE_MAP={"\n":"10","\n\r":"10",'"':"34","'":"39","<":"60",">":"62","&":"38"};ReferenceSerializer.prototype.build=function(element){return this.element=element,this},ReferenceSerializer.prototype.serializeTo=function(writer){writer.appendIndent().append("<"+nsName(this.ns)+">"+this.element.id+"</"+nsName(this.ns)+">").appendNewLine()},BodySerializer.prototype.serializeValue=BodySerializer.prototype.serializeTo=function(writer){var escape=this.escape;escape&&writer.append("<![CDATA["),writer.append(this.value),escape&&writer.append("]]>")},BodySerializer.prototype.build=function(prop,value){return this.value=value,"String"===prop.type&&-1!==value.search(ESCAPE_CHARS)&&(this.escape=!0),this},inherits(ValueSerializer,BodySerializer),ValueSerializer.prototype.serializeTo=function(writer){writer.appendIndent().append("<"+nsName(this.ns)+">"),this.serializeValue(writer),writer.append("</"+nsName(this.ns)+">").appendNewLine()},ElementSerializer.prototype.build=function(element){this.element=element;var otherAttrs=this.parseNsAttributes(element);if(this.ns||(this.ns=this.nsTagName(element.$descriptor)),element.$descriptor.isGeneric)this.parseGeneric(element);else{var properties=getSerializableProperties(element);this.parseAttributes(filterAttributes(properties)),this.parseContainments(filterContained(properties)),this.parseGenericAttributes(element,otherAttrs)}return this},ElementSerializer.prototype.nsTagName=function(descriptor){return getElementNs(this.logNamespaceUsed(descriptor.ns),descriptor)},ElementSerializer.prototype.nsPropertyTagName=function(descriptor){return getPropertyNs(this.logNamespaceUsed(descriptor.ns),descriptor)},ElementSerializer.prototype.isLocalNs=function(ns){return ns.uri===this.ns.uri},ElementSerializer.prototype.nsAttributeName=function(element){var ns;if(ns=isString(element)?parseNameNs(element):element.ns,element.inherited)return{localName:ns.localName};var effectiveNs=this.logNamespaceUsed(ns);return this.isLocalNs(effectiveNs)?{localName:ns.localName}:assign({localName:ns.localName},effectiveNs)},ElementSerializer.prototype.parseGeneric=function(element){var self=this,body=this.body,attrs=this.attrs;forEach(element,function(val,key){"$body"===key?body.push((new BodySerializer).build({type:"String"},val)):"$children"===key?forEach(val,function(child){body.push(new ElementSerializer(self).build(child))}):0!==key.indexOf("$")&&attrs.push({name:key,value:escapeAttr(val)})})},ElementSerializer.prototype.parseNsAttributes=function(element){var self=this,genericAttrs=element.$attrs,model=element.$model,attributes=[];return forEach(genericAttrs,function(value,name){var ns,nameNs=parseNameNs(name);"xmlns"===nameNs.prefix&&(ns={prefix:nameNs.localName,uri:value}),nameNs.prefix||"xmlns"!==nameNs.localName||(ns={uri:value}),ns?model.getPackage(value)?self.logNamespace(ns,!0):self.logNamespaceUsed(ns):attributes.push({name:name,value:value})}),attributes},ElementSerializer.prototype.parseGenericAttributes=function(element,attributes){var self=this;forEach(attributes,function(attr){if(attr.name!==XSI_TYPE)try{self.addAttribute(self.nsAttributeName(attr.name),attr.value)}catch(e){console.warn("missing namespace information for ",attr.name,"=",attr.value,"on",element,e)}})},ElementSerializer.prototype.parseContainments=function(properties){var self=this,body=this.body,element=this.element;forEach(properties,function(p){var value=element.get(p.name),isReference=p.isReference,isMany=p.isMany,ns=self.nsPropertyTagName(p);if(isMany||(value=[value]),p.isBody)body.push((new BodySerializer).build(p,value[0]));else if(Types.isSimple(p.type))forEach(value,function(v){body.push(new ValueSerializer(ns).build(p,v))});else if(isReference)forEach(value,function(v){body.push(new ReferenceSerializer(self,ns).build(v))});else{var asType=serializeAsType(p),asProperty=serializeAsProperty(p);forEach(value,function(v){var serializer;serializer=asType?new TypeSerializer(self,ns):asProperty?new ElementSerializer(self,ns):new ElementSerializer(self),body.push(serializer.build(v))})}})},ElementSerializer.prototype.getNamespaces=function(){var namespaces=this.namespaces,parent=this.parent;return namespaces||(namespaces=this.namespaces=parent?parent.getNamespaces():{prefixMap:{},uriMap:{},used:{},wellknown:[],custom:[]}),namespaces},ElementSerializer.prototype.logNamespace=function(ns,wellknown){var namespaces=this.getNamespaces(),nsUri=ns.uri;return namespaces.uriMap[nsUri]||(namespaces.uriMap[nsUri]=ns,wellknown?namespaces.wellknown.push(ns):namespaces.custom.push(ns)),namespaces.prefixMap[ns.prefix]=nsUri,ns},ElementSerializer.prototype.logNamespaceUsed=function(ns){var element=this.element,model=element.$model,namespaces=this.getNamespaces(),prefix=ns.prefix,wellknownUri=DEFAULT_NS_MAP[prefix]||model&&(model.getPackage(prefix)||{}).uri,uri=ns.uri||namespaces.prefixMap[prefix]||wellknownUri;if(!uri)throw new Error("no namespace uri given for prefix <"+ns.prefix+">");return ns=namespaces.uriMap[uri],ns||(ns=this.logNamespace({prefix:prefix,uri:uri},wellknownUri)),namespaces.used[ns.uri]||(namespaces.used[ns.uri]=ns),ns},ElementSerializer.prototype.parseAttributes=function(properties){var self=this,element=this.element;forEach(properties,function(p){var value=element.get(p.name);if(p.isReference)if(p.isMany){var values=[];forEach(value,function(v){values.push(v.id)}),value=values.join(" ")}else value=value.id;self.addAttribute(self.nsAttributeName(p),value)})},ElementSerializer.prototype.addAttribute=function(name,value){var attrs=this.attrs;isString(value)&&(value=escapeAttr(value)),attrs.push({name:name,value:value})},ElementSerializer.prototype.serializeAttributes=function(writer){var attrs=this.attrs;!this.parent&&(attrs=getNsAttrs(this.namespaces).concat(attrs)),forEach(attrs,function(a){writer.append(" ").append(nsName(a.name)).append('="').append(a.value).append('"')})},ElementSerializer.prototype.serializeTo=function(writer){var firstBody=this.body[0],indent=firstBody&&firstBody.constructor!==BodySerializer;writer.appendIndent().append("<"+nsName(this.ns)),this.serializeAttributes(writer),writer.append(firstBody?">":" />"),firstBody&&(indent&&writer.appendNewLine().indent(),forEach(this.body,function(b){b.serializeTo(writer)}),indent&&writer.unindent().appendIndent(),writer.append("</"+nsName(this.ns)+">")),writer.appendNewLine()},inherits(TypeSerializer,ElementSerializer),TypeSerializer.prototype.build=function(element){var descriptor=element.$descriptor;this.element=element,this.typeNs=this.nsTagName(descriptor);var typeNs=this.typeNs,pkg=element.$model.getPackage(typeNs.uri),typePrefix=pkg.xml&&pkg.xml.typePrefix||"";return this.addAttribute(this.nsAttributeName(XSI_TYPE),(typeNs.prefix?typeNs.prefix+":":"")+typePrefix+descriptor.ns.localName),ElementSerializer.prototype.build.call(this,element)},TypeSerializer.prototype.isLocalNs=function(ns){return ns.uri===this.typeNs.uri},module.exports=XMLWriter},{199:199,202:202,220:220,228:228,231:231,88:88,90:90,92:92}],223:[function(_dereq_,module,exports){module.exports=_dereq_(227)},{227:227}],224:[function(_dereq_,module,exports){"use strict";function Base(){}Base.prototype.get=function(name){return this.$model.properties.get(this,name)},Base.prototype.set=function(name,value){this.$model.properties.set(this,name,value)},module.exports=Base},{}],225:[function(_dereq_,module,exports){"use strict";function DescriptorBuilder(nameNs){this.ns=nameNs,this.name=nameNs.name,this.allTypes=[],this.properties=[],this.propertiesByName={}}var pick=_dereq_(208),assign=_dereq_(202),forEach=_dereq_(90),parseNameNs=_dereq_(228).parseName;module.exports=DescriptorBuilder,DescriptorBuilder.prototype.build=function(){return pick(this,["ns","name","allTypes","properties","propertiesByName","bodyProperty","idProperty"])},DescriptorBuilder.prototype.addProperty=function(p,idx,validate){"boolean"==typeof idx&&(validate=idx,idx=void 0),this.addNamedProperty(p,!1!==validate);var properties=this.properties;void 0!==idx?properties.splice(idx,0,p):properties.push(p)},DescriptorBuilder.prototype.replaceProperty=function(oldProperty,newProperty,replace){var oldNameNs=oldProperty.ns,props=this.properties,propertiesByName=this.propertiesByName,rename=oldProperty.name!==newProperty.name;if(oldProperty.isId){if(!newProperty.isId)throw new Error("property <"+newProperty.ns.name+"> must be id property to refine <"+oldProperty.ns.name+">");this.setIdProperty(newProperty,!1)}if(oldProperty.isBody){if(!newProperty.isBody)throw new Error("property <"+newProperty.ns.name+"> must be body property to refine <"+oldProperty.ns.name+">");this.setBodyProperty(newProperty,!1)}var idx=props.indexOf(oldProperty);if(-1===idx)throw new Error("property <"+oldNameNs.name+"> not found in property list");props.splice(idx,1),this.addProperty(newProperty,replace?void 0:idx,rename),propertiesByName[oldNameNs.name]=propertiesByName[oldNameNs.localName]=newProperty},DescriptorBuilder.prototype.redefineProperty=function(p,targetPropertyName,replace){var nsPrefix=p.ns.prefix,parts=targetPropertyName.split("#"),name=parseNameNs(parts[0],nsPrefix),attrName=parseNameNs(parts[1],name.prefix).name,redefinedProperty=this.propertiesByName[attrName];if(!redefinedProperty)throw new Error("refined property <"+attrName+"> not found");this.replaceProperty(redefinedProperty,p,replace),delete p.redefines},DescriptorBuilder.prototype.addNamedProperty=function(p,validate){var ns=p.ns,propsByName=this.propertiesByName;validate&&(this.assertNotDefined(p,ns.name),this.assertNotDefined(p,ns.localName)),propsByName[ns.name]=propsByName[ns.localName]=p},DescriptorBuilder.prototype.removeNamedProperty=function(p){var ns=p.ns,propsByName=this.propertiesByName;delete propsByName[ns.name],delete propsByName[ns.localName]},DescriptorBuilder.prototype.setBodyProperty=function(p,validate){if(validate&&this.bodyProperty)throw new Error("body property defined multiple times (<"+this.bodyProperty.ns.name+">, <"+p.ns.name+">)");this.bodyProperty=p},DescriptorBuilder.prototype.setIdProperty=function(p,validate){if(validate&&this.idProperty)throw new Error("id property defined multiple times (<"+this.idProperty.ns.name+">, <"+p.ns.name+">)");this.idProperty=p},DescriptorBuilder.prototype.assertNotDefined=function(p,name){var propertyName=p.name,definedProperty=this.propertiesByName[propertyName];if(definedProperty)throw new Error("property <"+propertyName+"> already defined; override of <"+definedProperty.definedBy.ns.name+"#"+definedProperty.ns.name+"> by <"+p.definedBy.ns.name+"#"+p.ns.name+"> not allowed without redefines")},DescriptorBuilder.prototype.hasProperty=function(name){return this.propertiesByName[name]},DescriptorBuilder.prototype.addTrait=function(t,inherited){var allTypes=this.allTypes;-1===allTypes.indexOf(t)&&(forEach(t.properties,function(p){p=assign({},p,{name:p.ns.localName,inherited:inherited}),Object.defineProperty(p,"definedBy",{value:t});var replaces=p.replaces,redefines=p.redefines;replaces||redefines?this.redefineProperty(p,replaces||redefines,replaces):(p.isBody&&this.setBodyProperty(p),p.isId&&this.setIdProperty(p),this.addProperty(p))},this),allTypes.push(t))}},{202:202,208:208,228:228,90:90}],226:[function(_dereq_,module,exports){"use strict";function Factory(model,properties){this.model=model,this.properties=properties}var forEach=_dereq_(90),Base=_dereq_(224);module.exports=Factory,Factory.prototype.createType=function(descriptor){function ModdleElement(attrs){props.define(this,"$type",{value:name,enumerable:!0}),props.define(this,"$attrs",{value:{}}),props.define(this,"$parent",{writable:!0}),forEach(attrs,function(val,key){this.set(key,val)},this)}var model=this.model,props=this.properties,prototype=Object.create(Base.prototype);forEach(descriptor.properties,function(p){p.isMany||void 0===p.default||(prototype[p.name]=p.default)}),props.defineModel(prototype,model),props.defineDescriptor(prototype,descriptor);var name=descriptor.ns.name;return ModdleElement.prototype=prototype,ModdleElement.hasType=prototype.$instanceOf=this.model.hasType,props.defineModel(ModdleElement,model),props.defineDescriptor(ModdleElement,descriptor),ModdleElement}},{224:224,90:90}],227:[function(_dereq_,module,exports){"use strict";function Moddle(packages){this.properties=new Properties(this),this.factory=new Factory(this,this.properties),this.registry=new Registry(packages,this.properties),this.typeCache={}}var isString=_dereq_(199),isObject=_dereq_(197),forEach=_dereq_(90),find=_dereq_(89),Factory=_dereq_(226),Registry=_dereq_(230),Properties=_dereq_(229),parseNameNs=_dereq_(228).parseName;module.exports=Moddle,Moddle.prototype.create=function(descriptor,attrs){var Type=this.getType(descriptor);if(!Type)throw new Error("unknown type <"+descriptor+">");return new Type(attrs)},Moddle.prototype.getType=function(descriptor){var cache=this.typeCache,name=isString(descriptor)?descriptor:descriptor.ns.name,type=cache[name];return type||(descriptor=this.registry.getEffectiveDescriptor(name),type=cache[name]=this.factory.createType(descriptor)),type},Moddle.prototype.createAny=function(name,nsUri,properties){var nameNs=parseNameNs(name),element={$type:name},descriptor={name:name,isGeneric:!0,ns:{prefix:nameNs.prefix,localName:nameNs.localName,uri:nsUri}};return this.properties.defineDescriptor(element,descriptor),this.properties.defineModel(element,this),this.properties.define(element,"$parent",{enumerable:!1,writable:!0}),forEach(properties,function(a,key){isObject(a)&&void 0!==a.value?element[a.name]=a.value:element[key]=a}),element},Moddle.prototype.getPackage=function(uriOrPrefix){return this.registry.getPackage(uriOrPrefix)},Moddle.prototype.getPackages=function(){return this.registry.getPackages()},Moddle.prototype.getElementDescriptor=function(element){return element.$descriptor},Moddle.prototype.hasType=function(element,type){void 0===type&&(type=element,element=this);var descriptor=element.$model.getElementDescriptor(element);return!!find(descriptor.allTypes,function(t){return t.name===type})},Moddle.prototype.getPropertyDescriptor=function(element,property){return this.getElementDescriptor(element).propertiesByName[property]},Moddle.prototype.getTypeDescriptor=function(type){return this.registry.typeMap[type]}},{197:197,199:199,226:226,228:228,229:229,230:230,89:89,90:90}],228:[function(_dereq_,module,exports){"use strict";module.exports.parseName=function(name,defaultPrefix){var localName,prefix,parts=name.split(/:/);if(1===parts.length)localName=name,prefix=defaultPrefix;else{if(2!==parts.length)throw new Error("expected <prefix:localName> or <localName>, got "+name);localName=parts[1],prefix=parts[0]}return name=(prefix?prefix+":":"")+localName,{name:name,prefix:prefix,localName:localName}}},{}],229:[function(_dereq_,module,exports){"use strict";function Properties(model){this.model=model}function isUndefined(val){return void 0===val}function defineProperty(target,property,value){Object.defineProperty(target,property.name,{enumerable:!property.isReference,writable:!0,value:value,configurable:!0})}module.exports=Properties,Properties.prototype.set=function(target,name,value){var property=this.model.getPropertyDescriptor(target,name),propertyName=property&&property.name;isUndefined(value)?property?delete target[propertyName]:delete target.$attrs[name]:property?propertyName in target?target[propertyName]=value:defineProperty(target,property,value):target.$attrs[name]=value},Properties.prototype.get=function(target,name){var property=this.model.getPropertyDescriptor(target,name);if(!property)return target.$attrs[name];var propertyName=property.name;return!target[propertyName]&&property.isMany&&defineProperty(target,property,[]),target[propertyName]},Properties.prototype.define=function(target,name,options){Object.defineProperty(target,name,options)},Properties.prototype.defineDescriptor=function(target,descriptor){this.define(target,"$descriptor",{value:descriptor})},Properties.prototype.defineModel=function(target,model){this.define(target,"$model",{value:model})}},{}],230:[function(_dereq_,module,exports){"use strict";function Registry(packages,properties){this.packageMap={},this.typeMap={},this.packages=[],this.properties=properties,forEach(packages,this.registerPackage,this)}var assign=_dereq_(202),forEach=_dereq_(90),Types=_dereq_(231),DescriptorBuilder=_dereq_(225),parseNameNs=_dereq_(228).parseName,isBuiltInType=Types.isBuiltIn;module.exports=Registry,Registry.prototype.getPackage=function(uriOrPrefix){return this.packageMap[uriOrPrefix]},Registry.prototype.getPackages=function(){return this.packages},Registry.prototype.registerPackage=function(pkg){pkg=assign({},pkg),forEach(pkg.types,function(descriptor){this.registerType(descriptor,pkg)},this),this.packageMap[pkg.uri]=this.packageMap[pkg.prefix]=pkg,this.packages.push(pkg)},Registry.prototype.registerType=function(type,pkg){type=assign({},type,{superClass:(type.superClass||[]).slice(),extends:(type.extends||[]).slice(),properties:(type.properties||[]).slice(),meta:assign(type.meta||{})});var ns=parseNameNs(type.name,pkg.prefix),name=ns.name,propertiesByName={};forEach(type.properties,function(p){var propertyNs=parseNameNs(p.name,ns.prefix),propertyName=propertyNs.name;isBuiltInType(p.type)||(p.type=parseNameNs(p.type,propertyNs.prefix).name),assign(p,{ns:propertyNs,name:propertyName}),propertiesByName[propertyName]=p}),assign(type,{ns:ns,name:name,propertiesByName:propertiesByName}),forEach(type.extends,function(extendsName){var extended=this.typeMap[extendsName];extended.traits=extended.traits||[],extended.traits.push(name)},this),this.definePackage(type,pkg),this.typeMap[name]=type},Registry.prototype.mapTypes=function(nsName,iterator,trait){function traverseTrait(cls){return traverseSuper(cls,!0)}function traverseSuper(cls,trait){var parentNs=parseNameNs(cls,isBuiltInType(cls)?"":nsName.prefix);self.mapTypes(parentNs,iterator,trait)}var type=isBuiltInType(nsName.name)?{name:nsName.name}:this.typeMap[nsName.name],self=this;if(!type)throw new Error("unknown type <"+nsName.name+">");forEach(type.superClass,trait?traverseTrait:traverseSuper),iterator(type,!trait),forEach(type.traits,traverseTrait)},Registry.prototype.getEffectiveDescriptor=function(name){var nsName=parseNameNs(name),builder=new DescriptorBuilder(nsName);this.mapTypes(nsName,function(type,inherited){builder.addTrait(type,inherited)});var descriptor=builder.build();return this.definePackage(descriptor,descriptor.allTypes[descriptor.allTypes.length-1].$pkg),descriptor},Registry.prototype.definePackage=function(target,pkg){this.properties.define(target,"$pkg",{value:pkg})}},{202:202,225:225,228:228,231:231,90:90}],231:[function(_dereq_,module,exports){"use strict";var BUILTINS={String:!0,Boolean:!0,Integer:!0,Real:!0,Element:!0},TYPE_CONVERTERS={String:function(s){return s},Boolean:function(s){return"true"===s},Integer:function(s){return parseInt(s,10)},Real:function(s){return parseFloat(s,10)}};module.exports.coerceType=function(type,value){var converter=TYPE_CONVERTERS[type];return converter?converter(value):value},module.exports.isBuiltIn=function(type){return!!BUILTINS[type]},module.exports.isSimple=function(type){return!!TYPE_CONVERTERS[type]}},{}],232:[function(_dereq_,module,exports){module.exports=_dereq_(234),module.exports.Collection=_dereq_(233)},{233:233,234:234}],233:[function(_dereq_,module,exports){"use strict";function extend(collection,refs,property,target){var inverseProperty=property.inverse;return Object.defineProperty(collection,"remove",{value:function(element){var idx=this.indexOf(element);return-1!==idx&&(this.splice(idx,1),refs.unset(element,inverseProperty,target)),element}}),Object.defineProperty(collection,"contains",{value:function(element){return-1!==this.indexOf(element)}}),Object.defineProperty(collection,"add",{value:function(element){this.contains(element)||(this.push(element),refs.set(element,inverseProperty,target))}}),Object.defineProperty(collection,"__refs_collection",{value:!0}),collection}function isExtended(collection){return!0===collection.__refs_collection}module.exports.extend=extend,module.exports.isExtended=isExtended},{}],234:[function(_dereq_,module,exports){"use strict";function hasOwnProperty(e,property){return Object.prototype.hasOwnProperty.call(e,property.name||property)}function defineCollectionProperty(ref,property,target){Object.defineProperty(target,property.name,{enumerable:property.enumerable,value:Collection.extend(target[property.name]||[],ref,property,target)})}function defineProperty(ref,property,target){var inverseProperty=property.inverse,_value=target[property.name];Object.defineProperty(target,property.name,{enumerable:property.enumerable,get:function(){return _value},set:function(value){if(value!==_value){var old=_value;_value=null,old&&ref.unset(old,inverseProperty,target),_value=value,ref.set(_value,inverseProperty,target)}}})}function Refs(a,b){if(!(this instanceof Refs))return new Refs(a,b);a.inverse=b,b.inverse=a,this.props={},this.props[a.name]=a,this.props[b.name]=b}var Collection=_dereq_(233);Refs.prototype.bind=function(target,property){if("string"==typeof property){if(!this.props[property])throw new Error("no property <"+property+"> in ref");property=this.props[property]}property.collection?defineCollectionProperty(this,property,target):defineProperty(this,property,target)},Refs.prototype.ensureRefsCollection=function(target,property){var collection=target[property.name];return Collection.isExtended(collection)||defineCollectionProperty(this,property,target),collection},Refs.prototype.ensureBound=function(target,property){hasOwnProperty(target,property)||this.bind(target,property)},Refs.prototype.unset=function(target,property,value){target&&(this.ensureBound(target,property),property.collection?this.ensureRefsCollection(target,property).remove(value):target[property.name]=void 0)},Refs.prototype.set=function(target,property,value){target&&(this.ensureBound(target,property),property.collection?this.ensureRefsCollection(target,property).add(value):target[property.name]=value)},module.exports=Refs},{233:233}],235:[function(_dereq_,module,exports){(function(process){"use strict";function nextTick(fn,arg1,arg2,arg3){if("function"!=typeof fn)throw new TypeError('"callback" argument must be a function');var args,i,len=arguments.length;switch(len){case 0:case 1:return process.nextTick(fn);case 2:return process.nextTick(function(){fn.call(null,arg1)});case 3:return process.nextTick(function(){fn.call(null,arg1,arg2)});case 4:return process.nextTick(function(){fn.call(null,arg1,arg2,arg3)});default:for(args=new Array(len-1),i=0;i<args.length;)args[i++]=arguments[i];return process.nextTick(function(){fn.apply(null,args)})}}!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?module.exports=nextTick:module.exports=process.nextTick}).call(this,void 0)},{}],236:[function(_dereq_,module,exports){module.exports=_dereq_(237)},{237:237}],237:[function(_dereq_,module,exports){"use strict";function Duplex(options){if(!(this instanceof Duplex))return new Duplex(options);Readable.call(this,options),Writable.call(this,options),options&&!1===options.readable&&(this.readable=!1),options&&!1===options.writable&&(this.writable=!1),this.allowHalfOpen=!0,options&&!1===options.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||processNextTick(onEndNT,this)}function onEndNT(self){self.end()}var processNextTick=_dereq_(235),objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)keys.push(key);return keys};module.exports=Duplex;var util=_dereq_(37);util.inherits=_dereq_(82);var Readable=_dereq_(239),Writable=_dereq_(241);util.inherits(Duplex,Readable);for(var keys=objectKeys(Writable.prototype),v=0;v<keys.length;v++){var method=keys[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}Object.defineProperty(Duplex.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(value){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=value,this._writableState.destroyed=value)}}),Duplex.prototype._destroy=function(err,cb){this.push(null),this.end(),processNextTick(cb,err)}},{235:235,239:239,241:241,37:37,82:82}],238:[function(_dereq_,module,exports){"use strict";function PassThrough(options){if(!(this instanceof PassThrough))return new PassThrough(options);Transform.call(this,options)}module.exports=PassThrough;var Transform=_dereq_(240),util=_dereq_(37);util.inherits=_dereq_(82),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk)}},{240:240,37:37,82:82}],239:[function(_dereq_,module,exports){(function(process,global){"use strict";function _uint8ArrayToBuffer(chunk){return Buffer.from(chunk)}function _isUint8Array(obj){return Buffer.isBuffer(obj)||obj instanceof OurUint8Array}function prependListener(emitter,event,fn){if("function"==typeof emitter.prependListener)return emitter.prependListener(event,fn);emitter._events&&emitter._events[event]?isArray(emitter._events[event])?emitter._events[event].unshift(fn):emitter._events[event]=[fn,emitter._events[event]]:emitter.on(event,fn)}function ReadableState(options,stream){Duplex=Duplex||_dereq_(237),options=options||{},this.objectMode=!!options.objectMode,stream instanceof Duplex&&(this.objectMode=this.objectMode||!!options.readableObjectMode);var hwm=options.highWaterMark,defaultHwm=this.objectMode?16:16384;this.highWaterMark=hwm||0===hwm?hwm:defaultHwm,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new BufferList,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=options.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,options.encoding&&(StringDecoder||(StringDecoder=_dereq_(245).StringDecoder),this.decoder=new StringDecoder(options.encoding),this.encoding=options.encoding)}function Readable(options){if(Duplex=Duplex||_dereq_(237),!(this instanceof Readable))return new Readable(options);this._readableState=new ReadableState(options,this),this.readable=!0,options&&("function"==typeof options.read&&(this._read=options.read),"function"==typeof options.destroy&&(this._destroy=options.destroy)),Stream.call(this)}function readableAddChunk(stream,chunk,encoding,addToFront,skipChunkCheck){var state=stream._readableState;if(null===chunk)state.reading=!1,onEofChunk(stream,state);else{var er;skipChunkCheck||(er=chunkInvalid(state,chunk)),
er?stream.emit("error",er):state.objectMode||chunk&&chunk.length>0?("string"==typeof chunk||state.objectMode||Object.getPrototypeOf(chunk)===Buffer.prototype||(chunk=_uint8ArrayToBuffer(chunk)),addToFront?state.endEmitted?stream.emit("error",new Error("stream.unshift() after end event")):addChunk(stream,state,chunk,!0):state.ended?stream.emit("error",new Error("stream.push() after EOF")):(state.reading=!1,state.decoder&&!encoding?(chunk=state.decoder.write(chunk),state.objectMode||0!==chunk.length?addChunk(stream,state,chunk,!1):maybeReadMore(stream,state)):addChunk(stream,state,chunk,!1))):addToFront||(state.reading=!1)}return needMoreData(state)}function addChunk(stream,state,chunk,addToFront){state.flowing&&0===state.length&&!state.sync?(stream.emit("data",chunk),stream.read(0)):(state.length+=state.objectMode?1:chunk.length,addToFront?state.buffer.unshift(chunk):state.buffer.push(chunk),state.needReadable&&emitReadable(stream)),maybeReadMore(stream,state)}function chunkInvalid(state,chunk){var er;return _isUint8Array(chunk)||"string"==typeof chunk||void 0===chunk||state.objectMode||(er=new TypeError("Invalid non-string/buffer chunk")),er}function needMoreData(state){return!state.ended&&(state.needReadable||state.length<state.highWaterMark||0===state.length)}function computeNewHighWaterMark(n){return n>=MAX_HWM?n=MAX_HWM:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n}function howMuchToRead(n,state){return n<=0||0===state.length&&state.ended?0:state.objectMode?1:n!==n?state.flowing&&state.length?state.buffer.head.data.length:state.length:(n>state.highWaterMark&&(state.highWaterMark=computeNewHighWaterMark(n)),n<=state.length?n:state.ended?state.length:(state.needReadable=!0,0))}function onEofChunk(stream,state){if(!state.ended){if(state.decoder){var chunk=state.decoder.end();chunk&&chunk.length&&(state.buffer.push(chunk),state.length+=state.objectMode?1:chunk.length)}state.ended=!0,emitReadable(stream)}}function emitReadable(stream){var state=stream._readableState;state.needReadable=!1,state.emittedReadable||(debug("emitReadable",state.flowing),state.emittedReadable=!0,state.sync?processNextTick(emitReadable_,stream):emitReadable_(stream))}function emitReadable_(stream){debug("emit readable"),stream.emit("readable"),flow(stream)}function maybeReadMore(stream,state){state.readingMore||(state.readingMore=!0,processNextTick(maybeReadMore_,stream,state))}function maybeReadMore_(stream,state){for(var len=state.length;!state.reading&&!state.flowing&&!state.ended&&state.length<state.highWaterMark&&(debug("maybeReadMore read 0"),stream.read(0),len!==state.length);)len=state.length;state.readingMore=!1}function pipeOnDrain(src){return function(){var state=src._readableState;debug("pipeOnDrain",state.awaitDrain),state.awaitDrain&&state.awaitDrain--,0===state.awaitDrain&&EElistenerCount(src,"data")&&(state.flowing=!0,flow(src))}}function nReadingNextTick(self){debug("readable nexttick read 0"),self.read(0)}function resume(stream,state){state.resumeScheduled||(state.resumeScheduled=!0,processNextTick(resume_,stream,state))}function resume_(stream,state){state.reading||(debug("resume read 0"),stream.read(0)),state.resumeScheduled=!1,state.awaitDrain=0,stream.emit("resume"),flow(stream),state.flowing&&!state.reading&&stream.read(0)}function flow(stream){var state=stream._readableState;for(debug("flow",state.flowing);state.flowing&&null!==stream.read(););}function fromList(n,state){if(0===state.length)return null;var ret;return state.objectMode?ret=state.buffer.shift():!n||n>=state.length?(ret=state.decoder?state.buffer.join(""):1===state.buffer.length?state.buffer.head.data:state.buffer.concat(state.length),state.buffer.clear()):ret=fromListPartial(n,state.buffer,state.decoder),ret}function fromListPartial(n,list,hasStrings){var ret;return n<list.head.data.length?(ret=list.head.data.slice(0,n),list.head.data=list.head.data.slice(n)):ret=n===list.head.data.length?list.shift():hasStrings?copyFromBufferString(n,list):copyFromBuffer(n,list),ret}function copyFromBufferString(n,list){var p=list.head,c=1,ret=p.data;for(n-=ret.length;p=p.next;){var str=p.data,nb=n>str.length?str.length:n;if(nb===str.length?ret+=str:ret+=str.slice(0,n),0===(n-=nb)){nb===str.length?(++c,p.next?list.head=p.next:list.head=list.tail=null):(list.head=p,p.data=str.slice(nb));break}++c}return list.length-=c,ret}function copyFromBuffer(n,list){var ret=Buffer.allocUnsafe(n),p=list.head,c=1;for(p.data.copy(ret),n-=p.data.length;p=p.next;){var buf=p.data,nb=n>buf.length?buf.length:n;if(buf.copy(ret,ret.length-n,0,nb),0===(n-=nb)){nb===buf.length?(++c,p.next?list.head=p.next:list.head=list.tail=null):(list.head=p,p.data=buf.slice(nb));break}++c}return list.length-=c,ret}function endReadable(stream){var state=stream._readableState;if(state.length>0)throw new Error('"endReadable()" called on non-empty stream');state.endEmitted||(state.ended=!0,processNextTick(endReadableNT,state,stream))}function endReadableNT(state,stream){state.endEmitted||0!==state.length||(state.endEmitted=!0,stream.readable=!1,stream.emit("end"))}function indexOf(xs,x){for(var i=0,l=xs.length;i<l;i++)if(xs[i]===x)return i;return-1}var processNextTick=_dereq_(235);module.exports=Readable;var Duplex,isArray=_dereq_(84);Readable.ReadableState=ReadableState;var EElistenerCount=(_dereq_(78).EventEmitter,function(emitter,type){return emitter.listeners(type).length}),Stream=_dereq_(244),Buffer=_dereq_(250).Buffer,OurUint8Array=global.Uint8Array||function(){},util=_dereq_(37);util.inherits=_dereq_(82);var debugUtil=_dereq_(27),debug=void 0;debug=debugUtil&&debugUtil.debuglog?debugUtil.debuglog("stream"):function(){};var StringDecoder,BufferList=_dereq_(242),destroyImpl=_dereq_(243);util.inherits(Readable,Stream);var kProxyEvents=["error","close","destroy","pause","resume"];Object.defineProperty(Readable.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(value){this._readableState&&(this._readableState.destroyed=value)}}),Readable.prototype.destroy=destroyImpl.destroy,Readable.prototype._undestroy=destroyImpl.undestroy,Readable.prototype._destroy=function(err,cb){this.push(null),cb(err)},Readable.prototype.push=function(chunk,encoding){var skipChunkCheck,state=this._readableState;return state.objectMode?skipChunkCheck=!0:"string"==typeof chunk&&(encoding=encoding||state.defaultEncoding,encoding!==state.encoding&&(chunk=Buffer.from(chunk,encoding),encoding=""),skipChunkCheck=!0),readableAddChunk(this,chunk,encoding,!1,skipChunkCheck)},Readable.prototype.unshift=function(chunk){return readableAddChunk(this,chunk,null,!0,!1)},Readable.prototype.isPaused=function(){return!1===this._readableState.flowing},Readable.prototype.setEncoding=function(enc){return StringDecoder||(StringDecoder=_dereq_(245).StringDecoder),this._readableState.decoder=new StringDecoder(enc),this._readableState.encoding=enc,this};var MAX_HWM=8388608;Readable.prototype.read=function(n){debug("read",n),n=parseInt(n,10);var state=this._readableState,nOrig=n;if(0!==n&&(state.emittedReadable=!1),0===n&&state.needReadable&&(state.length>=state.highWaterMark||state.ended))return debug("read: emitReadable",state.length,state.ended),0===state.length&&state.ended?endReadable(this):emitReadable(this),null;if(0===(n=howMuchToRead(n,state))&&state.ended)return 0===state.length&&endReadable(this),null;var doRead=state.needReadable;debug("need readable",doRead),(0===state.length||state.length-n<state.highWaterMark)&&(doRead=!0,debug("length less than watermark",doRead)),state.ended||state.reading?(doRead=!1,debug("reading or ended",doRead)):doRead&&(debug("do read"),state.reading=!0,state.sync=!0,0===state.length&&(state.needReadable=!0),this._read(state.highWaterMark),state.sync=!1,state.reading||(n=howMuchToRead(nOrig,state)));var ret;return ret=n>0?fromList(n,state):null,null===ret?(state.needReadable=!0,n=0):state.length-=n,0===state.length&&(state.ended||(state.needReadable=!0),nOrig!==n&&state.ended&&endReadable(this)),null!==ret&&this.emit("data",ret),ret},Readable.prototype._read=function(n){this.emit("error",new Error("_read() is not implemented"))},Readable.prototype.pipe=function(dest,pipeOpts){function onunpipe(readable,unpipeInfo){debug("onunpipe"),readable===src&&unpipeInfo&&!1===unpipeInfo.hasUnpiped&&(unpipeInfo.hasUnpiped=!0,cleanup())}function onend(){debug("onend"),dest.end()}function cleanup(){debug("cleanup"),dest.removeListener("close",onclose),dest.removeListener("finish",onfinish),dest.removeListener("drain",ondrain),dest.removeListener("error",onerror),dest.removeListener("unpipe",onunpipe),src.removeListener("end",onend),src.removeListener("end",unpipe),src.removeListener("data",ondata),cleanedUp=!0,!state.awaitDrain||dest._writableState&&!dest._writableState.needDrain||ondrain()}function ondata(chunk){debug("ondata"),increasedAwaitDrain=!1,!1!==dest.write(chunk)||increasedAwaitDrain||((1===state.pipesCount&&state.pipes===dest||state.pipesCount>1&&-1!==indexOf(state.pipes,dest))&&!cleanedUp&&(debug("false write response, pause",src._readableState.awaitDrain),src._readableState.awaitDrain++,increasedAwaitDrain=!0),src.pause())}function onerror(er){debug("onerror",er),unpipe(),dest.removeListener("error",onerror),0===EElistenerCount(dest,"error")&&dest.emit("error",er)}function onclose(){dest.removeListener("finish",onfinish),unpipe()}function onfinish(){debug("onfinish"),dest.removeListener("close",onclose),unpipe()}function unpipe(){debug("unpipe"),src.unpipe(dest)}var src=this,state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest)}state.pipesCount+=1,debug("pipe count=%d opts=%j",state.pipesCount,pipeOpts);var doEnd=(!pipeOpts||!1!==pipeOpts.end)&&dest!==process.stdout&&dest!==process.stderr,endFn=doEnd?onend:unpipe;state.endEmitted?processNextTick(endFn):src.once("end",endFn),dest.on("unpipe",onunpipe);var ondrain=pipeOnDrain(src);dest.on("drain",ondrain);var cleanedUp=!1,increasedAwaitDrain=!1;return src.on("data",ondata),prependListener(dest,"error",onerror),dest.once("close",onclose),dest.once("finish",onfinish),dest.emit("pipe",src),state.flowing||(debug("pipe resume"),src.resume()),dest},Readable.prototype.unpipe=function(dest){var state=this._readableState,unpipeInfo={hasUnpiped:!1};if(0===state.pipesCount)return this;if(1===state.pipesCount)return dest&&dest!==state.pipes?this:(dest||(dest=state.pipes),state.pipes=null,state.pipesCount=0,state.flowing=!1,dest&&dest.emit("unpipe",this,unpipeInfo),this);if(!dest){var dests=state.pipes,len=state.pipesCount;state.pipes=null,state.pipesCount=0,state.flowing=!1;for(var i=0;i<len;i++)dests[i].emit("unpipe",this,unpipeInfo);return this}var index=indexOf(state.pipes,dest);return-1===index?this:(state.pipes.splice(index,1),state.pipesCount-=1,1===state.pipesCount&&(state.pipes=state.pipes[0]),dest.emit("unpipe",this,unpipeInfo),this)},Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);if("data"===ev)!1!==this._readableState.flowing&&this.resume();else if("readable"===ev){var state=this._readableState;state.endEmitted||state.readableListening||(state.readableListening=state.needReadable=!0,state.emittedReadable=!1,state.reading?state.length&&emitReadable(this):processNextTick(nReadingNextTick,this))}return res},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var state=this._readableState;return state.flowing||(debug("resume"),state.flowing=!0,resume(this,state)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(stream){var state=this._readableState,paused=!1,self=this;stream.on("end",function(){if(debug("wrapped end"),state.decoder&&!state.ended){var chunk=state.decoder.end();chunk&&chunk.length&&self.push(chunk)}self.push(null)}),stream.on("data",function(chunk){if(debug("wrapped data"),state.decoder&&(chunk=state.decoder.write(chunk)),(!state.objectMode||null!==chunk&&void 0!==chunk)&&(state.objectMode||chunk&&chunk.length)){self.push(chunk)||(paused=!0,stream.pause())}});for(var i in stream)void 0===this[i]&&"function"==typeof stream[i]&&(this[i]=function(method){return function(){return stream[method].apply(stream,arguments)}}(i));for(var n=0;n<kProxyEvents.length;n++)stream.on(kProxyEvents[n],self.emit.bind(self,kProxyEvents[n]));return self._read=function(n){debug("wrapped _read",n),paused&&(paused=!1,stream.resume())},self},Readable._fromList=fromList}).call(this,void 0,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{235:235,237:237,242:242,243:243,244:244,245:245,250:250,27:27,37:37,78:78,82:82,84:84}],240:[function(_dereq_,module,exports){"use strict";function TransformState(stream){this.afterTransform=function(er,data){return afterTransform(stream,er,data)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function afterTransform(stream,er,data){var ts=stream._transformState;ts.transforming=!1;var cb=ts.writecb;if(!cb)return stream.emit("error",new Error("write callback called multiple times"));ts.writechunk=null,ts.writecb=null,null!==data&&void 0!==data&&stream.push(data),cb(er);var rs=stream._readableState;rs.reading=!1,(rs.needReadable||rs.length<rs.highWaterMark)&&stream._read(rs.highWaterMark)}function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options),this._transformState=new TransformState(this);var stream=this;this._readableState.needReadable=!0,this._readableState.sync=!1,options&&("function"==typeof options.transform&&(this._transform=options.transform),"function"==typeof options.flush&&(this._flush=options.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(er,data){done(stream,er,data)}):done(stream)})}function done(stream,er,data){if(er)return stream.emit("error",er);null!==data&&void 0!==data&&stream.push(data);var ws=stream._writableState,ts=stream._transformState;if(ws.length)throw new Error("Calling transform done when ws.length != 0");if(ts.transforming)throw new Error("Calling transform done when still transforming");return stream.push(null)}module.exports=Transform;var Duplex=_dereq_(237),util=_dereq_(37);util.inherits=_dereq_(82),util.inherits(Transform,Duplex),Transform.prototype.push=function(chunk,encoding){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,chunk,encoding)},Transform.prototype._transform=function(chunk,encoding,cb){throw new Error("_transform() is not implemented")},Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;if(ts.writecb=cb,ts.writechunk=chunk,ts.writeencoding=encoding,!ts.transforming){var rs=this._readableState;(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)&&this._read(rs.highWaterMark)}},Transform.prototype._read=function(n){var ts=this._transformState;null!==ts.writechunk&&ts.writecb&&!ts.transforming?(ts.transforming=!0,this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform)):ts.needTransform=!0},Transform.prototype._destroy=function(err,cb){var _this=this;Duplex.prototype._destroy.call(this,err,function(err2){cb(err2),_this.emit("close")})}},{237:237,37:37,82:82}],241:[function(_dereq_,module,exports){(function(process,global){"use strict";function CorkedRequest(state){var _this=this;this.next=null,this.entry=null,this.finish=function(){onCorkedFinish(_this,state)}}function _uint8ArrayToBuffer(chunk){return Buffer.from(chunk)}function _isUint8Array(obj){return Buffer.isBuffer(obj)||obj instanceof OurUint8Array}function nop(){}function WritableState(options,stream){Duplex=Duplex||_dereq_(237),options=options||{},this.objectMode=!!options.objectMode,stream instanceof Duplex&&(this.objectMode=this.objectMode||!!options.writableObjectMode);var hwm=options.highWaterMark,defaultHwm=this.objectMode?16:16384;this.highWaterMark=hwm||0===hwm?hwm:defaultHwm,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var noDecode=!1===options.decodeStrings;this.decodeStrings=!noDecode,this.defaultEncoding=options.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(er){onwrite(stream,er)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this)}function Writable(options){if(Duplex=Duplex||_dereq_(237),!(realHasInstance.call(Writable,this)||this instanceof Duplex))return new Writable(options);this._writableState=new WritableState(options,this),this.writable=!0,options&&("function"==typeof options.write&&(this._write=options.write),"function"==typeof options.writev&&(this._writev=options.writev),"function"==typeof options.destroy&&(this._destroy=options.destroy),"function"==typeof options.final&&(this._final=options.final)),Stream.call(this)}function writeAfterEnd(stream,cb){var er=new Error("write after end");stream.emit("error",er),processNextTick(cb,er)}function validChunk(stream,state,chunk,cb){var valid=!0,er=!1;return null===chunk?er=new TypeError("May not write null values to stream"):"string"==typeof chunk||void 0===chunk||state.objectMode||(er=new TypeError("Invalid non-string/buffer chunk")),er&&(stream.emit("error",er),processNextTick(cb,er),valid=!1),valid}function decodeChunk(state,chunk,encoding){return state.objectMode||!1===state.decodeStrings||"string"!=typeof chunk||(chunk=Buffer.from(chunk,encoding)),chunk}function writeOrBuffer(stream,state,isBuf,chunk,encoding,cb){if(!isBuf){var newChunk=decodeChunk(state,chunk,encoding);chunk!==newChunk&&(isBuf=!0,encoding="buffer",chunk=newChunk)}var len=state.objectMode?1:chunk.length;state.length+=len;var ret=state.length<state.highWaterMark;if(ret||(state.needDrain=!0),state.writing||state.corked){var last=state.lastBufferedRequest;state.lastBufferedRequest={chunk:chunk,encoding:encoding,isBuf:isBuf,callback:cb,next:null},last?last.next=state.lastBufferedRequest:state.bufferedRequest=state.lastBufferedRequest,state.bufferedRequestCount+=1}else doWrite(stream,state,!1,len,chunk,encoding,cb);return ret}function doWrite(stream,state,writev,len,chunk,encoding,cb){state.writelen=len,state.writecb=cb,state.writing=!0,state.sync=!0,writev?stream._writev(chunk,state.onwrite):stream._write(chunk,encoding,state.onwrite),state.sync=!1}function onwriteError(stream,state,sync,er,cb){--state.pendingcb,sync?(processNextTick(cb,er),processNextTick(finishMaybe,stream,state),stream._writableState.errorEmitted=!0,stream.emit("error",er)):(cb(er),stream._writableState.errorEmitted=!0,stream.emit("error",er),finishMaybe(stream,state))}function onwriteStateUpdate(state){state.writing=!1,state.writecb=null,state.length-=state.writelen,state.writelen=0}function onwrite(stream,er){var state=stream._writableState,sync=state.sync,cb=state.writecb;if(onwriteStateUpdate(state),er)onwriteError(stream,state,sync,er,cb);else{var finished=needFinish(state);finished||state.corked||state.bufferProcessing||!state.bufferedRequest||clearBuffer(stream,state),sync?asyncWrite(afterWrite,stream,state,finished,cb):afterWrite(stream,state,finished,cb)}}function afterWrite(stream,state,finished,cb){finished||onwriteDrain(stream,state),state.pendingcb--,cb(),finishMaybe(stream,state)}function onwriteDrain(stream,state){0===state.length&&state.needDrain&&(state.needDrain=!1,stream.emit("drain"))}function clearBuffer(stream,state){state.bufferProcessing=!0;var entry=state.bufferedRequest;if(stream._writev&&entry&&entry.next){var l=state.bufferedRequestCount,buffer=new Array(l),holder=state.corkedRequestsFree;holder.entry=entry;for(var count=0,allBuffers=!0;entry;)buffer[count]=entry,entry.isBuf||(allBuffers=!1),entry=entry.next,count+=1;buffer.allBuffers=allBuffers,doWrite(stream,state,!0,state.length,buffer,"",holder.finish),state.pendingcb++,state.lastBufferedRequest=null,holder.next?(state.corkedRequestsFree=holder.next,holder.next=null):state.corkedRequestsFree=new CorkedRequest(state)}else{for(;entry;){var chunk=entry.chunk,encoding=entry.encoding,cb=entry.callback;if(doWrite(stream,state,!1,state.objectMode?1:chunk.length,chunk,encoding,cb),entry=entry.next,state.writing)break}null===entry&&(state.lastBufferedRequest=null)}state.bufferedRequestCount=0,state.bufferedRequest=entry,state.bufferProcessing=!1}function needFinish(state){return state.ending&&0===state.length&&null===state.bufferedRequest&&!state.finished&&!state.writing}function callFinal(stream,state){stream._final(function(err){state.pendingcb--,err&&stream.emit("error",err),state.prefinished=!0,stream.emit("prefinish"),finishMaybe(stream,state)})}function prefinish(stream,state){state.prefinished||state.finalCalled||("function"==typeof stream._final?(state.pendingcb++,state.finalCalled=!0,processNextTick(callFinal,stream,state)):(state.prefinished=!0,stream.emit("prefinish")))}function finishMaybe(stream,state){var need=needFinish(state);return need&&(prefinish(stream,state),0===state.pendingcb&&(state.finished=!0,stream.emit("finish"))),need}function endWritable(stream,state,cb){state.ending=!0,finishMaybe(stream,state),cb&&(state.finished?processNextTick(cb):stream.once("finish",cb)),state.ended=!0,stream.writable=!1}function onCorkedFinish(corkReq,state,err){var entry=corkReq.entry;for(corkReq.entry=null;entry;){var cb=entry.callback;state.pendingcb--,cb(err),entry=entry.next}state.corkedRequestsFree?state.corkedRequestsFree.next=corkReq:state.corkedRequestsFree=corkReq}var processNextTick=_dereq_(235);module.exports=Writable;var Duplex,asyncWrite=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:processNextTick;Writable.WritableState=WritableState;var util=_dereq_(37);util.inherits=_dereq_(82);var internalUtil={deprecate:_dereq_(269)},Stream=_dereq_(244),Buffer=_dereq_(250).Buffer,OurUint8Array=global.Uint8Array||function(){},destroyImpl=_dereq_(243);util.inherits(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var current=this.bufferedRequest,out=[];current;)out.push(current),current=current.next;return out},function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(_){}}();var realHasInstance;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(realHasInstance=Function.prototype[Symbol.hasInstance],Object.defineProperty(Writable,Symbol.hasInstance,{value:function(object){return!!realHasInstance.call(this,object)||object&&object._writableState instanceof WritableState}})):realHasInstance=function(object){return object instanceof this},Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Writable.prototype.write=function(chunk,encoding,cb){var state=this._writableState,ret=!1,isBuf=_isUint8Array(chunk)&&!state.objectMode;return isBuf&&!Buffer.isBuffer(chunk)&&(chunk=_uint8ArrayToBuffer(chunk)),"function"==typeof encoding&&(cb=encoding,encoding=null),isBuf?encoding="buffer":encoding||(encoding=state.defaultEncoding),"function"!=typeof cb&&(cb=nop),state.ended?writeAfterEnd(this,cb):(isBuf||validChunk(this,state,chunk,cb))&&(state.pendingcb++,ret=writeOrBuffer(this,state,isBuf,chunk,encoding,cb)),ret},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var state=this._writableState;state.corked&&(state.corked--,state.writing||state.corked||state.finished||state.bufferProcessing||!state.bufferedRequest||clearBuffer(this,state))},Writable.prototype.setDefaultEncoding=function(encoding){if("string"==typeof encoding&&(encoding=encoding.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((encoding+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+encoding);return this._writableState.defaultEncoding=encoding,this},Writable.prototype._write=function(chunk,encoding,cb){cb(new Error("_write() is not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;"function"==typeof chunk?(cb=chunk,chunk=null,encoding=null):"function"==typeof encoding&&(cb=encoding,encoding=null),null!==chunk&&void 0!==chunk&&this.write(chunk,encoding),state.corked&&(state.corked=1,this.uncork()),state.ending||state.finished||endWritable(this,state,cb)},Object.defineProperty(Writable.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(value){this._writableState&&(this._writableState.destroyed=value)}}),Writable.prototype.destroy=destroyImpl.destroy,Writable.prototype._undestroy=destroyImpl.undestroy,Writable.prototype._destroy=function(err,cb){this.end(),cb(err)}}).call(this,void 0,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{235:235,237:237,243:243,244:244,250:250,269:269,37:37,82:82}],242:[function(_dereq_,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function copyBuffer(src,target,offset){src.copy(target,offset)}var Buffer=_dereq_(250).Buffer;module.exports=function(){function BufferList(){_classCallCheck(this,BufferList),this.head=null,this.tail=null,this.length=0}return BufferList.prototype.push=function(v){var entry={data:v,next:null};this.length>0?this.tail.next=entry:this.head=entry,this.tail=entry,++this.length},BufferList.prototype.unshift=function(v){var entry={data:v,next:this.head};0===this.length&&(this.tail=entry),this.head=entry,++this.length},BufferList.prototype.shift=function(){if(0!==this.length){var ret=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,ret}},BufferList.prototype.clear=function(){this.head=this.tail=null,this.length=0},BufferList.prototype.join=function(s){if(0===this.length)return"";for(var p=this.head,ret=""+p.data;p=p.next;)ret+=s+p.data;return ret},BufferList.prototype.concat=function(n){if(0===this.length)return Buffer.alloc(0);if(1===this.length)return this.head.data;for(var ret=Buffer.allocUnsafe(n>>>0),p=this.head,i=0;p;)copyBuffer(p.data,ret,i),i+=p.data.length,p=p.next;return ret},BufferList}()},{250:250}],243:[function(_dereq_,module,exports){"use strict";function destroy(err,cb){var _this=this,readableDestroyed=this._readableState&&this._readableState.destroyed,writableDestroyed=this._writableState&&this._writableState.destroyed;if(readableDestroyed||writableDestroyed)return void(cb?cb(err):!err||this._writableState&&this._writableState.errorEmitted||processNextTick(emitErrorNT,this,err));this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(err||null,function(err){!cb&&err?(processNextTick(emitErrorNT,_this,err),_this._writableState&&(_this._writableState.errorEmitted=!0)):cb&&cb(err)})}function undestroy(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function emitErrorNT(self,err){self.emit("error",err)}var processNextTick=_dereq_(235);module.exports={destroy:destroy,undestroy:undestroy}},{235:235}],244:[function(_dereq_,module,exports){module.exports=_dereq_(78).EventEmitter},{78:78}],245:[function(_dereq_,module,exports){"use strict";function _normalizeEncoding(enc){if(!enc)return"utf8";for(var retried;;)switch(enc){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return enc;default:if(retried)return;enc=(""+enc).toLowerCase(),retried=!0}}function normalizeEncoding(enc){var nenc=_normalizeEncoding(enc);if("string"!=typeof nenc&&(Buffer.isEncoding===isEncoding||!isEncoding(enc)))throw new Error("Unknown encoding: "+enc);return nenc||enc}function StringDecoder(encoding){this.encoding=normalizeEncoding(encoding);var nb;switch(this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,nb=4;break;case"utf8":this.fillLast=utf8FillLast,nb=4;break;case"base64":this.text=base64Text,this.end=base64End,nb=3;break;default:return this.write=simpleWrite,void(this.end=simpleEnd)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer.allocUnsafe(nb)}function utf8CheckByte(byte){return byte<=127?0:byte>>5==6?2:byte>>4==14?3:byte>>3==30?4:-1}function utf8CheckIncomplete(self,buf,i){var j=buf.length-1;if(j<i)return 0;var nb=utf8CheckByte(buf[j]);return nb>=0?(nb>0&&(self.lastNeed=nb-1),nb):--j<i?0:(nb=utf8CheckByte(buf[j]))>=0?(nb>0&&(self.lastNeed=nb-2),nb):--j<i?0:(nb=utf8CheckByte(buf[j]),nb>=0?(nb>0&&(2===nb?nb=0:self.lastNeed=nb-3),nb):0)}function utf8CheckExtraBytes(self,buf,p){if(128!=(192&buf[0]))return self.lastNeed=0,"�".repeat(p);if(self.lastNeed>1&&buf.length>1){if(128!=(192&buf[1]))return self.lastNeed=1,"�".repeat(p+1);if(self.lastNeed>2&&buf.length>2&&128!=(192&buf[2]))return self.lastNeed=2,"�".repeat(p+2)}}function utf8FillLast(buf){var p=this.lastTotal-this.lastNeed,r=utf8CheckExtraBytes(this,buf,p);return void 0!==r?r:this.lastNeed<=buf.length?(buf.copy(this.lastChar,p,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(buf.copy(this.lastChar,p,0,buf.length),void(this.lastNeed-=buf.length))}function utf8Text(buf,i){var total=utf8CheckIncomplete(this,buf,i);if(!this.lastNeed)return buf.toString("utf8",i);this.lastTotal=total;var end=buf.length-(total-this.lastNeed);return buf.copy(this.lastChar,0,end),buf.toString("utf8",i,end)}function utf8End(buf){var r=buf&&buf.length?this.write(buf):"";return this.lastNeed?r+"�".repeat(this.lastTotal-this.lastNeed):r}function utf16Text(buf,i){if((buf.length-i)%2==0){var r=buf.toString("utf16le",i);if(r){var c=r.charCodeAt(r.length-1);if(c>=55296&&c<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=buf[buf.length-2],this.lastChar[1]=buf[buf.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=buf[buf.length-1],buf.toString("utf16le",i,buf.length-1)}function utf16End(buf){var r=buf&&buf.length?this.write(buf):"";if(this.lastNeed){var end=this.lastTotal-this.lastNeed;return r+this.lastChar.toString("utf16le",0,end)}return r}function base64Text(buf,i){var n=(buf.length-i)%3;return 0===n?buf.toString("base64",i):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=buf[buf.length-1]:(this.lastChar[0]=buf[buf.length-2],this.lastChar[1]=buf[buf.length-1]),buf.toString("base64",i,buf.length-n))}function base64End(buf){var r=buf&&buf.length?this.write(buf):"";return this.lastNeed?r+this.lastChar.toString("base64",0,3-this.lastNeed):r}function simpleWrite(buf){return buf.toString(this.encoding)}function simpleEnd(buf){return buf&&buf.length?this.write(buf):""}var Buffer=_dereq_(250).Buffer,isEncoding=Buffer.isEncoding||function(encoding){switch((encoding=""+encoding)&&encoding.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};exports.StringDecoder=StringDecoder,StringDecoder.prototype.write=function(buf){
if(0===buf.length)return"";var r,i;if(this.lastNeed){if(void 0===(r=this.fillLast(buf)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<buf.length?r?r+this.text(buf,i):this.text(buf,i):r||""},StringDecoder.prototype.end=utf8End,StringDecoder.prototype.text=utf8Text,StringDecoder.prototype.fillLast=function(buf){if(this.lastNeed<=buf.length)return buf.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);buf.copy(this.lastChar,this.lastTotal-this.lastNeed,0,buf.length),this.lastNeed-=buf.length}},{250:250}],246:[function(_dereq_,module,exports){module.exports=_dereq_(247).PassThrough},{247:247}],247:[function(_dereq_,module,exports){exports=module.exports=_dereq_(239),exports.Stream=exports,exports.Readable=exports,exports.Writable=_dereq_(241),exports.Duplex=_dereq_(237),exports.Transform=_dereq_(240),exports.PassThrough=_dereq_(238)},{237:237,238:238,239:239,240:240,241:241}],248:[function(_dereq_,module,exports){module.exports=_dereq_(247).Transform},{247:247}],249:[function(_dereq_,module,exports){module.exports=_dereq_(241)},{241:241}],250:[function(_dereq_,module,exports){function copyProps(src,dst){for(var key in src)dst[key]=src[key]}function SafeBuffer(arg,encodingOrOffset,length){return Buffer(arg,encodingOrOffset,length)}var buffer=_dereq_(28),Buffer=buffer.Buffer;Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow?module.exports=buffer:(copyProps(buffer,exports),exports.Buffer=SafeBuffer),copyProps(Buffer,SafeBuffer),SafeBuffer.from=function(arg,encodingOrOffset,length){if("number"==typeof arg)throw new TypeError("Argument must not be a number");return Buffer(arg,encodingOrOffset,length)},SafeBuffer.alloc=function(size,fill,encoding){if("number"!=typeof size)throw new TypeError("Argument must be a number");var buf=Buffer(size);return void 0!==fill?"string"==typeof encoding?buf.fill(fill,encoding):buf.fill(fill):buf.fill(0),buf},SafeBuffer.allocUnsafe=function(size){if("number"!=typeof size)throw new TypeError("Argument must be a number");return Buffer(size)},SafeBuffer.allocUnsafeSlow=function(size){if("number"!=typeof size)throw new TypeError("Argument must be a number");return buffer.SlowBuffer(size)}},{28:28}],251:[function(_dereq_,module,exports){(function(Buffer){!function(sax){function SAXParser(strict,opt){if(!(this instanceof SAXParser))return new SAXParser(strict,opt);var parser=this;clearBuffers(parser),parser.q=parser.c="",parser.bufferCheckPosition=sax.MAX_BUFFER_LENGTH,parser.opt=opt||{},parser.opt.lowercase=parser.opt.lowercase||parser.opt.lowercasetags,parser.looseCase=parser.opt.lowercase?"toLowerCase":"toUpperCase",parser.tags=[],parser.closed=parser.closedRoot=parser.sawRoot=!1,parser.tag=parser.error=null,parser.strict=!!strict,parser.noscript=!(!strict&&!parser.opt.noscript),parser.state=S.BEGIN,parser.ENTITIES=Object.create(sax.ENTITIES),parser.attribList=[],parser.opt.xmlns&&(parser.ns=Object.create(rootNS)),parser.trackPosition=!1!==parser.opt.position,parser.trackPosition&&(parser.position=parser.line=parser.column=0),emit(parser,"onready")}function checkBufferLength(parser){for(var maxAllowed=Math.max(sax.MAX_BUFFER_LENGTH,10),maxActual=0,i=0,l=buffers.length;i<l;i++){var len=parser[buffers[i]].length;if(len>maxAllowed)switch(buffers[i]){case"textNode":closeText(parser);break;case"cdata":emitNode(parser,"oncdata",parser.cdata),parser.cdata="";break;case"script":emitNode(parser,"onscript",parser.script),parser.script="";break;default:error(parser,"Max buffer length exceeded: "+buffers[i])}maxActual=Math.max(maxActual,len)}parser.bufferCheckPosition=sax.MAX_BUFFER_LENGTH-maxActual+parser.position}function clearBuffers(parser){for(var i=0,l=buffers.length;i<l;i++)parser[buffers[i]]=""}function flushBuffers(parser){closeText(parser),""!==parser.cdata&&(emitNode(parser,"oncdata",parser.cdata),parser.cdata=""),""!==parser.script&&(emitNode(parser,"onscript",parser.script),parser.script="")}function createStream(strict,opt){return new SAXStream(strict,opt)}function SAXStream(strict,opt){if(!(this instanceof SAXStream))return new SAXStream(strict,opt);Stream.apply(this),this._parser=new SAXParser(strict,opt),this.writable=!0,this.readable=!0;var me=this;this._parser.onend=function(){me.emit("end")},this._parser.onerror=function(er){me.emit("error",er),me._parser.error=null},this._decoder=null,streamWraps.forEach(function(ev){Object.defineProperty(me,"on"+ev,{get:function(){return me._parser["on"+ev]},set:function(h){if(!h)return me.removeAllListeners(ev),me._parser["on"+ev]=h;me.on(ev,h)},enumerable:!0,configurable:!1})})}function charClass(str){return str.split("").reduce(function(s,c){return s[c]=!0,s},{})}function isRegExp(c){return"[object RegExp]"===Object.prototype.toString.call(c)}function is(charclass,c){return isRegExp(charclass)?!!c.match(charclass):charclass[c]}function not(charclass,c){return!is(charclass,c)}function emit(parser,event,data){parser[event]&&parser[event](data)}function emitNode(parser,nodeType,data){parser.textNode&&closeText(parser),emit(parser,nodeType,data)}function closeText(parser){parser.textNode=textopts(parser.opt,parser.textNode),parser.textNode&&emit(parser,"ontext",parser.textNode),parser.textNode=""}function textopts(opt,text){return opt.trim&&(text=text.trim()),opt.normalize&&(text=text.replace(/\s+/g," ")),text}function error(parser,er){return closeText(parser),parser.trackPosition&&(er+="\nLine: "+parser.line+"\nColumn: "+parser.column+"\nChar: "+parser.c),er=new Error(er),parser.error=er,emit(parser,"onerror",er),parser}function end(parser){return parser.closedRoot||strictFail(parser,"Unclosed root tag"),parser.state!==S.BEGIN&&parser.state!==S.TEXT&&error(parser,"Unexpected end"),closeText(parser),parser.c="",parser.closed=!0,emit(parser,"onend"),SAXParser.call(parser,parser.strict,parser.opt),parser}function strictFail(parser,message){if("object"!=typeof parser||!(parser instanceof SAXParser))throw new Error("bad call to strictFail");parser.strict&&error(parser,message)}function newTag(parser){parser.strict||(parser.tagName=parser.tagName[parser.looseCase]());var parent=parser.tags[parser.tags.length-1]||parser,tag=parser.tag={name:parser.tagName,attributes:{}};parser.opt.xmlns&&(tag.ns=parent.ns),parser.attribList.length=0}function qname(name,attribute){var i=name.indexOf(":"),qualName=i<0?["",name]:name.split(":"),prefix=qualName[0],local=qualName[1];return attribute&&"xmlns"===name&&(prefix="xmlns",local=""),{prefix:prefix,local:local}}function attrib(parser){if(parser.strict||(parser.attribName=parser.attribName[parser.looseCase]()),-1!==parser.attribList.indexOf(parser.attribName)||parser.tag.attributes.hasOwnProperty(parser.attribName))return parser.attribName=parser.attribValue="";if(parser.opt.xmlns){var qn=qname(parser.attribName,!0),prefix=qn.prefix,local=qn.local;if("xmlns"===prefix)if("xml"===local&&parser.attribValue!==XML_NAMESPACE)strictFail(parser,"xml: prefix must be bound to "+XML_NAMESPACE+"\nActual: "+parser.attribValue);else if("xmlns"===local&&parser.attribValue!==XMLNS_NAMESPACE)strictFail(parser,"xmlns: prefix must be bound to "+XMLNS_NAMESPACE+"\nActual: "+parser.attribValue);else{var tag=parser.tag,parent=parser.tags[parser.tags.length-1]||parser;tag.ns===parent.ns&&(tag.ns=Object.create(parent.ns)),tag.ns[local]=parser.attribValue}parser.attribList.push([parser.attribName,parser.attribValue])}else parser.tag.attributes[parser.attribName]=parser.attribValue,emitNode(parser,"onattribute",{name:parser.attribName,value:parser.attribValue});parser.attribName=parser.attribValue=""}function openTag(parser,selfClosing){if(parser.opt.xmlns){var tag=parser.tag,qn=qname(parser.tagName);tag.prefix=qn.prefix,tag.local=qn.local,tag.uri=tag.ns[qn.prefix]||"",tag.prefix&&!tag.uri&&(strictFail(parser,"Unbound namespace prefix: "+JSON.stringify(parser.tagName)),tag.uri=qn.prefix);var parent=parser.tags[parser.tags.length-1]||parser;tag.ns&&parent.ns!==tag.ns&&Object.keys(tag.ns).forEach(function(p){emitNode(parser,"onopennamespace",{prefix:p,uri:tag.ns[p]})});for(var i=0,l=parser.attribList.length;i<l;i++){var nv=parser.attribList[i],name=nv[0],value=nv[1],qualName=qname(name,!0),prefix=qualName.prefix,local=qualName.local,uri=""==prefix?"":tag.ns[prefix]||"",a={name:name,value:value,prefix:prefix,local:local,uri:uri};prefix&&"xmlns"!=prefix&&!uri&&(strictFail(parser,"Unbound namespace prefix: "+JSON.stringify(prefix)),a.uri=prefix),parser.tag.attributes[name]=a,emitNode(parser,"onattribute",a)}parser.attribList.length=0}parser.tag.isSelfClosing=!!selfClosing,parser.sawRoot=!0,parser.tags.push(parser.tag),emitNode(parser,"onopentag",parser.tag),selfClosing||(parser.noscript||"script"!==parser.tagName.toLowerCase()?parser.state=S.TEXT:parser.state=S.SCRIPT,parser.tag=null,parser.tagName=""),parser.attribName=parser.attribValue="",parser.attribList.length=0}function closeTag(parser){if(!parser.tagName)return strictFail(parser,"Weird empty close tag."),parser.textNode+="</>",void(parser.state=S.TEXT);if(parser.script){if("script"!==parser.tagName)return parser.script+="</"+parser.tagName+">",parser.tagName="",void(parser.state=S.SCRIPT);emitNode(parser,"onscript",parser.script),parser.script=""}var t=parser.tags.length,tagName=parser.tagName;parser.strict||(tagName=tagName[parser.looseCase]());for(var closeTo=tagName;t--;){if(parser.tags[t].name===closeTo)break;strictFail(parser,"Unexpected close tag")}if(t<0)return strictFail(parser,"Unmatched closing tag: "+parser.tagName),parser.textNode+="</"+parser.tagName+">",void(parser.state=S.TEXT);parser.tagName=tagName;for(var s=parser.tags.length;s-- >t;){var tag=parser.tag=parser.tags.pop();parser.tagName=parser.tag.name,emitNode(parser,"onclosetag",parser.tagName);var x={};for(var i in tag.ns)x[i]=tag.ns[i];var parent=parser.tags[parser.tags.length-1]||parser;parser.opt.xmlns&&tag.ns!==parent.ns&&Object.keys(tag.ns).forEach(function(p){var n=tag.ns[p];emitNode(parser,"onclosenamespace",{prefix:p,uri:n})})}0===t&&(parser.closedRoot=!0),parser.tagName=parser.attribValue=parser.attribName="",parser.attribList.length=0,parser.state=S.TEXT}function parseEntity(parser){var num,entity=parser.entity,entityLC=entity.toLowerCase(),numStr="";return parser.ENTITIES[entity]?parser.ENTITIES[entity]:parser.ENTITIES[entityLC]?parser.ENTITIES[entityLC]:(entity=entityLC,"#"===entity.charAt(0)&&("x"===entity.charAt(1)?(entity=entity.slice(2),num=parseInt(entity,16),numStr=num.toString(16)):(entity=entity.slice(1),num=parseInt(entity,10),numStr=num.toString(10))),entity=entity.replace(/^0+/,""),numStr.toLowerCase()!==entity?(strictFail(parser,"Invalid character entity"),"&"+parser.entity+";"):String.fromCodePoint(num))}function write(chunk){var parser=this;if(this.error)throw this.error;if(parser.closed)return error(parser,"Cannot write after close. Assign an onready handler.");if(null===chunk)return end(parser);for(var i=0,c="";parser.c=c=chunk.charAt(i++);)switch(parser.trackPosition&&(parser.position++,"\n"===c?(parser.line++,parser.column=0):parser.column++),parser.state){case S.BEGIN:"<"===c?(parser.state=S.OPEN_WAKA,parser.startTagPosition=parser.position):not(whitespace,c)&&(strictFail(parser,"Non-whitespace before first tag."),parser.textNode=c,parser.state=S.TEXT);continue;case S.TEXT:if(parser.sawRoot&&!parser.closedRoot){for(var starti=i-1;c&&"<"!==c&&"&"!==c;)(c=chunk.charAt(i++))&&parser.trackPosition&&(parser.position++,"\n"===c?(parser.line++,parser.column=0):parser.column++);parser.textNode+=chunk.substring(starti,i-1)}"<"===c?(parser.state=S.OPEN_WAKA,parser.startTagPosition=parser.position):(!not(whitespace,c)||parser.sawRoot&&!parser.closedRoot||strictFail(parser,"Text data outside of root node."),"&"===c?parser.state=S.TEXT_ENTITY:parser.textNode+=c);continue;case S.SCRIPT:"<"===c?parser.state=S.SCRIPT_ENDING:parser.script+=c;continue;case S.SCRIPT_ENDING:"/"===c?parser.state=S.CLOSE_TAG:(parser.script+="<"+c,parser.state=S.SCRIPT);continue;case S.OPEN_WAKA:if("!"===c)parser.state=S.SGML_DECL,parser.sgmlDecl="";else if(is(whitespace,c));else if(is(nameStart,c))parser.state=S.OPEN_TAG,parser.tagName=c;else if("/"===c)parser.state=S.CLOSE_TAG,parser.tagName="";else if("?"===c)parser.state=S.PROC_INST,parser.procInstName=parser.procInstBody="";else{if(strictFail(parser,"Unencoded <"),parser.startTagPosition+1<parser.position){var pad=parser.position-parser.startTagPosition;c=new Array(pad).join(" ")+c}parser.textNode+="<"+c,parser.state=S.TEXT}continue;case S.SGML_DECL:(parser.sgmlDecl+c).toUpperCase()===CDATA?(emitNode(parser,"onopencdata"),parser.state=S.CDATA,parser.sgmlDecl="",parser.cdata=""):parser.sgmlDecl+c==="--"?(parser.state=S.COMMENT,parser.comment="",parser.sgmlDecl=""):(parser.sgmlDecl+c).toUpperCase()===DOCTYPE?(parser.state=S.DOCTYPE,(parser.doctype||parser.sawRoot)&&strictFail(parser,"Inappropriately located doctype declaration"),parser.doctype="",parser.sgmlDecl=""):">"===c?(emitNode(parser,"onsgmldeclaration",parser.sgmlDecl),parser.sgmlDecl="",parser.state=S.TEXT):is(quote,c)?(parser.state=S.SGML_DECL_QUOTED,parser.sgmlDecl+=c):parser.sgmlDecl+=c;continue;case S.SGML_DECL_QUOTED:c===parser.q&&(parser.state=S.SGML_DECL,parser.q=""),parser.sgmlDecl+=c;continue;case S.DOCTYPE:">"===c?(parser.state=S.TEXT,emitNode(parser,"ondoctype",parser.doctype),parser.doctype=!0):(parser.doctype+=c,"["===c?parser.state=S.DOCTYPE_DTD:is(quote,c)&&(parser.state=S.DOCTYPE_QUOTED,parser.q=c));continue;case S.DOCTYPE_QUOTED:parser.doctype+=c,c===parser.q&&(parser.q="",parser.state=S.DOCTYPE);continue;case S.DOCTYPE_DTD:parser.doctype+=c,"]"===c?parser.state=S.DOCTYPE:is(quote,c)&&(parser.state=S.DOCTYPE_DTD_QUOTED,parser.q=c);continue;case S.DOCTYPE_DTD_QUOTED:parser.doctype+=c,c===parser.q&&(parser.state=S.DOCTYPE_DTD,parser.q="");continue;case S.COMMENT:"-"===c?parser.state=S.COMMENT_ENDING:parser.comment+=c;continue;case S.COMMENT_ENDING:"-"===c?(parser.state=S.COMMENT_ENDED,parser.comment=textopts(parser.opt,parser.comment),parser.comment&&emitNode(parser,"oncomment",parser.comment),parser.comment=""):(parser.comment+="-"+c,parser.state=S.COMMENT);continue;case S.COMMENT_ENDED:">"!==c?(strictFail(parser,"Malformed comment"),parser.comment+="--"+c,parser.state=S.COMMENT):parser.state=S.TEXT;continue;case S.CDATA:"]"===c?parser.state=S.CDATA_ENDING:parser.cdata+=c;continue;case S.CDATA_ENDING:"]"===c?parser.state=S.CDATA_ENDING_2:(parser.cdata+="]"+c,parser.state=S.CDATA);continue;case S.CDATA_ENDING_2:">"===c?(parser.cdata&&emitNode(parser,"oncdata",parser.cdata),emitNode(parser,"onclosecdata"),parser.cdata="",parser.state=S.TEXT):"]"===c?parser.cdata+="]":(parser.cdata+="]]"+c,parser.state=S.CDATA);continue;case S.PROC_INST:"?"===c?parser.state=S.PROC_INST_ENDING:is(whitespace,c)?parser.state=S.PROC_INST_BODY:parser.procInstName+=c;continue;case S.PROC_INST_BODY:if(!parser.procInstBody&&is(whitespace,c))continue;"?"===c?parser.state=S.PROC_INST_ENDING:parser.procInstBody+=c;continue;case S.PROC_INST_ENDING:">"===c?(emitNode(parser,"onprocessinginstruction",{name:parser.procInstName,body:parser.procInstBody}),parser.procInstName=parser.procInstBody="",parser.state=S.TEXT):(parser.procInstBody+="?"+c,parser.state=S.PROC_INST_BODY);continue;case S.OPEN_TAG:is(nameBody,c)?parser.tagName+=c:(newTag(parser),">"===c?openTag(parser):"/"===c?parser.state=S.OPEN_TAG_SLASH:(not(whitespace,c)&&strictFail(parser,"Invalid character in tag name"),parser.state=S.ATTRIB));continue;case S.OPEN_TAG_SLASH:">"===c?(openTag(parser,!0),closeTag(parser)):(strictFail(parser,"Forward-slash in opening tag not followed by >"),parser.state=S.ATTRIB);continue;case S.ATTRIB:if(is(whitespace,c))continue;">"===c?openTag(parser):"/"===c?parser.state=S.OPEN_TAG_SLASH:is(nameStart,c)?(parser.attribName=c,parser.attribValue="",parser.state=S.ATTRIB_NAME):strictFail(parser,"Invalid attribute name");continue;case S.ATTRIB_NAME:"="===c?parser.state=S.ATTRIB_VALUE:">"===c?(strictFail(parser,"Attribute without value"),parser.attribValue=parser.attribName,attrib(parser),openTag(parser)):is(whitespace,c)?parser.state=S.ATTRIB_NAME_SAW_WHITE:is(nameBody,c)?parser.attribName+=c:strictFail(parser,"Invalid attribute name");continue;case S.ATTRIB_NAME_SAW_WHITE:if("="===c)parser.state=S.ATTRIB_VALUE;else{if(is(whitespace,c))continue;strictFail(parser,"Attribute without value"),parser.tag.attributes[parser.attribName]="",parser.attribValue="",emitNode(parser,"onattribute",{name:parser.attribName,value:""}),parser.attribName="",">"===c?openTag(parser):is(nameStart,c)?(parser.attribName=c,parser.state=S.ATTRIB_NAME):(strictFail(parser,"Invalid attribute name"),parser.state=S.ATTRIB)}continue;case S.ATTRIB_VALUE:if(is(whitespace,c))continue;is(quote,c)?(parser.q=c,parser.state=S.ATTRIB_VALUE_QUOTED):(strictFail(parser,"Unquoted attribute value"),parser.state=S.ATTRIB_VALUE_UNQUOTED,parser.attribValue=c);continue;case S.ATTRIB_VALUE_QUOTED:if(c!==parser.q){"&"===c?parser.state=S.ATTRIB_VALUE_ENTITY_Q:parser.attribValue+=c;continue}attrib(parser),parser.q="",parser.state=S.ATTRIB_VALUE_CLOSED;continue;case S.ATTRIB_VALUE_CLOSED:is(whitespace,c)?parser.state=S.ATTRIB:">"===c?openTag(parser):"/"===c?parser.state=S.OPEN_TAG_SLASH:is(nameStart,c)?(strictFail(parser,"No whitespace between attributes"),parser.attribName=c,parser.attribValue="",parser.state=S.ATTRIB_NAME):strictFail(parser,"Invalid attribute name");continue;case S.ATTRIB_VALUE_UNQUOTED:if(not(attribEnd,c)){"&"===c?parser.state=S.ATTRIB_VALUE_ENTITY_U:parser.attribValue+=c;continue}attrib(parser),">"===c?openTag(parser):parser.state=S.ATTRIB;continue;case S.CLOSE_TAG:if(parser.tagName)">"===c?closeTag(parser):is(nameBody,c)?parser.tagName+=c:parser.script?(parser.script+="</"+parser.tagName,parser.tagName="",parser.state=S.SCRIPT):(not(whitespace,c)&&strictFail(parser,"Invalid tagname in closing tag"),parser.state=S.CLOSE_TAG_SAW_WHITE);else{if(is(whitespace,c))continue;not(nameStart,c)?parser.script?(parser.script+="</"+c,parser.state=S.SCRIPT):strictFail(parser,"Invalid tagname in closing tag."):parser.tagName=c}continue;case S.CLOSE_TAG_SAW_WHITE:if(is(whitespace,c))continue;">"===c?closeTag(parser):strictFail(parser,"Invalid characters in closing tag");continue;case S.TEXT_ENTITY:case S.ATTRIB_VALUE_ENTITY_Q:case S.ATTRIB_VALUE_ENTITY_U:switch(parser.state){case S.TEXT_ENTITY:var returnState=S.TEXT,buffer="textNode";break;case S.ATTRIB_VALUE_ENTITY_Q:var returnState=S.ATTRIB_VALUE_QUOTED,buffer="attribValue";break;case S.ATTRIB_VALUE_ENTITY_U:var returnState=S.ATTRIB_VALUE_UNQUOTED,buffer="attribValue"}";"===c?(parser[buffer]+=parseEntity(parser),parser.entity="",parser.state=returnState):is(entity,c)?parser.entity+=c:(strictFail(parser,"Invalid character entity"),parser[buffer]+="&"+parser.entity+c,parser.entity="",parser.state=returnState);continue;default:throw new Error(parser,"Unknown state: "+parser.state)}return parser.position>=parser.bufferCheckPosition&&checkBufferLength(parser),parser}sax.parser=function(strict,opt){return new SAXParser(strict,opt)},sax.SAXParser=SAXParser,sax.SAXStream=SAXStream,sax.createStream=createStream,sax.MAX_BUFFER_LENGTH=65536;var buffers=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];sax.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(o){function f(){this.__proto__=o}return f.prototype=o,new f}),Object.getPrototypeOf||(Object.getPrototypeOf=function(o){return o.__proto__}),Object.keys||(Object.keys=function(o){var a=[];for(var i in o)o.hasOwnProperty(i)&&a.push(i);return a}),SAXParser.prototype={end:function(){end(this)},write:write,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){flushBuffers(this)}};try{var Stream=_dereq_(252).Stream}catch(ex){var Stream=function(){}}var streamWraps=sax.EVENTS.filter(function(ev){return"error"!==ev&&"end"!==ev});SAXStream.prototype=Object.create(Stream.prototype,{constructor:{value:SAXStream}}),SAXStream.prototype.write=function(data){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(data)){if(!this._decoder){var SD=_dereq_(253).StringDecoder;this._decoder=new SD("utf8")}data=this._decoder.write(data)}return this._parser.write(data.toString()),this.emit("data",data),!0},SAXStream.prototype.end=function(chunk){return chunk&&chunk.length&&this.write(chunk),this._parser.end(),!0},SAXStream.prototype.on=function(ev,handler){var me=this;return me._parser["on"+ev]||-1===streamWraps.indexOf(ev)||(me._parser["on"+ev]=function(){var args=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);args.splice(0,0,ev),me.emit.apply(me,args)}),Stream.prototype.on.call(me,ev,handler)};var whitespace="\r\n\t ",number="0124356789",letter="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",quote="'\"",entity=number+letter+"#",attribEnd=whitespace+">",CDATA="[CDATA[",DOCTYPE="DOCTYPE",XML_NAMESPACE="http://www.w3.org/XML/1998/namespace",XMLNS_NAMESPACE="http://www.w3.org/2000/xmlns/",rootNS={xml:XML_NAMESPACE,xmlns:XMLNS_NAMESPACE};whitespace=charClass(whitespace),number=charClass(number),letter=charClass(letter);var nameStart=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,nameBody=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;quote=charClass(quote),entity=charClass(entity),attribEnd=charClass(attribEnd);var S=0;sax.STATE={BEGIN:S++,TEXT:S++,TEXT_ENTITY:S++,OPEN_WAKA:S++,SGML_DECL:S++,SGML_DECL_QUOTED:S++,DOCTYPE:S++,DOCTYPE_QUOTED:S++,DOCTYPE_DTD:S++,DOCTYPE_DTD_QUOTED:S++,COMMENT_STARTING:S++,COMMENT:S++,COMMENT_ENDING:S++,COMMENT_ENDED:S++,CDATA:S++,CDATA_ENDING:S++,CDATA_ENDING_2:S++,PROC_INST:S++,PROC_INST_BODY:S++,PROC_INST_ENDING:S++,OPEN_TAG:S++,OPEN_TAG_SLASH:S++,ATTRIB:S++,ATTRIB_NAME:S++,ATTRIB_NAME_SAW_WHITE:S++,ATTRIB_VALUE:S++,ATTRIB_VALUE_QUOTED:S++,ATTRIB_VALUE_CLOSED:S++,ATTRIB_VALUE_UNQUOTED:S++,ATTRIB_VALUE_ENTITY_Q:S++,ATTRIB_VALUE_ENTITY_U:S++,CLOSE_TAG:S++,CLOSE_TAG_SAW_WHITE:S++,SCRIPT:S++,SCRIPT_ENDING:S++},sax.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(sax.ENTITIES).forEach(function(key){var e=sax.ENTITIES[key],s="number"==typeof e?String.fromCharCode(e):e;sax.ENTITIES[key]=s});for(var S in sax.STATE)sax.STATE[sax.STATE[S]]=S;S=sax.STATE,String.fromCodePoint||function(){var stringFromCharCode=String.fromCharCode,floor=Math.floor,fromCodePoint=function(){var highSurrogate,lowSurrogate,codeUnits=[],index=-1,length=arguments.length;if(!length)return"";for(var result="";++index<length;){var codePoint=Number(arguments[index]);if(!isFinite(codePoint)||codePoint<0||codePoint>1114111||floor(codePoint)!=codePoint)throw RangeError("Invalid code point: "+codePoint);codePoint<=65535?codeUnits.push(codePoint):(codePoint-=65536,highSurrogate=55296+(codePoint>>10),lowSurrogate=codePoint%1024+56320,codeUnits.push(highSurrogate,lowSurrogate)),(index+1==length||codeUnits.length>16384)&&(result+=stringFromCharCode.apply(null,codeUnits),codeUnits.length=0)}return result};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:fromCodePoint,configurable:!0,writable:!0}):String.fromCodePoint=fromCodePoint}()}(void 0===exports?sax={}:exports)}).call(this,void 0)},{252:252,253:253}],252:[function(_dereq_,module,exports){function Stream(){EE.call(this)}module.exports=Stream;var EE=_dereq_(78).EventEmitter;_dereq_(82)(Stream,EE),Stream.Readable=_dereq_(247),Stream.Writable=_dereq_(249),Stream.Duplex=_dereq_(236),Stream.Transform=_dereq_(248),Stream.PassThrough=_dereq_(246),Stream.Stream=Stream,Stream.prototype.pipe=function(dest,options){function ondata(chunk){dest.writable&&!1===dest.write(chunk)&&source.pause&&source.pause()}function ondrain(){source.readable&&source.resume&&source.resume()}function onend(){didOnEnd||(didOnEnd=!0,dest.end())}function onclose(){didOnEnd||(didOnEnd=!0,"function"==typeof dest.destroy&&dest.destroy())}function onerror(er){if(cleanup(),0===EE.listenerCount(this,"error"))throw er}function cleanup(){source.removeListener("data",ondata),dest.removeListener("drain",ondrain),source.removeListener("end",onend),source.removeListener("close",onclose),source.removeListener("error",onerror),dest.removeListener("error",onerror),source.removeListener("end",cleanup),source.removeListener("close",cleanup),dest.removeListener("close",cleanup)}var source=this;source.on("data",ondata),dest.on("drain",ondrain),dest._isStdio||options&&!1===options.end||(source.on("end",onend),source.on("close",onclose));var didOnEnd=!1;return source.on("error",onerror),dest.on("error",onerror),source.on("end",cleanup),source.on("close",cleanup),dest.on("close",cleanup),dest.emit("pipe",source),dest}},{236:236,246:246,247:247,248:248,249:249,78:78,82:82}],253:[function(_dereq_,module,exports){function assertEncoding(encoding){if(encoding&&!isBufferEncoding(encoding))throw new Error("Unknown encoding: "+encoding)}function passThroughWrite(buffer){return buffer.toString(this.encoding)}function utf16DetectIncompleteChar(buffer){this.charReceived=buffer.length%2,this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(buffer){this.charReceived=buffer.length%3,this.charLength=this.charReceived?3:0}var Buffer=_dereq_(28).Buffer,isBufferEncoding=Buffer.isEncoding||function(encoding){switch(encoding&&encoding.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},StringDecoder=exports.StringDecoder=function(encoding){switch(this.encoding=(encoding||"utf8").toLowerCase().replace(/[-_]/,""),assertEncoding(encoding),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=base64DetectIncompleteChar;break;default:return void(this.write=passThroughWrite)}this.charBuffer=new Buffer(6),this.charReceived=0,this.charLength=0};StringDecoder.prototype.write=function(buffer){for(var charStr="";this.charLength;){var available=buffer.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:buffer.length;if(buffer.copy(this.charBuffer,this.charReceived,0,available),this.charReceived+=available,this.charReceived<this.charLength)return"";buffer=buffer.slice(available,buffer.length),charStr=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var charCode=charStr.charCodeAt(charStr.length-1);if(!(charCode>=55296&&charCode<=56319)){if(this.charReceived=this.charLength=0,0===buffer.length)return charStr;break}this.charLength+=this.surrogateSize,charStr=""}this.detectIncompleteChar(buffer);var end=buffer.length;this.charLength&&(buffer.copy(this.charBuffer,0,buffer.length-this.charReceived,end),end-=this.charReceived),charStr+=buffer.toString(this.encoding,0,end);var end=charStr.length-1,charCode=charStr.charCodeAt(end);if(charCode>=55296&&charCode<=56319){var size=this.surrogateSize;return this.charLength+=size,this.charReceived+=size,this.charBuffer.copy(this.charBuffer,size,0,size),buffer.copy(this.charBuffer,0,0,size),charStr.substring(0,end)}return charStr},StringDecoder.prototype.detectIncompleteChar=function(buffer){for(var i=buffer.length>=3?3:buffer.length;i>0;i--){var c=buffer[buffer.length-i];if(1==i&&c>>5==6){this.charLength=2;break}if(i<=2&&c>>4==14){this.charLength=3;break}if(i<=3&&c>>3==30){this.charLength=4;break}}this.charReceived=i},StringDecoder.prototype.end=function(buffer){var res="";if(buffer&&buffer.length&&(res=this.write(buffer)),this.charReceived){var cr=this.charReceived,buf=this.charBuffer,enc=this.encoding;res+=buf.slice(0,cr).toString(enc)}return res}},{28:28}],254:[function(_dereq_,module,exports){!function(global){"use strict";function TinyStack(){this.data=[null],this.top=0}function factory(){return new TinyStack}TinyStack.prototype.clear=function(){return this.data=[null],this.top=0,this},TinyStack.prototype.length=function(){return this.top},TinyStack.prototype.peek=function(){return this.data[this.top]},TinyStack.prototype.pop=function(){return this.top>0?(this.top--,this.data.pop()):void 0},TinyStack.prototype.push=function(arg){return this.data[++this.top]=arg,this},void 0!==exports?module.exports=factory:"function"==typeof define?define(function(){return factory}):global.stack=factory}(this)},{}],255:[function(_dereq_,module,exports){function append(element,node){return appendTo(node,element),element}module.exports=append;var appendTo=_dereq_(256)},{256:256}],256:[function(_dereq_,module,exports){function appendTo(element,target){return target.appendChild(ensureImported(element,target)),element}module.exports=appendTo;var ensureImported=_dereq_(265)},{265:265}],257:[function(_dereq_,module,exports){function getAttribute(node,name){return CSS_PROPERTIES[name]?node.style[name]:node.getAttributeNS(null,name)}function setAttribute(node,name,value){var hyphenated=name.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),type=CSS_PROPERTIES[hyphenated]
;type?(type===LENGTH_ATTR&&"number"==typeof value&&(value=String(value)+"px"),node.style[hyphenated]=value):node.setAttributeNS(null,name,value)}function setAttributes(node,attrs){var i,name,names=Object.keys(attrs);for(i=0,name;name=names[i];i++)setAttribute(node,name,attrs[name])}function attr(node,name,value){if("string"==typeof name){if(void 0===value)return getAttribute(node,name);setAttribute(node,name,value)}else setAttributes(node,name);return node}module.exports=attr;var LENGTH_ATTR=2,CSS_PROPERTIES={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":LENGTH_ATTR,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":LENGTH_ATTR,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1}},{}],258:[function(_dereq_,module,exports){function defined(o){return void 0!==o}function classes(el){return new ClassList(el)}function ClassList(el){if(!el||!el.nodeType)throw new Error("A DOM element reference is required");this.el=el,this.list=el.classList}module.exports=classes;var index=function(arr,obj){if(arr.indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i)if(arr[i]===obj)return i;return-1},re=/\s+/,toString=Object.prototype.toString;ClassList.prototype.add=function(name){if(this.list)return this.list.add(name),this;var arr=this.array();return~index(arr,name)||arr.push(name),defined(this.el.className.baseVal)?this.el.className.baseVal=arr.join(" "):this.el.className=arr.join(" "),this},ClassList.prototype.remove=function(name){if("[object RegExp]"===toString.call(name))return this.removeMatching(name);if(this.list)return this.list.remove(name),this;var arr=this.array(),i=index(arr,name);return~i&&arr.splice(i,1),this.el.className.baseVal=arr.join(" "),this},ClassList.prototype.removeMatching=function(re){for(var arr=this.array(),i=0;i<arr.length;i++)re.test(arr[i])&&this.remove(arr[i]);return this},ClassList.prototype.toggle=function(name,force){return this.list?(defined(force)?force!==this.list.toggle(name,force)&&this.list.toggle(name):this.list.toggle(name),this):(defined(force)?force?this.add(name):this.remove(name):this.has(name)?this.remove(name):this.add(name),this)},ClassList.prototype.array=function(){var className=this.el.getAttribute("class")||"",str=className.replace(/^\s+|\s+$/g,""),arr=str.split(re);return""===arr[0]&&arr.shift(),arr},ClassList.prototype.has=ClassList.prototype.contains=function(name){return this.list?this.list.contains(name):!!~index(this.array(),name)}},{}],259:[function(_dereq_,module,exports){function clear(element){for(var child;child=element.firstChild;)remove(child);return element}module.exports=clear;var remove=_dereq_(263)},{263:263}],260:[function(_dereq_,module,exports){function create(name,attrs){var element;return"<"===name.charAt(0)?(element=parse(name).firstChild,element=document.importNode(element,!0)):element=document.createElementNS(ns.svg,name),attrs&&attr(element,attrs),element}module.exports=create;var attr=_dereq_(257),parse=_dereq_(267),ns=_dereq_(266)},{257:257,266:266,267:267}],261:[function(_dereq_,module,exports){function extend(object,props){var i,k,keys=Object.keys(props);for(i=0;k=keys[i];i++)object[k]=props[k];return object}function createPoint(x,y){var point=node.createSVGPoint();switch(arguments.length){case 0:return point;case 2:x={x:x,y:y}}return extend(point,x)}function createMatrix(a,b,c,d,e,f){var matrix=node.createSVGMatrix();switch(arguments.length){case 0:return matrix;case 6:a={a:a,b:b,c:c,d:d,e:e,f:f}}return extend(matrix,a)}function createTransform(matrix){return matrix?node.createSVGTransformFromMatrix(matrix):node.createSVGTransform()}var create=_dereq_(260),node=create("svg");module.exports.createTransform=createTransform,module.exports.createMatrix=createMatrix,module.exports.createPoint=createPoint},{260:260}],262:[function(_dereq_,module,exports){function set(element,svg){var node,documentElement=parse(svg).documentElement;if(clear(element),svg)for(node=documentElement.firstChild;node;)appendTo(node,element),node=node.nextSibling}function get(element){for(var child=element.firstChild,output=[];child;)serialize(child,output),child=child.nextSibling;return output.join("")}function innerSVG(element,svg){if(void 0!==svg){try{set(element,svg)}catch(e){throw new Error("error parsing SVG: "+e.message)}return element}return get(element)}module.exports=innerSVG;var clear=_dereq_(259),appendTo=_dereq_(256),parse=_dereq_(267),serialize=_dereq_(268)},{256:256,259:259,267:267,268:268}],263:[function(_dereq_,module,exports){function remove(element){var parent=element.parentNode;return parent&&parent.removeChild(element),element}module.exports=remove},{}],264:[function(_dereq_,module,exports){function wrapMatrix(transformList,transform){return transform instanceof SVGMatrix?transformList.createSVGTransformFromMatrix(transform):transform}function setTransforms(transformList,transforms){var i,t;for(transformList.clear(),i=0;t=transforms[i];i++)transformList.appendItem(wrapMatrix(transformList,t));transformList.consolidate()}function transform(node,transforms){var transformList=node.transform.baseVal;if(1===arguments.length)return transformList.consolidate();transforms.length?setTransforms(transformList,transforms):transformList.initialize(wrapMatrix(transformList,transforms))}module.exports=transform},{}],265:[function(_dereq_,module,exports){function ensureImported(element,target){if(element.ownerDocument!==target.ownerDocument)try{return target.ownerDocument.importNode(element,!0)}catch(e){}return element}module.exports=ensureImported},{}],266:[function(_dereq_,module,exports){var ns={svg:"http://www.w3.org/2000/svg"};module.exports=ns},{}],267:[function(_dereq_,module,exports){function parse(svg){return"<svg"===svg.substring(0,4)?-1===svg.indexOf(ns.svg)&&(svg=SVG_START+svg.substring(4)):svg=SVG_START+">"+svg+"</svg>",parseDocument(svg)}function parseDocument(svg){var parser;return parser=new DOMParser,parser.async=!1,parser.parseFromString(svg,"text/xml")}module.exports=parse;var ns=_dereq_(266),SVG_START='<svg xmlns="'+ns.svg+'"'},{266:266}],268:[function(_dereq_,module,exports){function escape(str,pattern){function replaceFn(match,entity){return ENTITY_REPLACEMENT[entity]||entity}return str.replace(pattern,replaceFn)}function serialize(node,output){var i,len,attrMap,attrNode,childNodes;switch(node.nodeType){case 3:output.push(escape(node.textContent,TEXT_ENTITIES));break;case 1:if(output.push("<",node.tagName),node.hasAttributes())for(attrMap=node.attributes,i=0,len=attrMap.length;i<len;++i)attrNode=attrMap.item(i),output.push(" ",attrNode.name,'="',escape(attrNode.value,ATTR_ENTITIES),'"');if(node.hasChildNodes()){for(output.push(">"),childNodes=node.childNodes,i=0,len=childNodes.length;i<len;++i)serialize(childNodes.item(i),output);output.push("</",node.tagName,">")}else output.push("/>");break;case 8:output.push("\x3c!--",escape(node.nodeValue,TEXT_ENTITIES),"--\x3e");break;case 4:output.push("<![CDATA[",node.nodeValue,"]]>");break;default:throw new Error("unable to handle node "+node.nodeType)}return output}module.exports=serialize;var TEXT_ENTITIES=/([&<>]{1})/g,ATTR_ENTITIES=/([\n\r"]{1})/g,ENTITY_REPLACEMENT={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"'"}},{}],269:[function(_dereq_,module,exports){(function(global){function deprecate(fn,msg){function deprecated(){if(!warned){if(config("throwDeprecation"))throw new Error(msg);config("traceDeprecation")?console.trace(msg):console.warn(msg),warned=!0}return fn.apply(this,arguments)}if(config("noDeprecation"))return fn;var warned=!1;return deprecated}function config(name){try{if(!global.localStorage)return!1}catch(_){return!1}var val=global.localStorage[name];return null!=val&&"true"===String(val).toLowerCase()}module.exports=deprecate}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)});